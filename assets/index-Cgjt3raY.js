(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Ue,M,Rt,ge,it,Bt,$t,Lt,xe,je,Ge,Pe={},Kt=[],Jt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,we=Array.isArray;function _e(e,t){for(var r in t)e[r]=t[r];return e}function Ze(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ze(e,t,r){var n,i,o,u={};for(o in t)o=="key"?n=t[o]:o=="ref"?i=t[o]:u[o]=t[o];if(arguments.length>2&&(u.children=arguments.length>3?Ue.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)u[o]===void 0&&(u[o]=e.defaultProps[o]);return Be(e,u,n,i,null)}function Be(e,t,r,n,i){var o={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Rt,__i:-1,__u:0};return i==null&&M.vnode!=null&&M.vnode(o),o}function ye(e){return e.children}function fe(e,t){this.props=e,this.context=t}function Se(e,t){if(t==null)return e.__?Se(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Se(e):null}function Ft(e){var t,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return Ft(e)}}function at(e){(!e.__d&&(e.__d=!0)&&ge.push(e)&&!Le.__r++||it!=M.debounceRendering)&&((it=M.debounceRendering)||Bt)(Le)}function Le(){for(var e,t,r,n,i,o,u,c=1;ge.length;)ge.length>c&&ge.sort($t),e=ge.shift(),c=ge.length,e.__d&&(r=void 0,i=(n=(t=e).__v).__e,o=[],u=[],t.__P&&((r=_e({},n)).__v=n.__v+1,M.vnode&&M.vnode(r),Je(t.__P,r,n,t.__n,t.__P.namespaceURI,32&n.__u?[i]:null,o,i??Se(n),!!(32&n.__u),u),r.__v=n.__v,r.__.__k[r.__i]=r,Ht(o,r,u),r.__e!=i&&Ft(r)));Le.__r=0}function Ut(e,t,r,n,i,o,u,c,a,s,p){var l,y,v,E,I,F,O,R=n&&n.__k||Kt,V=t.length;for(a=Xt(r,t,R,a,V),l=0;l<V;l++)(v=r.__k[l])!=null&&(y=v.__i==-1?Pe:R[v.__i]||Pe,v.__i=l,F=Je(e,v,y,i,o,u,c,a,s,p),E=v.__e,v.ref&&y.ref!=v.ref&&(y.ref&&Xe(y.ref,null,v),p.push(v.ref,v.__c||E,v)),I==null&&E!=null&&(I=E),(O=!!(4&v.__u))||y.__k===v.__k?a=qt(v,a,e,O):typeof v.type=="function"&&F!==void 0?a=F:E&&(a=E.nextSibling),v.__u&=-7);return r.__e=I,a}function Xt(e,t,r,n,i){var o,u,c,a,s,p=r.length,l=p,y=0;for(e.__k=new Array(i),o=0;o<i;o++)(u=t[o])!=null&&typeof u!="boolean"&&typeof u!="function"?(a=o+y,(u=e.__k[o]=typeof u=="string"||typeof u=="number"||typeof u=="bigint"||u.constructor==String?Be(null,u,null,null,null):we(u)?Be(ye,{children:u},null,null,null):u.constructor==null&&u.__b>0?Be(u.type,u.props,u.key,u.ref?u.ref:null,u.__v):u).__=e,u.__b=e.__b+1,c=null,(s=u.__i=er(u,r,a,l))!=-1&&(l--,(c=r[s])&&(c.__u|=2)),c==null||c.__v==null?(s==-1&&(i>p?y--:i<p&&y++),typeof u.type!="function"&&(u.__u|=4)):s!=a&&(s==a-1?y--:s==a+1?y++:(s>a?y--:y++,u.__u|=4))):e.__k[o]=null;if(l)for(o=0;o<p;o++)(c=r[o])!=null&&(2&c.__u)==0&&(c.__e==n&&(n=Se(c)),Wt(c,c));return n}function qt(e,t,r,n){var i,o;if(typeof e.type=="function"){for(i=e.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=e,t=qt(i[o],t,r,n));return t}e.__e!=t&&(n&&(t&&e.type&&!t.parentNode&&(t=Se(e)),r.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Ke(e,t){return t=t||[],e==null||typeof e=="boolean"||(we(e)?e.some(function(r){Ke(r,t)}):t.push(e)),t}function er(e,t,r,n){var i,o,u,c=e.key,a=e.type,s=t[r],p=s!=null&&(2&s.__u)==0;if(s===null&&e.key==null||p&&c==s.key&&a==s.type)return r;if(n>(p?1:0)){for(i=r-1,o=r+1;i>=0||o<t.length;)if((s=t[u=i>=0?i--:o++])!=null&&(2&s.__u)==0&&c==s.key&&a==s.type)return u}return-1}function ot(e,t,r){t[0]=="-"?e.setProperty(t,r??""):e[t]=r==null?"":typeof r!="number"||Jt.test(t)?r:r+"px"}function Ie(e,t,r,n,i){var o,u;e:if(t=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||ot(e.style,t,"");if(r)for(t in r)n&&r[t]==n[t]||ot(e.style,t,r[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(Lt,"$1")),u=t.toLowerCase(),t=u in e||t=="onFocusOut"||t=="onFocusIn"?u.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=r,r?n?r.u=n.u:(r.u=xe,e.addEventListener(t,o?Ge:je,o)):e.removeEventListener(t,o?Ge:je,o);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&r==1?"":r))}}function st(e){return function(t){if(this.l){var r=this.l[t.type+e];if(t.t==null)t.t=xe++;else if(t.t<r.u)return;return r(M.event?M.event(t):t)}}}function Je(e,t,r,n,i,o,u,c,a,s){var p,l,y,v,E,I,F,O,R,V,j,he,ae,oe,ie,le,X,Z=t.type;if(t.constructor!=null)return null;128&r.__u&&(a=!!(32&r.__u),o=[c=t.__e=r.__e]),(p=M.__b)&&p(t);e:if(typeof Z=="function")try{if(O=t.props,R="prototype"in Z&&Z.prototype.render,V=(p=Z.contextType)&&n[p.__c],j=p?V?V.props.value:p.__:n,r.__c?F=(l=t.__c=r.__c).__=l.__E:(R?t.__c=l=new Z(O,j):(t.__c=l=new fe(O,j),l.constructor=Z,l.render=rr),V&&V.sub(l),l.props=O,l.state||(l.state={}),l.context=j,l.__n=n,y=l.__d=!0,l.__h=[],l._sb=[]),R&&l.__s==null&&(l.__s=l.state),R&&Z.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=_e({},l.__s)),_e(l.__s,Z.getDerivedStateFromProps(O,l.__s))),v=l.props,E=l.state,l.__v=t,y)R&&Z.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),R&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(R&&Z.getDerivedStateFromProps==null&&O!==v&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(O,j),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(O,l.__s,j)===!1||t.__v==r.__v){for(t.__v!=r.__v&&(l.props=O,l.state=l.__s,l.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(_){_&&(_.__=t)}),he=0;he<l._sb.length;he++)l.__h.push(l._sb[he]);l._sb=[],l.__h.length&&u.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(O,l.__s,j),R&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(v,E,I)})}if(l.context=j,l.props=O,l.__P=e,l.__e=!1,ae=M.__r,oe=0,R){for(l.state=l.__s,l.__d=!1,ae&&ae(t),p=l.render(l.props,l.state,l.context),ie=0;ie<l._sb.length;ie++)l.__h.push(l._sb[ie]);l._sb=[]}else do l.__d=!1,ae&&ae(t),p=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++oe<25);l.state=l.__s,l.getChildContext!=null&&(n=_e(_e({},n),l.getChildContext())),R&&!y&&l.getSnapshotBeforeUpdate!=null&&(I=l.getSnapshotBeforeUpdate(v,E)),le=p,p!=null&&p.type===ye&&p.key==null&&(le=Dt(p.props.children)),c=Ut(e,we(le)?le:[le],t,r,n,i,o,u,c,a,s),l.base=t.__e,t.__u&=-161,l.__h.length&&u.push(l),F&&(l.__E=l.__=null)}catch(_){if(t.__v=null,a||o!=null)if(_.then){for(t.__u|=a?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,t.__e=c}else{for(X=o.length;X--;)Ze(o[X]);Ye(t)}else t.__e=r.__e,t.__k=r.__k,_.then||Ye(t);M.__e(_,t,r)}else o==null&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):c=t.__e=tr(r.__e,t,r,n,i,o,u,a,s);return(p=M.diffed)&&p(t),128&t.__u?void 0:c}function Ye(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ye)}function Ht(e,t,r){for(var n=0;n<r.length;n++)Xe(r[n],r[++n],r[++n]);M.__c&&M.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(o){o.call(i)})}catch(o){M.__e(o,i.__v)}})}function Dt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:we(e)?e.map(Dt):_e({},e)}function tr(e,t,r,n,i,o,u,c,a){var s,p,l,y,v,E,I,F=r.props,O=t.props,R=t.type;if(R=="svg"?i="http://www.w3.org/2000/svg":R=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(s=0;s<o.length;s++)if((v=o[s])&&"setAttribute"in v==!!R&&(R?v.localName==R:v.nodeType==3)){e=v,o[s]=null;break}}if(e==null){if(R==null)return document.createTextNode(O);e=document.createElementNS(i,R,O.is&&O),c&&(M.__m&&M.__m(t,o),c=!1),o=null}if(R==null)F===O||c&&e.data==O||(e.data=O);else{if(o=o&&Ue.call(e.childNodes),F=r.props||Pe,!c&&o!=null)for(F={},s=0;s<e.attributes.length;s++)F[(v=e.attributes[s]).name]=v.value;for(s in F)if(v=F[s],s!="children"){if(s=="dangerouslySetInnerHTML")l=v;else if(!(s in O)){if(s=="value"&&"defaultValue"in O||s=="checked"&&"defaultChecked"in O)continue;Ie(e,s,null,v,i)}}for(s in O)v=O[s],s=="children"?y=v:s=="dangerouslySetInnerHTML"?p=v:s=="value"?E=v:s=="checked"?I=v:c&&typeof v!="function"||F[s]===v||Ie(e,s,v,F[s],i);if(p)c||l&&(p.__html==l.__html||p.__html==e.innerHTML)||(e.innerHTML=p.__html),t.__k=[];else if(l&&(e.innerHTML=""),Ut(t.type=="template"?e.content:e,we(y)?y:[y],t,r,n,R=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,u,o?o[0]:r.__k&&Se(r,0),c,a),o!=null)for(s=o.length;s--;)Ze(o[s]);c||(s="value",R=="progress"&&E==null?e.removeAttribute("value"):E!=null&&(E!==e[s]||R=="progress"&&!E||R=="option"&&E!=F[s])&&Ie(e,s,E,F[s],i),s="checked",I!=null&&I!=e[s]&&Ie(e,s,I,F[s],i))}return e}function Xe(e,t,r){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(i){M.__e(i,r)}}function Wt(e,t,r){var n,i;if(M.unmount&&M.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||Xe(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){M.__e(o,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&Wt(n[i],t,r||typeof e.type!="function");r||Ze(e.__e),e.__c=e.__=e.__e=void 0}function rr(e,t,r){return this.constructor(e,r)}function nr(e,t,r){var n,i,o,u;t==document&&(t=document.documentElement),M.__&&M.__(e,t),i=(n=!1)?null:t.__k,o=[],u=[],Je(t,e=t.__k=ze(ye,null,[e]),i||Pe,Pe,t.namespaceURI,i?null:t.firstChild?Ue.call(t.childNodes):null,o,i?i.__e:t.firstChild,n,u),Ht(o,e,u)}Ue=Kt.slice,M={__e:function(e,t,r,n){for(var i,o,u;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(e)),u=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,n||{}),u=i.__d),u)return i.__E=i}catch(c){e=c}throw e}},Rt=0,fe.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=_e({},this.state),typeof e=="function"&&(e=e(_e({},r),this.props)),e&&_e(r,e),e!=null&&this.__v&&(t&&this._sb.push(t),at(this))},fe.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),at(this))},fe.prototype.render=ye,ge=[],Bt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,$t=function(e,t){return e.__v.__b-t.__v.__b},Le.__r=0,Lt=/(PointerCapture)$|Capture$/i,xe=0,je=st(!1),Ge=st(!0);var ir=0;function d(e,t,r,n,i,o){t||(t={});var u,c,a=t;if("ref"in a)for(c in a={},t)c=="ref"?u=t[c]:a[c]=t[c];var s={type:e,props:a,key:r,ref:u,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ir,__i:-1,__u:0,__source:i,__self:o};if(typeof e=="function"&&(u=e.defaultProps))for(c in u)a[c]===void 0&&(a[c]=u[c]);return M.vnode&&M.vnode(s),s}var Ce,z,He,lt,Fe=0,Qt=[],Y=M,ct=Y.__b,ut=Y.__r,_t=Y.diffed,ft=Y.__c,ht=Y.unmount,dt=Y.__;function et(e,t){Y.__h&&Y.__h(z,e,Fe||t),Fe=0;var r=z.__H||(z.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function J(e){return Fe=1,ar(Gt,e)}function ar(e,t,r){var n=et(Ce++,2);if(n.t=e,!n.__c&&(n.__=[r?r(t):Gt(void 0,t),function(c){var a=n.__N?n.__N[0]:n.__[0],s=n.t(a,c);a!==s&&(n.__N=[s,n.__[1]],n.__c.setState({}))}],n.__c=z,!z.__f)){var i=function(c,a,s){if(!n.__c.__H)return!0;var p=n.__c.__H.__.filter(function(y){return!!y.__c});if(p.every(function(y){return!y.__N}))return!o||o.call(this,c,a,s);var l=n.__c.props!==c;return p.forEach(function(y){if(y.__N){var v=y.__[0];y.__=y.__N,y.__N=void 0,v!==y.__[0]&&(l=!0)}}),o&&o.call(this,c,a,s)||l};z.__f=!0;var o=z.shouldComponentUpdate,u=z.componentWillUpdate;z.componentWillUpdate=function(c,a,s){if(this.__e){var p=o;o=void 0,i(c,a,s),o=p}u&&u.call(this,c,a,s)},z.shouldComponentUpdate=i}return n.__N||n.__}function be(e,t){var r=et(Ce++,3);!Y.__s&&jt(r.__H,t)&&(r.__=e,r.u=t,z.__H.__h.push(r))}function vt(e){return Fe=5,or(function(){return{current:e}},[])}function or(e,t){var r=et(Ce++,7);return jt(r.__H,t)&&(r.__=e(),r.__H=t,r.__h=e),r.__}function sr(){for(var e;e=Qt.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach($e),e.__H.__h.forEach(Ve),e.__H.__h=[]}catch(t){e.__H.__h=[],Y.__e(t,e.__v)}}Y.__b=function(e){z=null,ct&&ct(e)},Y.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),dt&&dt(e,t)},Y.__r=function(e){ut&&ut(e),Ce=0;var t=(z=e.__c).__H;t&&(He===z?(t.__h=[],z.__h=[],t.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(t.__h.forEach($e),t.__h.forEach(Ve),t.__h=[],Ce=0)),He=z},Y.diffed=function(e){_t&&_t(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Qt.push(t)!==1&&lt===Y.requestAnimationFrame||((lt=Y.requestAnimationFrame)||lr)(sr)),t.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),He=z=null},Y.__c=function(e,t){t.some(function(r){try{r.__h.forEach($e),r.__h=r.__h.filter(function(n){return!n.__||Ve(n)})}catch(n){t.some(function(i){i.__h&&(i.__h=[])}),t=[],Y.__e(n,r.__v)}}),ft&&ft(e,t)},Y.unmount=function(e){ht&&ht(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{$e(n)}catch(i){t=i}}),r.__H=void 0,t&&Y.__e(t,r.__v))};var pt=typeof requestAnimationFrame=="function";function lr(e){var t,r=function(){clearTimeout(n),pt&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,35);pt&&(t=requestAnimationFrame(r))}function $e(e){var t=z,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),z=t}function Ve(e){var t=z;e.__c=e.__(),z=t}function jt(e,t){return!e||e.length!==t.length||t.some(function(r,n){return r!==e[n]})}function Gt(e,t){return typeof t=="function"?t(e):t}var De={},ce={},w={},We={},mt;function Oe(){return mt||(mt=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ROOKS=e.SQUARES=e.RANKS=e.RANK_8=e.RANK_7=e.RANK_6=e.RANK_5=e.RANK_4=e.RANK_3=e.RANK_2=e.RANK_1=e.BITS=e.FLAGS=e.SHIFTS=e.RAYS=e.ATTACKS=e.PIECE_OFFSETS=e.PAWN_OFFSETS=e.POSSIBLE_RESULTS=e.DEFAULT_POSITION=e.SYMBOLS=e.EMPTY=e.KING=e.QUEEN=e.ROOK=e.BISHOP=e.KNIGHT=e.PAWN=e.BLACK=e.WHITE=void 0,e.WHITE="w",e.BLACK="b",e.PAWN="p",e.KNIGHT="n",e.BISHOP="b",e.ROOK="r",e.QUEEN="q",e.KING="k",e.EMPTY=-1,e.SYMBOLS="pnbrqkPNBRQK",e.DEFAULT_POSITION="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",e.POSSIBLE_RESULTS=["1-0","0-1","1/2-1/2","*"],e.PAWN_OFFSETS={b:[16,32,17,15],w:[-16,-32,-17,-15]},e.PIECE_OFFSETS={p:[],n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},e.ATTACKS=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],e.RAYS=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],e.SHIFTS={p:0,n:1,b:2,r:3,q:4,k:5},e.FLAGS={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},e.BITS={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},e.RANK_1=7,e.RANK_2=6,e.RANK_3=5,e.RANK_4=4,e.RANK_5=3,e.RANK_6=2,e.RANK_7=1,e.RANK_8=0,e.RANKS=[e.RANK_8,e.RANK_7,e.RANK_6,e.RANK_5,e.RANK_4,e.RANK_3,e.RANK_2,e.RANK_1],e.SQUARES={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},e.ROOKS={w:[{square:e.SQUARES.a1,flag:e.BITS.QSIDE_CASTLE},{square:e.SQUARES.h1,flag:e.BITS.KSIDE_CASTLE}],b:[{square:e.SQUARES.a8,flag:e.BITS.QSIDE_CASTLE},{square:e.SQUARES.h8,flag:e.BITS.KSIDE_CASTLE}]}})(We)),We}var Ae={},gt;function tt(){if(gt)return Ae;gt=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.State=void 0;var e=Oe(),t=zt(),r=(function(){function n(i,o,u,c,a,s,p){this.board=i||new Array(128),this.kings=o||{w:e.EMPTY,b:e.EMPTY},this.turn=u||e.WHITE,this.castling=c||{w:0,b:0},this.ep_square=a||e.EMPTY,this.half_moves=s||0,this.move_number=p||1}return n.prototype.clone=function(){return new n(this.board.slice(),{w:this.kings.w,b:this.kings.b},this.turn,{w:this.castling.w,b:this.castling.b},this.ep_square,this.half_moves,this.move_number)},Object.defineProperty(n.prototype,"fen",{get:function(){return t.getFen(this)},enumerable:!1,configurable:!0}),n})();return Ae.State=r,Ae}var D={},bt;function rt(){if(bt)return D;bt=1,Object.defineProperty(D,"__esModule",{value:!0}),D.strippedSan=D.validateFen=D.isFlagKey=D.isSquare=D.isPieceSymbol=D.isColor=D.symbol=D.isDigit=D.swapColor=D.algebraic=D.file=D.rank=void 0;var e=Oe();function t(v){return v>>4}D.rank=t;function r(v){return v&15}D.file=r;function n(v){var E=r(v),I=t(v);return"abcdefgh".substring(E,E+1)+"87654321".substring(I,I+1)}D.algebraic=n;function i(v){return v===e.WHITE?e.BLACK:e.WHITE}D.swapColor=i;function o(v){return/^[0-9]$/.test(v)}D.isDigit=o;function u(v){var E=v.type,I=v.color;return I===e.WHITE?E.toUpperCase():E.toLowerCase()}D.symbol=u;function c(v){return v==="w"||v==="b"}D.isColor=c;function a(v){return/^[pnbrqk]$/.test(v)}D.isPieceSymbol=a;function s(v){return/^[a-h][1-8]$/.test(v)}D.isSquare=s;function p(v){var E=["NORMAL","CAPTURE","BIG_PAWN","EP_CAPTURE","PROMOTION","KSIDE_CASTLE","QSIDE_CASTLE"];return E.indexOf(v)!==-1}D.isFlagKey=p;function l(v){var E={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},I=v.split(/\s+/);if(I.length!==6)return{valid:!1,error_number:1,error:E[1]};if(isNaN(I[5])||parseInt(I[5],10)<=0)return{valid:!1,error_number:2,error:E[2]};if(isNaN(I[4])||parseInt(I[4],10)<0)return{valid:!1,error_number:3,error:E[3]};if(!/^(-|[abcdefgh][36])$/.test(I[3]))return{valid:!1,error_number:4,error:E[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(I[2]))return{valid:!1,error_number:5,error:E[5]};if(!/^(w|b)$/.test(I[1]))return{valid:!1,error_number:6,error:E[6]};var F=I[0].split("/");if(F.length!==8)return{valid:!1,error_number:7,error:E[7]};for(var O=0;O<F.length;O++){for(var R=0,V=!1,j=0;j<F[O].length;j++)if(isNaN(F[O][j])){if(!/^[prnbqkPRNBQK]$/.test(F[O][j]))return{valid:!1,error_number:9,error:E[9]};R+=1,V=!1}else{if(V)return{valid:!1,error_number:8,error:E[8]};R+=parseInt(F[O][j],10),V=!0}if(R!==8)return{valid:!1,error_number:10,error:E[10]}}return I[3][1]=="3"&&I[1]=="w"||I[3][1]=="6"&&I[1]=="b"?{valid:!1,error_number:11,error:E[11]}:{valid:!0,error_number:0,error:E[0]}}D.validateFen=l;function y(v){return v.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}return D.strippedSan=y,D}var yt;function zt(){if(yt)return w;yt=1,Object.defineProperty(w,"__esModule",{value:!0}),w.validateMove=w.getBoard=w.ascii=w.buildMove=w.makeMove=w.insufficientMaterial=w.inStalemate=w.inCheckmate=w.inCheck=w.isKingAttacked=w.isAttacked=w.makePretty=w.sanToMove=w.moveToSan=w.generateMoves=w.removePiece=w.putPiece=w.clonePiece=w.cloneMove=w.getPiece=w.loadPgn=w.getPgn=w.loadFen=w.getFen=w.getDisambiguator=void 0;var e=Oe(),t=tt(),r=rt();function n(_,f,h){for(var m=v(_,{legal:!h}),g=f.from,A=f.to,S=f.piece,k=0,b=0,C=0,K=0,$=m.length;K<$;K++){var Q=m[K].from,U=m[K].to,L=m[K].piece;S===L&&g!==Q&&A===U&&(k++,r.rank(g)===r.rank(Q)&&b++,r.file(g)===r.file(Q)&&C++)}return k>0?b>0&&C>0?r.algebraic(g):C>0?r.algebraic(g).charAt(1):r.algebraic(g).charAt(0):""}w.getDisambiguator=n;function i(_){for(var f=0,h="",m=e.SQUARES.a8;m<=e.SQUARES.h1;m++){var g=_.board[m];if(!g)f++;else{f>0&&(h+=f,f=0);var A=g.color,S=g.type;h+=A===e.WHITE?S.toUpperCase():S.toLowerCase()}m+1&136&&(f>0&&(h+=f),m!==e.SQUARES.h1&&(h+="/"),f=0,m+=8)}var k="";_.castling[e.WHITE]&e.BITS.KSIDE_CASTLE&&(k+="K"),_.castling[e.WHITE]&e.BITS.QSIDE_CASTLE&&(k+="Q"),_.castling[e.BLACK]&e.BITS.KSIDE_CASTLE&&(k+="k"),_.castling[e.BLACK]&e.BITS.QSIDE_CASTLE&&(k+="q"),k=k||"-";var b=_.ep_square===e.EMPTY?"-":r.algebraic(_.ep_square);return[h,_.turn,k,b,_.half_moves,_.move_number].join(" ")}w.getFen=i;function o(_){var f=_.split(/\s+/),h=f[0],m=0;if(!r.validateFen(_).valid)return null;for(var g=new t.State,A=0;A<h.length;A++){var S=h.charAt(A);if(S==="/")m+=8;else if(r.isDigit(S))m+=parseInt(S,10);else{var k=S<"a"?e.WHITE:e.BLACK,b=l(g,{type:S.toLowerCase(),color:k},r.algebraic(m));if(!b)return null;g=b,m++}}return g.turn=f[1]===e.BLACK?e.BLACK:e.WHITE,f[2].indexOf("K")>-1&&(g.castling.w|=e.BITS.KSIDE_CASTLE),f[2].indexOf("Q")>-1&&(g.castling.w|=e.BITS.QSIDE_CASTLE),f[2].indexOf("k")>-1&&(g.castling.b|=e.BITS.KSIDE_CASTLE),f[2].indexOf("q")>-1&&(g.castling.b|=e.BITS.QSIDE_CASTLE),g.ep_square=f[3]==="-"?e.EMPTY:e.SQUARES[f[3]],g.half_moves=parseInt(f[4],10),g.move_number=parseInt(f[5],10),g}w.loadFen=o;function u(_,f,h,m,g){g===void 0&&(g={});var A=g.newline_char,S=A===void 0?`
`:A,k=g.max_width,b=k===void 0?0:k,C=[],K=!1;for(var $ in f)C.push("["+$+' "'+f[$]+'"]'+S),K=!0;K&&m.length&&C.push(S);var Q=function(P){var B=h[_.fen];if(typeof B<"u"){var H=P.length>0?" ":"";P=""+P+H+"{"+B+"}"}return P};m[0]&&(_=m[0].state);var U=[],L="";if(m.length===0&&U.push(Q("")),m.forEach(function(P,B){var H=P.move;L=Q(L),B===0&&H.color===e.BLACK?L=_.move_number+". ...":H.color===e.WHITE&&(L.length&&U.push(L),L=_.move_number+"."),L=L+" "+E(_,H),_=oe(_,H)}),L.length&&U.push(Q(L)),typeof f.Result<"u"&&U.push(f.Result),b===0)return C.join("")+U.join(" ");for(var q=function(){return C.length>0&&C[C.length-1]===" "?(C.pop(),!0):!1},N=function(P,B){for(var H=0,x=B.split(" ");H<x.length;H++){var G=x[H];if(G){if(P+G.length>b){for(;q();)P--;C.push(S),P=0}C.push(G),P+=G.length,C.push(" "),P++}}return q()&&P--,P},T=0,$=0;$<U.length;$++){if(T+U[$].length>b&&U[$].includes("{")){T=N(T,U[$]);continue}T+U[$].length>b&&$!==0?(C[C.length-1]===" "&&C.pop(),C.push(S),T=0):$!==0&&(C.push(" "),T++),C.push(U[$]),T+=U[$].length}return C.join("")}w.getPgn=u;function c(_,f){f===void 0&&(f={});var h=f.newline_char,m=h===void 0?`\r?
`:h,g=f.sloppy,A=g===void 0?!1:g,S=function(W){return W.replace(/\\/g,"\\")},k=function(W,re){for(var Ne=re.newline_char,Ee={},ve=W.split(new RegExp(S(Ne))),de="",Te="",pe=0;pe<ve.length;pe++)de=ve[pe].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),Te=ve[pe].replace(/^\[[A-Za-z]+\s"(.*)" *\]$/,"$1"),de.trim().length>0&&(Ee[de.trim()]=Te);return Ee},b=new RegExp("^(\\[((?:"+S(m)+")|.)*\\])(?:"+S(m)+"){2}"),C=b.test(_)?b.exec(_)[1]:"",K=o(e.DEFAULT_POSITION),$=k(C,{newline_char:m});if($.SetUp==="1"&&"FEN"in $){var Q=o($.FEN);if(!Q)return null;K=Q}for(var U=function(W){return Array.from(W).map(function(re){return re.charCodeAt(0)<128?re.charCodeAt(0).toString(16):encodeURIComponent(re).replace(/%/g,"").toLowerCase()}).join("")},L=function(W){var re;return W.length==0?"":decodeURIComponent("%"+((re=W?.match(/.{1,2}/g))===null||re===void 0?void 0:re.join("%")))},q=function(W){return W=W.replace(new RegExp(S(m),"g")," "),"{"+U(W.slice(1,W.length-1))+"}"},N=function(W){if(W.startsWith("{")&&W.endsWith("}"))return L(W.slice(1,W.length-1))},T=_.replace(C,"").replace(new RegExp("({[^}]*})+?|;([^"+S(m)+"]*)","g"),function(W,re,Ne){return re!==void 0?q(re):" "+q("{"+Ne.slice(1)+"}")}).replace(new RegExp(S(m),"g")," "),P=/(\([^()]+\))+?/g;P.test(T);)T=T.replace(P,"");T=T.replace(/\d+\.(\.\.)?/g,""),T=T.replace(/\.\.\./g,""),T=T.replace(/\$\d+/g,"");for(var B=T.trim().split(new RegExp(/\s+/)).join(",").replace(/,,+/g,",").split(","),H={},x=[],G=0;G<B.length;G++){var ee=B[G],te=N(ee);if(te!==void 0){H[K.fen]=te;continue}if(G===B.length-1&&e.POSSIBLE_RESULTS.indexOf(ee)!==-1){Object.keys($).length&&typeof $.Result>"u"&&($.Result=ee);continue}var ne=I(K,B[G],{sloppy:A});if(ne===null)return null;x.push({move:ne,state:K});var Q=oe(K,ne);if(!Q)return null;K=Q}return[K,$,H,x]}w.loadPgn=c;function a(_,f){if(!f||(f=f.toLowerCase(),!r.isSquare(f)))return null;var h=e.SQUARES[f],m=_.board[h];return m?p(m):null}w.getPiece=a;function s(_){return{to:_.to,from:_.from,color:_.color,flags:_.flags,piece:_.piece,captured:_.captured,promotion:_.promotion,san:_.san}}w.cloneMove=s;function p(_){return{color:_.color,type:_.type}}w.clonePiece=p;function l(_,f,h){var m=f.type,g=f.color;if(!m||!g||!h||(m=m.toLowerCase(),g=g.toLowerCase(),h=h.toLowerCase(),!r.isPieceSymbol(m)||!r.isColor(g)||!r.isSquare(h)))return null;var A=_.clone(),S=e.SQUARES[h];return m===e.KING&&A.kings[g]!==e.EMPTY&&A.kings[g]!==S?null:(A.board[S]={type:m,color:g},m===e.KING&&(A.kings[g]=S),A)}w.putPiece=l;function y(_,f){if(!f||(f=f.toLowerCase(),!r.isSquare(f)))return null;var h=e.SQUARES[f],m=_.board[h];if(!m)return null;var g=_.clone(),A=m.type,S=m.color;return A===e.KING&&(g.kings[S]=e.EMPTY),delete g.board[h],g}w.removePiece=y;function v(_,f){var h,m;f===void 0&&(f={});var g=f.legal,A=g===void 0?!0:g,S=function(Ne,Ee,ve,de,Te){var pe=Ne[ve];if(pe&&pe.type===e.PAWN&&(r.rank(de)===e.RANK_8||r.rank(de)===e.RANK_1))for(var nt=[e.QUEEN,e.ROOK,e.BISHOP,e.KNIGHT],qe=0,Zt=nt.length;qe<Zt;qe++)Ee.push(ie(_,ve,de,Te,nt[qe]));else Ee.push(ie(_,ve,de,Te))},k=[],b=_.turn,C=r.swapColor(b),K={b:e.RANK_7,w:e.RANK_2},$=e.SQUARES.a8,Q=e.SQUARES.h1,U=!1,L=f.square;if(L)if(L=L.toLowerCase(),r.isSquare(L))$=Q=e.SQUARES[L],U=!0;else return[];for(var q=$;q<=Q;q++){if(q&136){q+=7;continue}var N=_.board[q];if(!(!N||N.color!==b))if(N.type===e.PAWN){var T=q+e.PAWN_OFFSETS[b][0];if(!_.board[T]){S(_.board,k,q,T,e.BITS.NORMAL);var P=q+e.PAWN_OFFSETS[b][1];K[b]===r.rank(q)&&!_.board[P]&&S(_.board,k,q,P,e.BITS.BIG_PAWN)}for(var B=2;B<4;B++){var H=q+e.PAWN_OFFSETS[b][B];H&136||(_.board[H]&&((h=_.board[H])===null||h===void 0?void 0:h.color)===C?S(_.board,k,q,H,e.BITS.CAPTURE):H===_.ep_square&&S(_.board,k,q,_.ep_square,e.BITS.EP_CAPTURE))}}else for(var B=0,x=e.PIECE_OFFSETS[N.type].length;B<x;B++)for(var G=e.PIECE_OFFSETS[N.type][B],ee=q;ee+=G,!(ee&136);){if(!_.board[ee])S(_.board,k,q,ee,e.BITS.NORMAL);else{if(((m=_.board[ee])===null||m===void 0?void 0:m.color)===b)break;S(_.board,k,q,ee,e.BITS.CAPTURE);break}if(N.type==="n"||N.type==="k")break}}if(!U||Q===_.kings[b]){if(_.castling[b]&e.BITS.KSIDE_CASTLE){var te=_.kings[b],ne=te+2;!_.board[te+1]&&!_.board[ne]&&!O(_,C,_.kings[b])&&!O(_,C,te+1)&&!O(_,C,ne)&&S(_.board,k,_.kings[b],ne,e.BITS.KSIDE_CASTLE)}if(_.castling[b]&e.BITS.QSIDE_CASTLE){var te=_.kings[b],ne=te-2;!_.board[te-1]&&!_.board[te-2]&&!_.board[te-3]&&!O(_,C,_.kings[b])&&!O(_,C,te-1)&&!O(_,C,ne)&&S(_.board,k,_.kings[b],ne,e.BITS.QSIDE_CASTLE)}}if(!A)return k;for(var W=[],q=0,x=k.length;q<x;q++){var re=oe(_,k[q]);R(re,b)||W.push(k[q])}return W}w.generateMoves=v;function E(_,f,h){var m;h===void 0&&(h={});var g=h.sloppy,A=g===void 0?!1:g,S=h.checkPromotion,k=S===void 0?!0:S,b="";if(f.flags&e.BITS.KSIDE_CASTLE)b="O-O";else if(f.flags&e.BITS.QSIDE_CASTLE)b="O-O-O";else{var C=n(_,f,A);f.piece!==e.PAWN&&(b+=f.piece.toUpperCase()+C),f.flags&(e.BITS.CAPTURE|e.BITS.EP_CAPTURE)&&(f.piece===e.PAWN&&(b+=r.algebraic(f.from)[0]),b+="x"),b+=r.algebraic(f.to),k&&f.flags&e.BITS.PROMOTION&&(b+="="+((m=f.promotion)===null||m===void 0?void 0:m.toUpperCase()))}var K=oe(_,f);return V(K)&&(j(K)?b+="#":b+="+"),b}w.moveToSan=E;function I(_,f,h){h===void 0&&(h={});var m=h.sloppy,g=m===void 0?!1:m,A=h.checkPromotion,S=A===void 0?!0:A,k=r.strippedSan(f),b,C,K,$,Q;g&&(b=k.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),b&&(C=b[1],K=b[2],$=b[3],Q=b[4]));for(var U=v(_,{square:K}),L=0,q=U.length;L<q;L++){var N=E(_,U[L],{checkPromotion:S});if(k===r.strippedSan(N)||g&&k===r.strippedSan(E(_,U[L],h))||K&&$&&r.isSquare(K)&&r.isSquare($)&&b&&(!C||C.toLowerCase()==U[L].piece)&&e.SQUARES[K]==U[L].from&&e.SQUARES[$]==U[L].to&&(!S||!Q||Q.toLowerCase()==U[L].promotion))return U[L]}return null}w.sanToMove=I;function F(_,f){var h=s(f),m="";for(var g in e.BITS)r.isFlagKey(g)&&e.BITS[g]&h.flags&&(m+=e.FLAGS[g]);return{to:r.algebraic(h.to),from:r.algebraic(h.from),color:h.color,flags:m,piece:h.piece,san:E(_,h),captured:h.captured,promotion:h.promotion}}w.makePretty=F;function O(_,f,h){for(var m,g=e.SQUARES.a8;g<=e.SQUARES.h1;g++){if(g&136){g+=7;continue}if(!(_.board[g]==null||((m=_.board[g])===null||m===void 0?void 0:m.color)!==f)){var A=_.board[g],S=g-h,k=S+119;if(A&&e.ATTACKS[k]&1<<e.SHIFTS[A.type]){if(A.type===e.PAWN){if(S>0){if(A.color===e.WHITE)return!0}else if(A.color===e.BLACK)return!0;continue}if(A.type==="n"||A.type==="k")return!0;for(var b=e.RAYS[k],C=g+b,K=!1;C!==h;){if(_.board[C]){K=!0;break}C+=b}if(!K)return!0}}}return!1}w.isAttacked=O;function R(_,f){return O(_,r.swapColor(f),_.kings[f])}w.isKingAttacked=R;function V(_){return R(_,_.turn)}w.inCheck=V;function j(_){return V(_)&&v(_).length===0}w.inCheckmate=j;function he(_){return!V(_)&&v(_).length===0}w.inStalemate=he;function ae(_){for(var f={},h=[],m=0,g=0,A=e.SQUARES.a8;A<=e.SQUARES.h1;A++){if(g=(g+1)%2,A&136){A+=7;continue}var S=_.board[A];S&&(f[S.type]=S.type in f?f[S.type]+1:1,S.type===e.BISHOP&&h.push(g),m++)}if(m===2)return!0;if(m===3&&(f[e.BISHOP]===1||f[e.KNIGHT]===1))return!0;if(m===f[e.BISHOP]+2){for(var k=0,b=h.length,A=0;A<b;A++)k+=h[A];if(k===0||k===b)return!0}return!1}w.insufficientMaterial=ae;function oe(_,f){var h=_.clone(),m=h.turn,g=r.swapColor(m);h.board[f.to]=h.board[f.from],delete h.board[f.from],f.flags&e.BITS.EP_CAPTURE&&(h.turn===e.BLACK?delete h.board[f.to-16]:delete h.board[f.to+16]),f.flags&e.BITS.PROMOTION&&f.promotion&&r.isPieceSymbol(f.promotion)&&(h.board[f.to]={type:f.promotion,color:m});var A=h.board[f.to];if(A&&A.type===e.KING){if(h.kings[A.color]=f.to,f.flags&e.BITS.KSIDE_CASTLE){var S=f.to-1,k=f.to+1;h.board[S]=h.board[k],delete h.board[k]}else if(f.flags&e.BITS.QSIDE_CASTLE){var S=f.to+1,k=f.to-2;h.board[S]=h.board[k],delete h.board[k]}h.castling[m]=0}if(h.castling[m]){for(var b=0,C=e.ROOKS[m].length;b<C;b++)if(f.from===e.ROOKS[m][b].square&&h.castling[m]&e.ROOKS[m][b].flag){h.castling[m]^=e.ROOKS[m][b].flag;break}}if(h.castling[g]){for(var b=0,C=e.ROOKS[g].length;b<C;b++)if(f.to===e.ROOKS[g][b].square&&h.castling[g]&e.ROOKS[g][b].flag){h.castling[g]^=e.ROOKS[g][b].flag;break}}return f.flags&e.BITS.BIG_PAWN?h.turn==="b"?h.ep_square=f.to-16:h.ep_square=f.to+16:h.ep_square=e.EMPTY,f.piece===e.PAWN||f.flags&(e.BITS.CAPTURE|e.BITS.EP_CAPTURE)?h.half_moves=0:h.half_moves++,h.turn===e.BLACK&&h.move_number++,h.turn=r.swapColor(h.turn),h}w.makeMove=oe;function ie(_,f,h,m,g){var A,S={color:_.turn,from:f,to:h,flags:m,piece:_.board[f].type};return g&&r.isPieceSymbol(g)&&(S.flags|=e.BITS.PROMOTION,S.promotion=g),_.board[h]?S.captured=(A=_.board[h])===null||A===void 0?void 0:A.type:m&e.BITS.EP_CAPTURE&&(S.captured=e.PAWN),S}w.buildMove=ie;function le(_,f){f===void 0&&(f=`
`);var h=e.RANKS.map(function(m){for(var g=_.slice(m*16,m*16+8),A=[],S=0,k=g;S<k.length;S++){var b=k[S];A.push(b?" "+r.symbol(b)+" ":" . ")}var C=A.join("");return"87654321"[m]+" |"+C+"|"});return["  +------------------------+",h.join(f),"  +------------------------+","    a  b  c  d  e  f  g  h"].join(f)}w.ascii=le;function X(_){for(var f=[],h=[],m=e.SQUARES.a8;m<=e.SQUARES.h1;m++){var g=_[m];g==null?h.push(null):h.push({type:g.type,color:g.color}),m+1&136&&(f.push(h),h=[],m+=8)}return f}w.getBoard=X;function Z(_,f,h){h===void 0&&(h={});var m=h.checkPromotion,g=m===void 0?!0:m;if(typeof f=="string")return I(_,f,h);if(typeof f=="object")for(var A=v(_,{square:f.from}),S=0,k=A;S<k.length;S++){var b=k[S];if(f.from===r.algebraic(b.from)&&f.to===r.algebraic(b.to)&&(!g||!("promotion"in b)||f.promotion===b.promotion))return b}return null}return w.validateMove=Z,w}var St;function cr(){if(St)return ce;St=1;var e=ce&&ce.__assign||function(){return e=Object.assign||function(c){for(var a,s=1,p=arguments.length;s<p;s++){a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(c[l]=a[l])}return c},e.apply(this,arguments)},t=ce&&ce.__spreadArrays||function(){for(var c=0,a=0,s=arguments.length;a<s;a++)c+=arguments[a].length;for(var p=Array(c),l=0,a=0;a<s;a++)for(var y=arguments[a],v=0,E=y.length;v<E;v++,l++)p[l]=y[v];return p};Object.defineProperty(ce,"__esModule",{value:!0}),ce.Chess=void 0;var r=zt(),n=tt(),i=rt(),o=Oe(),u=(function(){function c(a){if(a===void 0&&(a=o.DEFAULT_POSITION),this._state=new n.State,this._history=[],this._header={},this._comments={},!this.load(a))throw new Error("Error loading fen")}return Object.defineProperty(c.prototype,"state",{get:function(){return this._state.clone()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"states",{get:function(){return t(this._history.map(function(a){return a.state.clone()}),[this.state])},enumerable:!1,configurable:!0}),c.prototype.load=function(a,s){s===void 0&&(s=!1);var p=r.loadFen(a);return p?(this._state=p,this._history=[],s||(this._header={}),this._comments={},this.updateSetup(),!0):!1},c.prototype.clear=function(a){a===void 0&&(a=!1),this._state=new n.State,this._history=[],a||(this._header={}),this._comments={},this.updateSetup()},c.prototype.reset=function(){this.load(o.DEFAULT_POSITION)},c.prototype.get=function(a){return r.getPiece(this._state,a)},c.prototype.put=function(a,s){var p=r.putPiece(this._state,a,s);return p?(this._state=p,this.updateSetup(),!0):!1},c.prototype.remove=function(a){var s=r.getPiece(this._state,a);if(!s)return null;var p=r.removePiece(this._state,a);return p?(this._state=p,s):null},c.prototype.moves=function(a){var s=this;a===void 0&&(a={});var p=a.square,l=a.verbose,y=l===void 0?!1:l,v=r.generateMoves(this._state,{square:p});return y?v.map(function(E){return r.makePretty(s._state,E)}):v.map(function(E){return r.moveToSan(s._state,E)})},c.prototype.fen=function(){return this._state.fen},c.prototype.inCheck=function(){return r.inCheck(this._state)},c.prototype.inCheckmate=function(){return r.inCheckmate(this._state)},c.prototype.inStalemate=function(){return r.inStalemate(this._state)},c.prototype.insufficientMaterial=function(){return r.insufficientMaterial(this._state)},c.prototype.inThreefoldRepetition=function(){for(var a={},s=function(v){var E=v.fen.split(" ").slice(0,4).join(" ");return a[E]=E in a?a[E]+1:1,a[E]>=3},p=0,l=this._history;p<l.length;p++){var y=l[p].state;if(s(y))return!0}return s(this._state)},c.prototype.inDraw=function(){return this._state.half_moves>=100||this.inStalemate()||this.insufficientMaterial()||this.inThreefoldRepetition()},c.prototype.gameOver=function(){return this.inCheckmate()||this.inDraw()},c.prototype.board=function(){return r.getBoard(this._state.board)},c.prototype.pgn=function(a){return a===void 0&&(a={}),r.getPgn(this._state,this._header,this._comments,this._history,a)},c.prototype.loadPgn=function(a,s){s===void 0&&(s={});var p=r.loadPgn(a,s);if(!p)return!1;var l=p[0],y=p[1],v=p[2],E=p[3];return this._state=l,this._header=y,this._comments=v,this._history=E,!0},c.prototype.header=function(){return this._header},c.prototype.setHeader=function(a){this._header=a},c.prototype.addHeader=function(a,s){this._header[a]=s},c.prototype.removeHeader=function(a){delete this._header[a]},c.prototype.clearHeader=function(){this._header={}},c.prototype.ascii=function(a){return a===void 0&&(a=`
`),r.ascii(this._state.board,a)},c.prototype.turn=function(){return this._state.turn},c.prototype.move=function(a,s){s===void 0&&(s={});var p=r.validateMove(this._state,a,s);if(!p)return null;var l=r.makePretty(this._state,p);return s.dry_run||this.makeMove(p),l},c.prototype.validateMoves=function(a,s){s===void 0&&(s={});for(var p=[],l=this._state,y=0,v=a;y<v.length;y++){var E=v[y],I=r.validateMove(l,E,s);if(!I)return null;p.push(r.makePretty(l,I)),l=r.makeMove(l,I)}return p},c.prototype.isPromotion=function(a,s){s===void 0&&(s={});var p=r.validateMove(this._state,a,e(e({},s),{checkPromotion:!1}));return p?!!(p.flags&o.BITS.PROMOTION):!1},c.prototype.undo=function(){var a=this.undoMove();return a?r.makePretty(this._state,a):null},c.prototype.squareColor=function(a){if(i.isSquare(a)){var s=o.SQUARES[a];return(i.rank(s)+i.file(s))%2===0?"light":"dark"}return null},c.prototype.history=function(a){a===void 0&&(a={});var s=a.verbose,p=s===void 0?!1:s;if(!this._history.length)return[];var l;return p?this._history.map(function(y){var v=y.move;return l=y.state,r.makePretty(l,v)}):this._history.map(function(y){var v=y.move;return l=y.state,r.moveToSan(l,v)})},c.prototype.getComment=function(a){return a=a||this.fen(),this._comments[a]},c.prototype.getComments=function(){var a=this;return this.pruneComments(),Object.keys(this._comments).map(function(s){return{fen:s,comment:a._comments[s]}})},c.prototype.setComment=function(a,s){s=s||this.fen(),this._comments[s]=a.replace("{","[").replace("}","]")},c.prototype.deleteComment=function(a){a=a||this.fen();var s=this._comments[a];return delete this._comments[a],s},c.prototype.deleteComments=function(){var a=this;return this.pruneComments(),Object.keys(this._comments).map(function(s){var p=a._comments[s];return delete a._comments[s],{fen:s,comment:p}})},c.prototype.validateFen=function(a){return i.validateFen(a)},c.prototype.clone=function(){var a=new c;return a._state=this._state,a._history=t(this._history),a._header=e({},this._header),a._comments=e({},this._comments),a},c.prototype.perft=function(a){for(var s=r.generateMoves(this._state,{legal:!1}),p=0,l=this._state.turn,y=0,v=s.length;y<v;y++){if(this.makeMove(s[y]),!this.kingAttacked(l))if(a-1>0){var E=this.perft(a-1);p+=E}else p++;this.undoMove()}return p},c.prototype.updateSetup=function(){var a=this._state.fen;this._history.length>0||(a!==o.DEFAULT_POSITION?(this._header.SetUp="1",this._header.FEN=a):(delete this._header.SetUp,delete this._header.FEN))},c.prototype.pruneComments=function(){var a=this,s={},p=function(y){y in a._comments&&(s[y]=a._comments[y])};this._history.forEach(function(y){var v=y.state;l=v,p(l.fen)});var l=this._state;p(l.fen),this._comments=s},c.prototype.strippedSan=function(a){return a.replace(/=/,"").replace(/[+#]?[?!]*$/,"")},c.prototype.attacked=function(a,s){return r.isAttacked(this._state,a,s)},c.prototype.kingAttacked=function(a){return this.attacked(i.swapColor(a),this._state.kings[a])},c.prototype.makeMove=function(a){this._history.push({move:a,state:this._state}),this._state=r.makeMove(this._state,a)},c.prototype.undoMove=function(){var a=this._history.pop();return a==null?null:(this._state=a.state,a.move)},c})();return ce.Chess=u,ce}var Nt;function ur(){return Nt||(Nt=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=cr();Object.defineProperty(e,"Chess",{enumerable:!0,get:function(){return t.Chess}});var r=tt();Object.defineProperty(e,"State",{enumerable:!0,get:function(){return r.State}});var n=Oe();Object.defineProperty(e,"WHITE",{enumerable:!0,get:function(){return n.WHITE}}),Object.defineProperty(e,"BLACK",{enumerable:!0,get:function(){return n.BLACK}}),Object.defineProperty(e,"PAWN",{enumerable:!0,get:function(){return n.PAWN}}),Object.defineProperty(e,"KNIGHT",{enumerable:!0,get:function(){return n.KNIGHT}}),Object.defineProperty(e,"BISHOP",{enumerable:!0,get:function(){return n.BISHOP}}),Object.defineProperty(e,"ROOK",{enumerable:!0,get:function(){return n.ROOK}}),Object.defineProperty(e,"QUEEN",{enumerable:!0,get:function(){return n.QUEEN}}),Object.defineProperty(e,"KING",{enumerable:!0,get:function(){return n.KING}}),Object.defineProperty(e,"EMPTY",{enumerable:!0,get:function(){return n.EMPTY}}),Object.defineProperty(e,"SQUARES",{enumerable:!0,get:function(){return n.SQUARES}}),Object.defineProperty(e,"FLAGS",{enumerable:!0,get:function(){return n.FLAGS}}),Object.defineProperty(e,"BITS",{enumerable:!0,get:function(){return n.BITS}});var i=rt();Object.defineProperty(e,"rank",{enumerable:!0,get:function(){return i.rank}}),Object.defineProperty(e,"file",{enumerable:!0,get:function(){return i.file}}),Object.defineProperty(e,"algebraic",{enumerable:!0,get:function(){return i.algebraic}})})(De)),De}var me=ur();const _r="2.0.0";class se{constructor(t,r){this._currentBannedMove=null,this._history=[],this._turnNumber=1,this._isFirstMove=!0,this._indicatorConfig={pgn:!0,serialization:!0,san:!0},this.chess=new me.Chess,r?this.loadFromPGN(r):t&&this.loadFromFEN(t)}get turn(){return this._isFirstMove?"black":this.nextActionType()==="ban"?this.chess.turn()==="w"?"black":"white":this.chess.turn()==="w"?"white":"black"}get currentBannedMove(){return this._currentBannedMove}nextActionType(){return this._isFirstMove?"ban":this._currentBannedMove?"move":"ban"}play(t){try{return"ban"in t?this.playBan(t.ban):this.playMove(t.move)}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}playBan(t){if(this.gameOver())return{success:!1,error:"Game is over"};if(this.nextActionType()!=="ban")return{success:!1,error:"Expected a move, not a ban"};if(!this.legalBans().some(l=>l.from===t.from&&l.to===t.to))return{success:!1,error:`Invalid ban: ${t.from}-${t.to}`};this._currentBannedMove=t;const i=new me.Chess(this.chess.fen()),u=i.moves({verbose:!0}).filter(l=>!(l.from===t.from&&l.to===t.to)),c=u.length===0&&i.inCheck(),a=u.length===0&&!i.inCheck();let s=`${t.from}${t.to}`;this._indicatorConfig.san&&(c?s+="#":a?s+="=":i.inCheck()&&(s+="+"));const p={turnNumber:this._turnNumber,player:this.turn,actionType:"ban",action:t,fen:this.fen(),bannedMove:t,san:s};return this._history.push(p),this._isFirstMove&&(this._isFirstMove=!1),{success:!0,action:{ban:t},san:this._indicatorConfig.san?s:`${t.from}${t.to}`,newFen:this.fen(),gameOver:c||a,checkmate:c,stalemate:a}}playMove(t){if(this.gameOver())return{success:!1,error:"Game is over"};if(this.nextActionType()!=="move")return{success:!1,error:"Expected a ban, not a move"};if(this.isBannedMove(t))return{success:!1,error:`Move ${t.from}-${t.to} is banned`};const r=this.chess.move({from:t.from,to:t.to,promotion:t.promotion});if(!r)return{success:!1,error:`Invalid move: ${t.from}-${t.to}`};const n={turnNumber:this._turnNumber,player:this.chess.turn()==="w"?"black":"white",actionType:"move",action:t,san:r.san,fen:this.fen(),bannedMove:this._currentBannedMove};this._history.push(n),this._currentBannedMove=null,this.chess.turn()==="w"&&this._turnNumber++;const i=this.chess.gameOver(),o=this.chess.inCheckmate(),u=this.chess.inStalemate();let c=r.san;return!this._indicatorConfig.san&&c&&(c=c.replace(/[+#=]$/,"")),{success:!0,action:{move:t},san:c,newFen:this.fen(),gameOver:i,checkmate:o,stalemate:u}}isBannedMove(t){return this._currentBannedMove?this._currentBannedMove.from===t.from&&this._currentBannedMove.to===t.to:!1}legalMoves(){if(this.gameOver())return[];if(this.nextActionType()!=="move")return[];const r=this.chess.moves({verbose:!0}).map(n=>({from:n.from,to:n.to,promotion:n.promotion}));return this._currentBannedMove?r.filter(n=>!this.isBannedMove(n)):r}legalBans(){if(this.gameOver())return[];if(this.nextActionType()!=="ban")return[];const t=new me.Chess(this.chess.fen());if(this._isFirstMove)return t.moves({verbose:!0}).map(o=>({from:o.from,to:o.to}));t.load(this.chess.fen());const r=t.moves({verbose:!0}),n=new Map;return r.forEach(i=>{const o=`${i.from}-${i.to}`;n.has(o)||n.set(o,{from:i.from,to:i.to})}),Array.from(n.values())}inCheck(){return this.chess.inCheck()}inCheckmate(){return this.chess.inCheckmate()}inStalemate(){return this.chess.inStalemate()}gameOver(){return this.inCheckmate()||this.inStalemate()||this.inDraw()}inDraw(){return this.chess.inDraw()}inThreefoldRepetition(){return this.chess.inThreefoldRepetition()}insufficientMaterial(){return this.chess.insufficientMaterial()}currentPlayer(){return this.turn}setIndicatorConfig(t){this._indicatorConfig={...this._indicatorConfig,...t}}getIndicatorConfig(){return{...this._indicatorConfig}}nextMoveColor(){return this.chess.turn()==="w"?"white":"black"}fen(){const t=this.chess.fen();let r;return this._currentBannedMove?r=`b:${this._currentBannedMove.from}${this._currentBannedMove.to}`:this.nextActionType()==="ban"?r=`${this.turn.charAt(0)}:ban`:r="b:ban",`${t} ${r}`}pgn(){let t="",r="",n=1;for(let i=0;i<this._history.length;i++){const o=this._history[i];if(o.actionType==="ban"){const u=o.action;let c=`${u.from}${u.to}`;if(this._indicatorConfig.pgn&&o.san){const a=o.san.match(/[+#=]$/)?.[0];a&&(c+=a)}r+=`{banning: ${c}} `}else{o.player==="white"&&(r=`${n}. ${r}`);let u=o.san||"";!this._indicatorConfig.pgn&&u&&(u=u.replace(/[+#=]$/,"")),r+=`${u} `,o.player==="black"&&(t+=r,r="",n++)}}if(r&&(r.startsWith(`${n}.`)||(r=`${n}. ${r}`),t+=r),this._history.length>0){const i=this._history[this._history.length-1];if(i.actionType==="move"&&i.san){if(i.san.endsWith("#")){const o=i.player==="white"?"1-0":"0-1";t=t.trim()+" "+o}}else if(i.actionType==="ban"&&this.gameOver())if(this.inCheckmate()){const o=this.chess.turn()==="w"?"0-1":"1-0";t=t.trim()+" "+o}else this.inStalemate()&&(t=t.trim()+" 1/2-1/2")}return t.trim()}history(){return[...this._history]}reset(){this.chess=new me.Chess,this._currentBannedMove=null,this._history=[],this._turnNumber=1,this._isFirstMove=!0}ascii(){let t=this.chess.ascii();return this._currentBannedMove&&(t+=`
Banned: ${this._currentBannedMove.from}-${this._currentBannedMove.to}`),t+=`
Next: ${this.nextActionType()} by ${this.turn}`,t}static serializeAction(t,r){let n;if("ban"in t)n=`b:${t.ban.from}${t.ban.to}`;else{const i=t.move;n=`m:${i.from}${i.to}${i.promotion||""}`}return r&&(n+=r),n}static deserializeAction(t){const r=t.match(/^([bm]):([a-h][1-8])([a-h][1-8])([qrbn])?([+#=])?$/);if(!r)throw new Error(`Invalid serialized action format: ${t}`);const[,n,i,o,u,c]=r;if(n==="b")return{ban:{from:i,to:o}};{const a={from:i,to:o};return u&&(a.promotion=u),{move:a}}}getLastActionSerialized(){if(this._history.length===0)return null;const t=this._history[this._history.length-1],r=t.actionType==="ban"?{ban:t.action}:{move:t.action};if(!this._indicatorConfig.serialization)return se.serializeAction(r);let n;if(t.san){const i=t.san.match(/[+#=]$/);i&&(n=i[0])}return se.serializeAction(r,n)}getSyncState(){return{fen:this.fen(),lastAction:this.getLastActionSerialized()||void 0,moveNumber:this._turnNumber}}playSerializedAction(t){try{const r=se.deserializeAction(t);return this.play(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:"Invalid serialized action"}}}loadFromSyncState(t){this.loadFromFEN(t.fen),this._turnNumber=t.moveNumber}getActionHistory(){return this._history.map((t,r)=>{const n=t.actionType==="ban"?{ban:t.action}:{move:t.action};if(!this._indicatorConfig.serialization)return se.serializeAction(n);let i;return t.actionType==="move"?t.san?.endsWith("#")?i="#":t.san?.endsWith("+")&&(i="+"):r===this._history.length-1&&(this.gameOver()?this.inCheckmate()?i="#":this.inStalemate()&&(i="="):this.nextActionType()==="move"&&this.chess.inCheck()&&(i="+")),se.serializeAction(n,i)})}static replayFromActions(t,r){const n=new se(r);for(const i of t){const o=n.playSerializedAction(i);if(!o.success)throw new Error(`Failed to replay action ${i}: ${o.error}`)}return n}loadFromFEN(t){const r=t.split(" ");if(r.length<7){this.chess=new me.Chess(t);return}const n=r.slice(0,6).join(" "),i=r[6];if(this.chess=new me.Chess(n),i&&i!=="-"&&i.includes(":")){const[,o]=i.split(":");o==="ban"?this._isFirstMove=!1:o.length===4&&(this._currentBannedMove={from:o.substring(0,2),to:o.substring(2,4)},this._isFirstMove=!1)}}loadFromPGN(t){this.reset();const r=t.match(/\{banning:\s*[a-h][1-8][a-h][1-8]\}|[KQRBN]?[a-h]?[1-8]?x?[a-h][1-8](?:=[QRBN])?[+#]?|\d+\./g);if(r){for(const n of r)if(!/^\d+\.$/.test(n)){if(n.includes("banning:")){const i=n.match(/([a-h][1-8])([a-h][1-8])/);if(i){const o={from:i[1],to:i[2]};this.play({ban:o})}}else if(/^[KQRBN]?[a-h]?[1-8]?x?[a-h][1-8]/.test(n)){const o=this.legalMoves().find(u=>{const a=new me.Chess(this.chess.fen()).move({from:u.from,to:u.to,promotion:u.promotion});return a&&a.san===n});o&&this.play({move:o})}}}}}se.VERSION=_r;function fr(e,t){for(var r in t)e[r]=t[r];return e}function Et(e,t){for(var r in e)if(r!=="__source"&&!(r in t))return!0;for(var n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function Tt(e,t){this.props=e,this.context=t}(Tt.prototype=new fe).isPureReactComponent=!0,Tt.prototype.shouldComponentUpdate=function(e,t){return Et(this.props,e)||Et(this.state,t)};var At=M.__b;M.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),At&&At(e)};var hr=M.__e;M.__e=function(e,t,r,n){if(e.then){for(var i,o=t;o=o.__;)if((i=o.__c)&&i.__c)return t.__e==null&&(t.__e=r.__e,t.__k=r.__k),i.__c(e,t)}hr(e,t,r,n)};var kt=M.unmount;function Yt(e,t,r){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),e.__c.__H=null),(e=fr({},e)).__c!=null&&(e.__c.__P===r&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(n){return Yt(n,t,r)})),e}function Vt(e,t,r){return e&&r&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(n){return Vt(n,t,r)}),e.__c&&e.__c.__P===t&&(e.__e&&r.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=r)),e}function Qe(){this.__u=0,this.o=null,this.__b=null}function xt(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Me(){this.i=null,this.l=null}M.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),kt&&kt(e)},(Qe.prototype=new fe).__c=function(e,t){var r=t.__c,n=this;n.o==null&&(n.o=[]),n.o.push(r);var i=xt(n.__v),o=!1,u=function(){o||(o=!0,r.__R=null,i?i(c):c())};r.__R=u;var c=function(){if(!--n.__u){if(n.state.__a){var a=n.state.__a;n.__v.__k[0]=Vt(a,a.__c.__P,a.__c.__O)}var s;for(n.setState({__a:n.__b=null});s=n.o.pop();)s.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),e.then(u,u)},Qe.prototype.componentWillUnmount=function(){this.o=[]},Qe.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Yt(this.__b,r,n.__O=n.__P)}this.__b=null}var i=t.__a&&ze(ye,null,e.fallback);return i&&(i.__u&=-33),[ze(ye,null,t.__a?null:e.children),i]};var Pt=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(Me.prototype=new fe).__a=function(e){var t=this,r=xt(t.__v),n=t.l.get(e);return n[0]++,function(i){var o=function(){t.props.revealOrder?(n.push(i),Pt(t,e,n)):i()};r?r(o):o()}},Me.prototype.render=function(e){this.i=null,this.l=new Map;var t=Ke(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},Me.prototype.componentDidUpdate=Me.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,r){Pt(e,r,t)})};var dr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,vr=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,pr=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,mr=/[A-Z0-9]/g,gr=typeof document<"u",br=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};fe.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(fe.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Ct=M.event;function yr(){}function Sr(){return this.cancelBubble}function Nr(){return this.defaultPrevented}M.event=function(e){return Ct&&(e=Ct(e)),e.persist=yr,e.isPropagationStopped=Sr,e.isDefaultPrevented=Nr,e.nativeEvent=e};var Er={enumerable:!1,configurable:!0,get:function(){return this.class}},wt=M.vnode;M.vnode=function(e){typeof e.type=="string"&&(function(t){var r=t.props,n=t.type,i={},o=n.indexOf("-")===-1;for(var u in r){var c=r[u];if(!(u==="value"&&"defaultValue"in r&&c==null||gr&&u==="children"&&n==="noscript"||u==="class"||u==="className")){var a=u.toLowerCase();u==="defaultValue"&&"value"in r&&r.value==null?u="value":u==="download"&&c===!0?c="":a==="translate"&&c==="no"?c=!1:a[0]==="o"&&a[1]==="n"?a==="ondoubleclick"?u="ondblclick":a!=="onchange"||n!=="input"&&n!=="textarea"||br(r.type)?a==="onfocus"?u="onfocusin":a==="onblur"?u="onfocusout":pr.test(u)&&(u=a):a=u="oninput":o&&vr.test(u)?u=u.replace(mr,"-$&").toLowerCase():c===null&&(c=void 0),a==="oninput"&&i[u=a]&&(u="oninputCapture"),i[u]=c}}n=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=Ke(r.children).forEach(function(s){s.props.selected=i.value.indexOf(s.props.value)!=-1})),n=="select"&&i.defaultValue!=null&&(i.value=Ke(r.children).forEach(function(s){s.props.selected=i.multiple?i.defaultValue.indexOf(s.props.value)!=-1:i.defaultValue==s.props.value})),r.class&&!r.className?(i.class=r.class,Object.defineProperty(i,"className",Er)):(r.className&&!r.class||r.class&&r.className)&&(i.class=i.className=r.className),t.props=i})(e),e.$$typeof=dr,wt&&wt(e)};var Ot=M.__r;M.__r=function(e){Ot&&Ot(e),e.__c};var It=M.diffed;M.diffed=function(e){It&&It(e);var t=e.props,r=e.__e;r!=null&&e.type==="textarea"&&"value"in t&&t.value!==r.value&&(r.value=t.value==null?"":t.value)};const ue=[{id:"classic",name:"Classic",path:"/themes/classic",description:"In Soviet Russia, you don't see the pieces; the pieces see you."},{id:"modern",name:"Modern",path:"/themes/modern",description:"For the spoiled players who like seeing where their pieces are."}],Tr=({currentTheme:e,onThemeChange:t})=>{const r=ue.findIndex(o=>o.id===e),n=()=>{const o=r<=0?ue.length-1:r-1;t(ue[o].id)},i=()=>{const o=r>=ue.length-1?0:r+1;t(ue[o].id)};return d("div",{className:"theme-carousel",children:[d("button",{className:"carousel-arrow left",onClick:n,"aria-label":"Previous theme",children:""}),d("div",{className:"carousel-display",children:[d("div",{className:"carousel-header",children:[d("span",{className:"carousel-label",children:"Theme:"}),d("span",{className:"carousel-value",children:ue[r]?.name||"Classic"})]}),d("div",{className:"carousel-description",children:ue[r]?.description})]}),d("button",{className:"carousel-arrow right",onClick:i,"aria-label":"Next theme",children:""})]})};function Ar({engine:e,fen:t,isEngineMove:r,onEngineMove:n}){be(()=>{r&&e.isReady&&!e.isThinking&&e.findBestMove(t)},[r,t,e.isReady]),be(()=>{e.bestMove&&r&&n&&n(e.bestMove)},[e.bestMove]),be(()=>{e.isReady&&!e.isThinking&&(e.analyzePosition(t),e.getStats())},[t,e.isReady,e.isThinking]);const i=u=>Math.abs(u)>=1e4?u>0?"M"+Math.ceil((2e4-u)/2):"-M"+Math.ceil((2e4+u)/2):(u/100).toFixed(2),o=u=>(Math.max(-1e3,Math.min(1e3,u))+1e3)/2e3*100;return d("div",{className:"engine-panel",children:[d("h3",{className:"engine-title",children:[" Ban Chess Engine",e.isThinking&&d("span",{className:"thinking-indicator",children:" (thinking...)"})]}),d("div",{className:"eval-container",children:d("div",{className:"eval-bar",children:[d("div",{className:"eval-bar-fill",style:{width:`${o(e.evaluation)}%`}}),d("div",{className:"eval-score",children:i(e.evaluation)})]})}),d("div",{className:"engine-stats",children:[d("div",{className:"stat",children:[d("span",{className:"stat-label",children:"Depth:"}),d("span",{className:"stat-value",children:e.depth})]}),d("div",{className:"stat",children:[d("span",{className:"stat-label",children:"Nodes:"}),d("span",{className:"stat-value",children:e.nodes.toLocaleString()})]}),e.ttStats&&d("div",{className:"stat",children:[d("span",{className:"stat-label",children:"TT Hit:"}),d("span",{className:"stat-value",children:[(e.ttStats.hitRate*100).toFixed(1),"%"]})]})]}),e.analysis&&d("div",{className:"position-analysis",children:[d("h4",{className:"analysis-title",children:"Position Breakdown"}),d("div",{className:"analysis-grid",children:[d("div",{className:"analysis-item",children:[d("span",{className:"analysis-label",children:"Material:"}),d("span",{className:"analysis-value",children:(e.analysis.material/100).toFixed(1)})]}),d("div",{className:"analysis-item",children:[d("span",{className:"analysis-label",children:"Mobility:"}),d("span",{className:"analysis-value",children:e.analysis.mobility})]}),d("div",{className:"analysis-item",children:[d("span",{className:"analysis-label",children:"King Safety:"}),d("span",{className:"analysis-value",children:e.analysis.kingBanSafety})]}),d("div",{className:"analysis-item",children:[d("span",{className:"analysis-label",children:"Center:"}),d("span",{className:"analysis-value",children:e.analysis.centerControl})]})]})]}),e.pv&&e.pv.length>0&&d("div",{className:"pv-display",children:[d("h4",{className:"pv-title",children:"Best Line"}),d("div",{className:"pv-moves",children:e.pv.map((u,c)=>d("span",{className:"pv-move",children:[c+1,". ","move"in u?`${u.move.from}${u.move.to}`:`${u.ban.from}${u.ban.to}`]},c))})]})]})}function kr(e={}){const[t,r]=J({isReady:!1,isThinking:!1,bestMove:null,evaluation:0,depth:0,nodes:0,pv:[],analysis:null,ttStats:null}),n=vt(null),i=vt(e);return be(()=>{const a=new Worker(new URL("/ban-chess-gui/assets/engineWorker-teWPtonI.js",import.meta.url),{type:"module"});return a.onmessage=s=>{const{type:p,...l}=s.data;switch(p){case"READY":r(y=>({...y,isReady:!0}));break;case"BEST_MOVE":r(y=>({...y,isThinking:!1,bestMove:l.move,evaluation:l.evaluation,depth:l.depth,nodes:l.nodes,pv:l.pv||[]}));break;case"ANALYSIS":r(y=>({...y,analysis:l.analysis}));break;case"TT_STATS":r(y=>({...y,ttStats:l.stats}));break;case"ERROR":console.error("Engine error:",l.error),r(y=>({...y,isThinking:!1}));break}},a.postMessage({type:"INIT",payload:{depth:e.depth||6,timeLimit:e.timeLimit||3e3,useOpeningBook:e.useOpeningBook!==!1}}),n.current=a,()=>{a.terminate()}},[]),{...t,findBestMove:(a,s)=>{!n.current||!t.isReady||(r(p=>({...p,isThinking:!0})),n.current.postMessage({type:"FIND_BEST_MOVE",payload:{fen:a,timeLimit:s||i.current.timeLimit||3e3}}))},analyzePosition:a=>{!n.current||!t.isReady||n.current.postMessage({type:"ANALYZE_POSITION",payload:{fen:a}})},getStats:()=>{!n.current||!t.isReady||n.current.postMessage({type:"GET_TT_STATS"})},config:i.current}}const Mt="/ban-chess-gui/",Re=["a","b","c","d","e","f","g","h"];function ke(e,t=100){try{const r=new(window.AudioContext||window.webkitAudioContext),n=r.createOscillator(),i=r.createGain();n.connect(i),i.connect(r.destination),n.frequency.value=e,n.type="sine",i.gain.setValueAtTime(.3,r.currentTime),i.gain.exponentialRampToValueAtTime(.01,r.currentTime+t/1e3),n.start(r.currentTime),n.stop(r.currentTime+t/1e3)}catch{}}function Pr(){const[e]=J(()=>new se),[t,r]=J([]),[n,i]=J(null),[o,u]=J([]),[c,a]=J([]),[s,p]=J(null),[l,y]=J(!1),[v,E]=J(!0),[I,F]=J([]),[,O]=J({}),[R,V]=J(4),[j,he]=J(!0),[ae,oe]=J("classic"),[ie,le]=J(!1),[X,Z]=J("off"),[_,f]=J(!1),h=kr({depth:6,timeLimit:3e3,useOpeningBook:!0});be(()=>{g()},[]);const m=(N,T)=>{if(!N)return null;const P=N===N.toUpperCase(),B=N.toUpperCase(),H=ue.find(ee=>ee.id===ae)||ue[0],G={K:"King",Q:"Queen",R:"Rook",B:"Bishop",N:"Knight",P:"Pawn"}[B];return G?`${Mt}${H.path}/${P?"white":"black"}/${G}.png`:null};be(()=>{document.documentElement.style.setProperty("--board-size",`${R}rem`)},[R]);const g=()=>{const P=e.fen().split(" ")[0].split("/").map(B=>{const H=[];for(const x of B)if(isNaN(parseInt(x)))H.push(x);else for(let G=0;G<parseInt(x);G++)H.push(null);return H});r(P),u(e.legalMoves()),a(e.legalBans())},A=(N,T)=>(N+T)%2===0?"square-light":"square-dark",S=(N,T)=>{if(l){const P=N+1;return Re[7-T]+P}else{const P=8-N;return Re[T]+P}},k=N=>n?e.nextActionType()==="move"?o.some(T=>T.from===n&&T.to===N):c.some(T=>T.from===n&&T.to===N):!1,b=N=>e.nextActionType()==="move"?o.some(T=>T.from===N):c.some(T=>T.from===N),C=()=>X==="off"||X==="analysis"?!1:X==="white"&&e.turn==="white"||X==="black"&&e.turn==="black",K=(N,T)=>{if(C())return;const P=S(N,T);if(ke(600,50),!n){b(P)&&i(P);return}if(P===n){i(null);return}if(k(P)){const B=e.nextActionType()==="move"?{move:{from:n,to:P}}:{ban:{from:n,to:P}};$(B)}else b(P)&&i(P)},$=N=>{if(e.play(N).success){e.nextActionType()==="ban"?ke(800,150):ke(400,200);const P="move"in N?N.move.from:N.ban.from,B="move"in N?N.move.to:N.ban.to;e.nextActionType()==="move"?F([...I,` ${P}${B}`]):F([...I,`${P}${B}`]),p({from:P,to:B}),g(),i(null),O({}),e.gameOver()&&setTimeout(()=>{ke(200,500)},200)}},Q=N=>{C()&&setTimeout(()=>{$(N)},500)},U=(N,T)=>l?t[7-N]?.[7-T]:t[N]?.[T],L=()=>{ke(1e3,100),e.reset(),i(null),p(null),F([]),g(),O({})},q=(N,T)=>{const P=m(N);if(!P)return null;const B=N===N.toUpperCase();return d("div",{className:"piece-wrapper",children:d("img",{src:P,alt:N,className:`chess-piece ${B?"piece-white":"piece-black"}`})})};return be(()=>{if(v){const N=e.turn==="black";N!==l&&y(N)}},[e.turn,v]),d("div",{className:"container",children:[d("div",{className:"page-header",children:d("div",{className:"header-content",children:[d("img",{src:`${Mt}logo.png`,alt:"Ban Chess Logo",className:"header-logo"}),d("div",{className:"header-text",children:[d("h1",{className:"page-title",children:"Ban Chess with Engine"}),d("p",{className:"subtitle",children:e.gameOver()?"Game Over":C()?"Engine is thinking...":"Click on a piece to select, then click destination"}),d("p",{className:"version-info",children:["Library v",se.VERSION||"1.2.2"," | Engine v0.1.0"]})]})]})}),d("div",{className:"engine-mode-selector",children:[d("button",{className:`engine-mode-btn ${X==="off"?"active":""}`,onClick:()=>{Z("off"),f(!1)},children:"Human vs Human"}),d("button",{className:`engine-mode-btn ${X==="white"?"active":""}`,onClick:()=>{Z("white"),f(!0)},children:"Engine as White"}),d("button",{className:`engine-mode-btn ${X==="black"?"active":""}`,onClick:()=>{Z("black"),f(!0)},children:"Engine as Black"}),d("button",{className:`engine-mode-btn ${X==="analysis"?"active":""}`,onClick:()=>{Z("analysis"),f(!0)},children:"Analysis Mode"})]}),d("div",{className:"game-info",children:[d("div",{className:"turn-indicator",children:[d("span",{className:e.turn==="white"?"white-turn":"black-turn",children:["Turn: ",e.turn==="white"?"White":"Black",C()&&" (Engine)"]}),d("span",{className:`dot ${e.turn==="white"?"dot-white":"dot-black"}`})]}),d("div",{className:`action-type ${e.nextActionType()==="ban"?"ban":"move"}`,children:["Next:"," ",e.nextActionType()==="ban"?" Ban a move":" Make a move"]}),e.inCheckmate()&&d("div",{className:"game-status checkmate",children:" Checkmate!"}),e.inCheck()&&!e.inCheckmate()&&d("div",{className:"game-status check",children:" Check!"})]}),d("div",{className:"board-container",children:d("div",{className:"board-wrapper",children:[d("div",{className:"rank-labels",children:Array.from({length:8},(N,T)=>{const P=l?T+1:8-T;return d("div",{children:P},T)})}),d("div",{className:"file-labels",children:Array.from({length:8},(N,T)=>{const P=l?Re[7-T]:Re[T];return d("div",{children:P},T)})}),d("div",{className:"chess-board",children:[0,1,2,3,4,5,6,7].map(N=>[0,1,2,3,4,5,6,7].map(T=>{const P=S(N,T),B=U(N,T),H=P===n,x=n&&k(P),G=e.currentBannedMove&&(e.currentBannedMove.from===P||e.currentBannedMove.to===P),ee=s?.from===P,te=s?.to===P,ne=b(P);return d("div",{onClick:()=>K(N,T),className:`board-square ${A(N,T)} ${H?"square-selected":""} ${x?"square-legal-move":""} ${ee?"square-last-move-from":""} ${te?"square-last-move-to":""} ${G?"square-banned":""} ${ne&&!H?"square-can-select":""} ${!ne&&!x&&n?"square-inactive":""} ${C()?"square-disabled":""}`,children:[B&&q(B),x&&!B&&d("div",{className:"move-dot"}),G&&d("div",{className:"ban-overlay",children:d("div",{className:"ban-x",children:""})})]},`${N}-${T}`)}))})]})}),_&&d(Ar,{engine:h,fen:e.fen(),isEngineMove:C(),onEngineMove:Q}),d("div",{className:"controls",children:[d("button",{onClick:L,className:"btn btn-primary",children:"New Game"}),d("button",{onClick:()=>y(!l),className:"btn",children:"Flip Board"}),d("button",{onClick:()=>E(!v),className:`btn ${v?"btn-success":""}`,children:["Auto-flip: ",v?"ON":"OFF"]}),d("button",{onClick:()=>le(!ie),className:"btn",children:["Debug: ",ie?"ON":"OFF"]})]}),d("div",{className:"controls-section",children:[d("button",{className:"btn btn-secondary controls-toggle",onClick:()=>he(!j),children:j?" Hide Controls":" Show Controls"}),j&&d("div",{className:"controls-panel",children:[d("div",{className:"control-group",children:[d("label",{className:"control-label",children:["Board Size: ",R,"rem"]}),d("input",{type:"range",min:"3",max:"8",step:"0.5",value:R,onChange:N=>V(parseFloat(N.target.value)),className:"control-slider"})]}),d("div",{className:"control-group",children:d(Tr,{currentTheme:ae,onThemeChange:oe})})]})]}),d("div",{className:"history-section",children:[d("h3",{className:"history-title",children:"Move History"}),d("div",{className:"move-history",children:I.length>0?d("div",{className:"moves-inline",children:I.map((N,T)=>d("span",{className:`move-entry-inline ${N.startsWith("")?"ban-entry":""}`,children:[Math.floor(T/2)+1,".",T%2===0?"":".."," ",N]},T))}):d("div",{className:"move-entry",children:"No moves yet"})})]}),ie&&d("div",{className:"debug-section",children:[d("h3",{className:"debug-title",children:"Debug Information"}),d("div",{className:"debug-content",children:[d("div",{className:"debug-group",children:[d("label",{className:"debug-label",children:"FEN:"}),d("code",{className:"debug-value",children:e.fen()})]}),d("div",{className:"debug-group",children:[d("label",{className:"debug-label",children:"PGN:"}),d("code",{className:"debug-value",children:e.pgn()})]})]})]}),e.gameOver()&&d("div",{className:"game-over",children:[d("h2",{children:"Game Over!"}),d("p",{children:e.inCheckmate()?`Checkmate! ${e.turn==="white"?"Black":"White"} wins!`:"Draw!"})]})]})}function Cr(){return d(Pr,{})}nr(d(Cr,{}),document.getElementById("app"));
