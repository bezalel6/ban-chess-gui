function Cn(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F}function Nn(F){if(Object.prototype.hasOwnProperty.call(F,"__esModule"))return F;var s=F.default;if(typeof s=="function"){var b=function N(){var D=!1;try{D=this instanceof N}catch{}return D?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};b.prototype=s.prototype}else b={};return Object.defineProperty(b,"__esModule",{value:!0}),Object.keys(F).forEach(function(N){var D=Object.getOwnPropertyDescriptor(F,N);Object.defineProperty(b,N,D.get?D:{enumerable:!0,get:function(){return F[N]}})}),b}var Te={exports:{}},Bn={},Tn=Object.freeze({__proto__:null,default:Bn}),_e=Nn(Tn);/*!
 * Stockfish copyright T. Romstad, M. Costalba, J. Kiiski, G. Linscott
 * and other contributors.
 *
 * Multi-variant support by Daniel Dugovic and contributors:
 * https://github.com/ddugovic/Stockfish
 *
 * Released under the GNU General Public License v3.
 *
 * Compiled to JavaScript and Webassembly by Niklas Fiekas
 * <niklas.fiekas@backscattering.de> using Emscripten and Binaryen.
 *
 * https://github.com/niklasf/stockfish.js
 */Te.exports;var St;function In(){return St||(St=1,(function(F){var s=s!==void 0?s:{};s=(function(){var e=[];return onmessage=function(t){t.data=="quit"?close():e!==null?e.push(t.data):s.ccall("uci_command","number",["string"],[t.data])},{locateFile:function(t){return t},print:function(t){postMessage(t)},postRun:function(){for(var t=0;t<e.length;t++)s.ccall("uci_command","number",["string"],[e[t]]);e=null}}})();var b,N={};for(b in s)s.hasOwnProperty(b)&&(N[b]=s[b]);var D=[],ee="./this.program",W=function(e,t){throw t},te=!1,U=!1,K=!1,le=!1,be=!1;te=typeof window=="object",U=typeof importScripts=="function",le=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",K=le&&!te&&!U,be=!te&&!K&&!U;var ne,De,$,Z,me,Y="";function re(e){return s.locateFile?s.locateFile(e,Y):Y+e}K?(Y=__dirname+"/",ne=function(e,t){var n;return Z=Z||_e,e=(me=me||_e).normalize(e),n=Z.readFileSync(e),t?n:n.toString()},$=function(e){var t=ne(e,!0);return t.buffer||(t=new Uint8Array(t)),H(t.buffer),t},1<process.argv.length&&(ee=process.argv[1].replace(/\\/g,"/")),D=process.argv.slice(2),F.exports=s,process.on("uncaughtException",function(e){if(!(e instanceof Ne))throw e}),process.on("unhandledRejection",z),W=function(e){process.exit(e)},s.inspect=function(){return"[Emscripten Module object]"}):be?(typeof read<"u"&&(ne=function(e){return read(e)}),$=function(e){var t;return typeof readbuffer=="function"?new Uint8Array(readbuffer(e)):(H(typeof(t=read(e,"binary"))=="object"),t)},typeof scriptArgs<"u"?D=scriptArgs:typeof arguments<"u"&&(D=arguments),typeof quit=="function"&&(W=function(e){quit(e)}),typeof print<"u"&&(typeof console>"u"&&(console={}),console.log=print,console.warn=console.error=typeof printErr<"u"?printErr:print)):(te||U)&&(U?Y=self.location.href:document.currentScript&&(Y=document.currentScript.src),Y=Y.indexOf("blob:")!==0?Y.substr(0,Y.lastIndexOf("/")+1):"",ne=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},U&&($=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),De=function(e,t,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onload=function(){o.status==200||o.status==0&&o.response?t(o.response):n()},o.onerror=n,o.send(null)});var Ie=s.print||console.log.bind(console),q=s.printErr||console.warn.bind(console);for(b in N)N.hasOwnProperty(b)&&(s[b]=N[b]);function pe(e){pe.shown||(pe.shown={}),pe.shown[e]||(pe.shown[e]=1,q(e))}N=null,s.arguments&&(D=s.arguments),s.thisProgram&&(ee=s.thisProgram),s.quit&&(W=s.quit);var Mt={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0);var ze={};function At(e,t){if(e){H(t),ze[t]||(ze[t]={});var n=ze[t];return n[e]||(t.length===1?n[e]=function(){return je(t,e)}:t.length===2?n[e]=function(o){return je(t,e,[o])}:n[e]=function(){return je(t,e,Array.prototype.slice.call(arguments))}),n[e]}}function je(e,t,n){return n&&n.length?s["dynCall_"+e].apply(null,[t].concat(n)):s["dynCall_"+e].call(null,t)}var he,qe,Qe=0,et=function(e){Qe=e},tt=function(){return Qe};s.wasmBinary&&(he=s.wasmBinary),typeof WebAssembly!="object"&&q("no native wasm support detected");var J=!1;function H(e,t){e||z("Assertion failed: "+t)}function Lt(e){var t=s["_"+e];return H(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function Rt(e,t,n,o,i){var a={string:function(y){var M=0;if(y!=null&&y!==0){var L=1+(y.length<<2);rt(y,M=Ce(L),L)}return M},array:function(y){var M=Ce(y.length);return it(y,M),M}},u=Lt(e),l=[],f=0;if(o)for(var m=0;m<o.length;m++){var d=a[n[m]];d?(f===0&&(f=_t()),l[m]=d(o[m])):l[m]=o[m]}var g,h=u.apply(null,l);return g=h,h=t==="string"?ge(g):t==="boolean"?!!g:g,f!==0&&Et(f),h}var nt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function fe(e,t,n){for(var o=t+n,i=t;e[i]&&!(o<=i);)++i;if(16<i-t&&e.subarray&&nt)return nt.decode(e.subarray(t,i));for(var a="";t<i;){var u=e[t++];if(128&u){var l=63&e[t++];if((224&u)!=192){var f=63&e[t++];if((u=(240&u)==224?(15&u)<<12|l<<6|f:(7&u)<<18|l<<12|f<<6|63&e[t++])<65536)a+=String.fromCharCode(u);else{var m=u-65536;a+=String.fromCharCode(55296|m>>10,56320|1023&m)}}else a+=String.fromCharCode((31&u)<<6|l)}else a+=String.fromCharCode(u)}return a}function ge(e,t){return e?fe(de,e,t):""}function ve(e,t,n,o){if(!(0<o))return 0;for(var i=n,a=n+o-1,u=0;u<e.length;++u){var l=e.charCodeAt(u);if(55296<=l&&l<=57343&&(l=65536+((1023&l)<<10)|1023&e.charCodeAt(++u)),l<=127){if(a<=n)break;t[n++]=l}else if(l<=2047){if(a<=n+1)break;t[n++]=192|l>>6,t[n++]=128|63&l}else if(l<=65535){if(a<=n+2)break;t[n++]=224|l>>12,t[n++]=128|l>>6&63,t[n++]=128|63&l}else{if(a<=n+3)break;t[n++]=240|l>>18,t[n++]=128|l>>12&63,t[n++]=128|l>>6&63,t[n++]=128|63&l}}return t[n]=0,n-i}function rt(e,t,n){return ve(e,de,t,n)}function we(e){for(var t=0,n=0;n<e.length;++n){var o=e.charCodeAt(n);55296<=o&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++n)),o<=127?++t:t+=o<=2047?2:o<=65535?3:4}return t}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Pt(e){var t=we(e)+1,n=Ze(t);return n&&ve(e,X,n,t),n}function ot(e){var t=we(e)+1,n=Ce(t);return ve(e,X,n,t),n}function it(e,t){X.set(e,t)}var V,X,de,at,w,Ue,st=65536;function xt(){s.HEAP8=X=new Int8Array(V),s.HEAP16=at=new Int16Array(V),s.HEAP32=w=new Int32Array(V),s.HEAPU8=de=new Uint8Array(V),s.HEAPU16=new Uint16Array(V),s.HEAPU32=Ue=new Uint32Array(V),s.HEAPF32=new Float32Array(V),s.HEAPF64=new Float64Array(V)}var Ot=6352512,ut=1109600,Ye=s.TOTAL_MEMORY||33554432;function Se(e){for(;0<e.length;){var t=e.shift();if(typeof t!="function"){var n=t.func;typeof n=="number"?t.arg===void 0?s.dynCall_v(n):s.dynCall_vi(n,t.arg):n(t.arg===void 0?null:t.arg)}else t()}}(qe=s.wasmMemory?s.wasmMemory:new WebAssembly.Memory({initial:Ye/st,maximum:Ye/st}))&&(V=qe.buffer),Ye=V.byteLength,xt(),w[ut>>2]=Ot;var ct=[],lt=[],Ct=[],ft=[];function Nt(){if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)zt(s.preRun.shift());Se(ct)}function Bt(){s.noFSInit||r.init.initialized||r.init(),Se(lt)}function Tt(){r.ignorePermissions=!1,Se(Ct)}function It(){if(s.postRun)for(typeof s.postRun=="function"&&(s.postRun=[s.postRun]);s.postRun.length;)jt(s.postRun.shift());Se(ft)}function zt(e){ct.unshift(e)}function jt(e){ft.unshift(e)}var He=Math.abs,We=Math.ceil,Ve=Math.floor,Xe=Math.min,ae=0,ye=null;function Yn(e){return e}function Ge(e){ae++,s.monitorRunDependencies&&s.monitorRunDependencies(ae)}function Fe(e){if(ae--,s.monitorRunDependencies&&s.monitorRunDependencies(ae),ae==0&&ye){var t=ye;ye=null,t()}}s.preloadedImages={},s.preloadedAudios={};var dt="data:application/octet-stream;base64,";function mt(e){return String.prototype.startsWith?e.startsWith(dt):e.indexOf(dt)===0}var I,Q,oe="stockfish.wasm";function pt(){try{if(he)return new Uint8Array(he);if($)return $(oe);throw"both async and sync fetching of the wasm failed"}catch(e){z(e)}}function qt(){return he||!te&&!U||typeof fetch!="function"?new Promise(function(e,t){e(pt())}):fetch(oe,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+oe+"'";return e.arrayBuffer()}).catch(function(){return pt()})}function Ut(e){var t={env:e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:Mt};function n(a,u){var l=a.exports;s.asm=l,Fe()}function o(a){n(a.instance)}function i(a){return qt().then(function(u){return WebAssembly.instantiate(u,t)}).then(a,function(u){q("failed to asynchronously prepare wasm: "+u),z(u)})}if(Ge(),s.instantiateWasm)try{return s.instantiateWasm(t,n)}catch(a){return q("Module.instantiateWasm callback failed with error: "+a),!1}return(function(){if(he||typeof WebAssembly.instantiateStreaming!="function"||mt(oe)||typeof fetch!="function")return i(o);fetch(oe,{credentials:"same-origin"}).then(function(a){return WebAssembly.instantiateStreaming(a,t).then(o,function(u){q("wasm streaming compile failed: "+u),q("falling back to ArrayBuffer instantiation"),i(o)})})})(),{}}function Hn(e){return e}function Yt(e){return e.replace(/__Z[\w\d_]+/g,function(t){var n=t;return t===n?t:n+" ["+t+"]"})}function Ht(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function Wt(){var e=Ht();return s.extraStackTrace&&(e+=`
`+s.extraStackTrace()),Yt(e)}function Vt(e,t,n,o){var i=w[e>>2],a=w[e+4>>2];return w[e>>2]=Pn(i,a,t,n),w[e+4>>2]=tt(),0|(et(a),i)}function Xt(e){return Ze(e)}mt(oe)||(oe=re(oe)),s.asm=function(e,t,n){return t.memory=qe,t.table=new WebAssembly.Table({initial:733,maximum:733,element:"anyfunc"}),t.__memory_base=1024,t.__table_base=0,Ut(t)},lt.push({func:function(){xn()}});function Gt(e,t,n){throw"uncaught_exception"in Oe?Oe.uncaught_exceptions++:Oe.uncaught_exceptions=1,e}function Kt(){return Oe.uncaught_exceptions}function $t(){}function se(e){return s.___errno_location&&(w[s.___errno_location()>>2]=e),e}function Zt(e,t){return se(1),-1}var k={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var n=0,o=e.length-1;0<=o;o--){var i=e[o];i==="."?e.splice(o,1):i===".."?(e.splice(o,1),n++):n&&(e.splice(o,1),n--)}if(t)for(;n;n--)e.unshift("..");return e},normalize:function(e){var t=e.charAt(0)==="/",n=e.substr(-1)==="/";return(e=k.normalizeArray(e.split("/").filter(function(o){return!!o}),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=k.splitPath(e),n=t[0],o=t[1];return n||o?n+(o=o&&o.substr(0,o.length-1)):"."},basename:function(e){if(e==="/")return"/";var t=e.lastIndexOf("/");return t===-1?e:e.substr(t+1)},extname:function(e){return k.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return k.normalize(e.join("/"))},join2:function(e,t){return k.normalize(e+"/"+t)}},G={resolve:function(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){var o=0<=n?arguments[n]:r.cwd();if(typeof o!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!o)return"";e=o+"/"+e,t=o.charAt(0)==="/"}return(t?"/":"")+(e=k.normalizeArray(e.split("/").filter(function(i){return!!i}),!t).join("/"))||"."},relative:function(e,t){function n(m){for(var d=0;d<m.length&&m[d]==="";d++);for(var g=m.length-1;0<=g&&m[g]==="";g--);return g<d?[]:m.slice(d,g-d+1)}e=G.resolve(e).substr(1),t=G.resolve(t).substr(1);for(var o=n(e.split("/")),i=n(t.split("/")),a=Math.min(o.length,i.length),u=a,l=0;l<a;l++)if(o[l]!==i[l]){u=l;break}var f=[];for(l=u;l<o.length;l++)f.push("..");return(f=f.concat(i.slice(u))).join("/")}},ue={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){ue.ttys[e]={input:[],output:[],ops:t},r.registerDevice(e,ue.stream_ops)},stream_ops:{open:function(e){var t=ue.ttys[e.node.rdev];if(!t)throw new r.ErrnoError(19);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,n,o,i){if(!e.tty||!e.tty.ops.get_char)throw new r.ErrnoError(6);for(var a=0,u=0;u<o;u++){var l;try{l=e.tty.ops.get_char(e.tty)}catch{throw new r.ErrnoError(5)}if(l===void 0&&a===0)throw new r.ErrnoError(11);if(l==null)break;a++,t[n+u]=l}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,n,o,i){if(!e.tty||!e.tty.ops.put_char)throw new r.ErrnoError(6);try{for(var a=0;a<o;a++)e.tty.ops.put_char(e.tty,t[n+a])}catch{throw new r.ErrnoError(5)}return o&&(e.node.timestamp=Date.now()),a}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if(K){var n=Buffer.alloc?Buffer.alloc(256):new Buffer(256),o=0,i=process.platform!="win32",a=process.stdin.fd;if(i){var u=!1;try{a=B.openSync("/dev/stdin","r"),u=!0}catch{}}try{o=B.readSync(a,n,0,256,null)}catch(l){if(l.toString().indexOf("EOF")==-1)throw l;o=0}u&&B.closeSync(a),t=0<o?n.slice(0,o).toString("utf-8"):null}else typeof window<"u"&&typeof window.prompt=="function"?(t=window.prompt("Input: "))!==null&&(t+=`
`):typeof readline=="function"&&(t=readline())!==null&&(t+=`
`);if(!t)return null;e.input=xe(t,!0)}return e.input.shift()},put_char:function(e,t){t===null||t===10?(Ie(fe(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(Ie(fe(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){t===null||t===10?(q(fe(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(q(fe(e.output,0)),e.output=[])}}},_={ops_table:null,mount:function(e){return _.createNode(null,"/",16895,0)},createNode:function(e,t,n,o){if(r.isBlkdev(n)||r.isFIFO(n))throw new r.ErrnoError(1);_.ops_table||(_.ops_table={dir:{node:{getattr:_.node_ops.getattr,setattr:_.node_ops.setattr,lookup:_.node_ops.lookup,mknod:_.node_ops.mknod,rename:_.node_ops.rename,unlink:_.node_ops.unlink,rmdir:_.node_ops.rmdir,readdir:_.node_ops.readdir,symlink:_.node_ops.symlink},stream:{llseek:_.stream_ops.llseek}},file:{node:{getattr:_.node_ops.getattr,setattr:_.node_ops.setattr},stream:{llseek:_.stream_ops.llseek,read:_.stream_ops.read,write:_.stream_ops.write,allocate:_.stream_ops.allocate,mmap:_.stream_ops.mmap,msync:_.stream_ops.msync}},link:{node:{getattr:_.node_ops.getattr,setattr:_.node_ops.setattr,readlink:_.node_ops.readlink},stream:{}},chrdev:{node:{getattr:_.node_ops.getattr,setattr:_.node_ops.setattr},stream:r.chrdev_stream_ops}});var i=r.createNode(e,t,n,o);return r.isDir(i.mode)?(i.node_ops=_.ops_table.dir.node,i.stream_ops=_.ops_table.dir.stream,i.contents={}):r.isFile(i.mode)?(i.node_ops=_.ops_table.file.node,i.stream_ops=_.ops_table.file.stream,i.usedBytes=0,i.contents=null):r.isLink(i.mode)?(i.node_ops=_.ops_table.link.node,i.stream_ops=_.ops_table.link.stream):r.isChrdev(i.mode)&&(i.node_ops=_.ops_table.chrdev.node,i.stream_ops=_.ops_table.chrdev.stream),i.timestamp=Date.now(),e&&(e.contents[t]=i),i},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],n=0;n<e.usedBytes;++n)t.push(e.contents[n]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array},expandFileStorage:function(e,t){var n=e.contents?e.contents.length:0;if(!(t<=n)){t=Math.max(t,n*(n<1048576?2:1.125)|0),n!=0&&(t=Math.max(t,256));var o=e.contents;e.contents=new Uint8Array(t),0<e.usedBytes&&e.contents.set(o.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(t==0)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var n=e.contents;return e.contents=new Uint8Array(new ArrayBuffer(t)),n&&e.contents.set(n.subarray(0,Math.min(t,e.usedBytes))),void(e.usedBytes=t)}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=r.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,r.isDir(e.mode)?t.size=4096:r.isFile(e.mode)?t.size=e.usedBytes:r.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){t.mode!==void 0&&(e.mode=t.mode),t.timestamp!==void 0&&(e.timestamp=t.timestamp),t.size!==void 0&&_.resizeFileStorage(e,t.size)},lookup:function(e,t){throw r.genericErrors[2]},mknod:function(e,t,n,o){return _.createNode(e,t,n,o)},rename:function(e,t,n){if(r.isDir(e.mode)){var o;try{o=r.lookupNode(t,n)}catch{}if(o)for(var i in o.contents)throw new r.ErrnoError(39)}delete e.parent.contents[e.name],e.name=n,(t.contents[n]=e).parent=t},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var n=r.lookupNode(e,t);for(var o in n.contents)throw new r.ErrnoError(39);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var n in e.contents)e.contents.hasOwnProperty(n)&&t.push(n);return t},symlink:function(e,t,n){var o=_.createNode(e,t,41471,0);return o.link=n,o},readlink:function(e){if(!r.isLink(e.mode))throw new r.ErrnoError(22);return e.link}},stream_ops:{read:function(e,t,n,o,i){var a=e.node.contents;if(i>=e.node.usedBytes)return 0;var u=Math.min(e.node.usedBytes-i,o);if(8<u&&a.subarray)t.set(a.subarray(i,i+u),n);else for(var l=0;l<u;l++)t[n+l]=a[i+l];return u},write:function(e,t,n,o,i,a){if(!o)return 0;var u=e.node;if(u.timestamp=Date.now(),t.subarray&&(!u.contents||u.contents.subarray)){if(a)return u.contents=t.subarray(n,n+o),u.usedBytes=o;if(u.usedBytes===0&&i===0)return u.contents=new Uint8Array(t.subarray(n,n+o)),u.usedBytes=o;if(i+o<=u.usedBytes)return u.contents.set(t.subarray(n,n+o),i),o}if(_.expandFileStorage(u,i+o),u.contents.subarray&&t.subarray)u.contents.set(t.subarray(n,n+o),i);else for(var l=0;l<o;l++)u.contents[i+l]=t[n+l];return u.usedBytes=Math.max(u.usedBytes,i+o),o},llseek:function(e,t,n){var o=t;if(n===1?o+=e.position:n===2&&r.isFile(e.node.mode)&&(o+=e.node.usedBytes),o<0)throw new r.ErrnoError(22);return o},allocate:function(e,t,n){_.expandFileStorage(e.node,t+n),e.node.usedBytes=Math.max(e.node.usedBytes,t+n)},mmap:function(e,t,n,o,i,a,u){if(!r.isFile(e.node.mode))throw new r.ErrnoError(19);var l,f,m=e.node.contents;if(2&u||m.buffer!==t&&m.buffer!==t.buffer){(0<i||i+o<e.node.usedBytes)&&(m=m.subarray?m.subarray(i,i+o):Array.prototype.slice.call(m,i,i+o)),f=!0;var d=t.buffer==X.buffer;if(!(l=Ze(o)))throw new r.ErrnoError(12);(d?X:t).set(m,l)}else f=!1,l=m.byteOffset;return{ptr:l,allocated:f}},msync:function(e,t,n,o,i){if(!r.isFile(e.node.mode))throw new r.ErrnoError(19);return 2&i||_.stream_ops.write(e,t,0,o,n,!1),0}}},C={dbs:{},indexedDB:function(){if(typeof indexedDB<"u")return indexedDB;var e=null;return typeof window=="object"&&(e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),H(e,"IDBFS used, but indexedDB not supported"),e},DB_VERSION:21,DB_STORE_NAME:"FILE_DATA",mount:function(e){return _.mount.apply(null,arguments)},syncfs:function(e,t,n){C.getLocalSet(e,function(o,i){if(o)return n(o);C.getRemoteSet(e,function(a,u){if(a)return n(a);var l=t?u:i,f=t?i:u;C.reconcile(l,f,n)})})},getDB:function(e,t){var n,o=C.dbs[e];if(o)return t(null,o);try{n=C.indexedDB().open(e,C.DB_VERSION)}catch(i){return t(i)}if(!n)return t("Unable to connect to IndexedDB");n.onupgradeneeded=function(i){var a,u=i.target.result,l=i.target.transaction;(a=u.objectStoreNames.contains(C.DB_STORE_NAME)?l.objectStore(C.DB_STORE_NAME):u.createObjectStore(C.DB_STORE_NAME)).indexNames.contains("timestamp")||a.createIndex("timestamp","timestamp",{unique:!1})},n.onsuccess=function(){o=n.result,C.dbs[e]=o,t(null,o)},n.onerror=function(i){t(this.error),i.preventDefault()}},getLocalSet:function(e,t){var n={};function o(f){return f!=="."&&f!==".."}function i(f){return function(m){return k.join2(f,m)}}for(var a=r.readdir(e.mountpoint).filter(o).map(i(e.mountpoint));a.length;){var u,l=a.pop();try{u=r.stat(l)}catch(f){return t(f)}r.isDir(u.mode)&&a.push.apply(a,r.readdir(l).filter(o).map(i(l))),n[l]={timestamp:u.mtime}}return t(null,{type:"local",entries:n})},getRemoteSet:function(e,t){var n={};C.getDB(e.mountpoint,function(o,i){if(o)return t(o);try{var a=i.transaction([C.DB_STORE_NAME],"readonly");a.onerror=function(u){t(this.error),u.preventDefault()},a.objectStore(C.DB_STORE_NAME).index("timestamp").openKeyCursor().onsuccess=function(u){var l=u.target.result;if(!l)return t(null,{type:"remote",db:i,entries:n});n[l.primaryKey]={timestamp:l.key},l.continue()}}catch(u){return t(u)}})},loadLocalEntry:function(e,t){var n,o;try{o=r.lookupPath(e).node,n=r.stat(e)}catch(i){return t(i)}return r.isDir(n.mode)?t(null,{timestamp:n.mtime,mode:n.mode}):r.isFile(n.mode)?(o.contents=_.getFileDataAsTypedArray(o),t(null,{timestamp:n.mtime,mode:n.mode,contents:o.contents})):t(new Error("node type not supported"))},storeLocalEntry:function(e,t,n){try{if(r.isDir(t.mode))r.mkdir(e,t.mode);else{if(!r.isFile(t.mode))return n(new Error("node type not supported"));r.writeFile(e,t.contents,{canOwn:!0})}r.chmod(e,t.mode),r.utime(e,t.timestamp,t.timestamp)}catch(o){return n(o)}n(null)},removeLocalEntry:function(e,t){try{r.lookupPath(e);var n=r.stat(e);r.isDir(n.mode)?r.rmdir(e):r.isFile(n.mode)&&r.unlink(e)}catch(o){return t(o)}t(null)},loadRemoteEntry:function(e,t,n){var o=e.get(t);o.onsuccess=function(i){n(null,i.target.result)},o.onerror=function(i){n(this.error),i.preventDefault()}},storeRemoteEntry:function(e,t,n,o){var i=e.put(n,t);i.onsuccess=function(){o(null)},i.onerror=function(a){o(this.error),a.preventDefault()}},removeRemoteEntry:function(e,t,n){var o=e.delete(t);o.onsuccess=function(){n(null)},o.onerror=function(i){n(this.error),i.preventDefault()}},reconcile:function(e,t,n){var o=0,i=[];Object.keys(e.entries).forEach(function(d){var g=e.entries[d],h=t.entries[d];(!h||g.timestamp>h.timestamp)&&(i.push(d),o++)});var a=[];if(Object.keys(t.entries).forEach(function(d){t.entries[d],e.entries[d]||(a.push(d),o++)}),!o)return n(null);var u=!1,l=(e.type==="remote"?e.db:t.db).transaction([C.DB_STORE_NAME],"readwrite"),f=l.objectStore(C.DB_STORE_NAME);function m(d){if(d&&!u)return u=!0,n(d)}l.onerror=function(d){m(this.error),d.preventDefault()},l.oncomplete=function(d){u||n(null)},i.sort().forEach(function(d){t.type==="local"?C.loadRemoteEntry(f,d,function(g,h){if(g)return m(g);C.storeLocalEntry(d,h,m)}):C.loadLocalEntry(d,function(g,h){if(g)return m(g);C.storeRemoteEntry(f,d,h,m)})}),a.sort().reverse().forEach(function(d){t.type==="local"?C.removeLocalEntry(d,m):C.removeRemoteEntry(f,d,m)})}},S={isWindows:!1,staticInit:function(){S.isWindows=!!process.platform.match(/^win/);var e=process.binding("constants");e.fs&&(e=e.fs),S.flagsForNodeMap={1024:e.O_APPEND,64:e.O_CREAT,128:e.O_EXCL,0:e.O_RDONLY,2:e.O_RDWR,4096:e.O_SYNC,512:e.O_TRUNC,1:e.O_WRONLY}},bufferFrom:function(e){return Buffer.alloc?Buffer.from(e):new Buffer(e)},mount:function(e){return H(le),S.createNode(null,"/",S.getMode(e.opts.root),0)},createNode:function(e,t,n,o){if(!r.isDir(n)&&!r.isFile(n)&&!r.isLink(n))throw new r.ErrnoError(22);var i=r.createNode(e,t,n);return i.node_ops=S.node_ops,i.stream_ops=S.stream_ops,i},getMode:function(e){var t;try{t=B.lstatSync(e),S.isWindows&&(t.mode=t.mode|(292&t.mode)>>2)}catch(n){throw n.code?new r.ErrnoError(-n.errno):n}return t.mode},realPath:function(e){for(var t=[];e.parent!==e;)t.push(e.name),e=e.parent;return t.push(e.mount.opts.root),t.reverse(),k.join.apply(null,t)},flagsForNode:function(e){e&=-2097153,e&=-2049,e&=-32769,e&=-524289;var t=0;for(var n in S.flagsForNodeMap)e&n&&(t|=S.flagsForNodeMap[n],e^=n);if(e)throw new r.ErrnoError(22);return t},node_ops:{getattr:function(e){var t,n=S.realPath(e);try{t=B.lstatSync(n)}catch(o){throw o.code?new r.ErrnoError(-o.errno):o}return S.isWindows&&!t.blksize&&(t.blksize=4096),S.isWindows&&!t.blocks&&(t.blocks=(t.size+t.blksize-1)/t.blksize|0),{dev:t.dev,ino:t.ino,mode:t.mode,nlink:t.nlink,uid:t.uid,gid:t.gid,rdev:t.rdev,size:t.size,atime:t.atime,mtime:t.mtime,ctime:t.ctime,blksize:t.blksize,blocks:t.blocks}},setattr:function(e,t){var n=S.realPath(e);try{if(t.mode!==void 0&&(B.chmodSync(n,t.mode),e.mode=t.mode),t.timestamp!==void 0){var o=new Date(t.timestamp);B.utimesSync(n,o,o)}t.size!==void 0&&B.truncateSync(n,t.size)}catch(i){throw i.code?new r.ErrnoError(-i.errno):i}},lookup:function(e,t){var n=k.join2(S.realPath(e),t),o=S.getMode(n);return S.createNode(e,t,o)},mknod:function(e,t,n,o){var i=S.createNode(e,t,n,o),a=S.realPath(i);try{r.isDir(i.mode)?B.mkdirSync(a,i.mode):B.writeFileSync(a,"",{mode:i.mode})}catch(u){throw u.code?new r.ErrnoError(-u.errno):u}return i},rename:function(e,t,n){var o=S.realPath(e),i=k.join2(S.realPath(t),n);try{B.renameSync(o,i)}catch(a){throw a.code?new r.ErrnoError(-a.errno):a}},unlink:function(e,t){var n=k.join2(S.realPath(e),t);try{B.unlinkSync(n)}catch(o){throw o.code?new r.ErrnoError(-o.errno):o}},rmdir:function(e,t){var n=k.join2(S.realPath(e),t);try{B.rmdirSync(n)}catch(o){throw o.code?new r.ErrnoError(-o.errno):o}},readdir:function(e){var t=S.realPath(e);try{return B.readdirSync(t)}catch(n){throw n.code?new r.ErrnoError(-n.errno):n}},symlink:function(e,t,n){var o=k.join2(S.realPath(e),t);try{B.symlinkSync(n,o)}catch(i){throw i.code?new r.ErrnoError(-i.errno):i}},readlink:function(e){var t=S.realPath(e);try{return t=B.readlinkSync(t),t=vt.relative(vt.resolve(e.mount.opts.root),t)}catch(n){throw n.code?new r.ErrnoError(-n.errno):n}}},stream_ops:{open:function(e){var t=S.realPath(e.node);try{r.isFile(e.node.mode)&&(e.nfd=B.openSync(t,S.flagsForNode(e.flags)))}catch(n){throw n.code?new r.ErrnoError(-n.errno):n}},close:function(e){try{r.isFile(e.node.mode)&&e.nfd&&B.closeSync(e.nfd)}catch(t){throw t.code?new r.ErrnoError(-t.errno):t}},read:function(e,t,n,o,i){if(o===0)return 0;try{return B.readSync(e.nfd,S.bufferFrom(t.buffer),n,o,i)}catch(a){throw new r.ErrnoError(-a.errno)}},write:function(e,t,n,o,i){try{return B.writeSync(e.nfd,S.bufferFrom(t.buffer),n,o,i)}catch(a){throw new r.ErrnoError(-a.errno)}},llseek:function(e,t,n){var o=t;if(n===1)o+=e.position;else if(n===2&&r.isFile(e.node.mode))try{o+=B.fstatSync(e.nfd).size}catch(i){throw new r.ErrnoError(-i.errno)}if(o<0)throw new r.ErrnoError(22);return o}}},T={DIR_MODE:16895,FILE_MODE:33279,reader:null,mount:function(e){H(U),T.reader||(T.reader=new FileReaderSync);var t=T.createNode(null,"/",T.DIR_MODE,0),n={};function o(a){for(var u=a.split("/"),l=t,f=0;f<u.length-1;f++){var m=u.slice(0,f+1).join("/");n[m]||(n[m]=T.createNode(l,u[f],T.DIR_MODE,0)),l=n[m]}return l}function i(a){var u=a.split("/");return u[u.length-1]}return Array.prototype.forEach.call(e.opts.files||[],function(a){T.createNode(o(a.name),i(a.name),T.FILE_MODE,0,a,a.lastModifiedDate)}),(e.opts.blobs||[]).forEach(function(a){T.createNode(o(a.name),i(a.name),T.FILE_MODE,0,a.data)}),(e.opts.packages||[]).forEach(function(a){a.metadata.files.forEach(function(u){var l=u.filename.substr(1);T.createNode(o(l),i(l),T.FILE_MODE,0,a.blob.slice(u.start,u.end))})}),t},createNode:function(e,t,n,o,i,a){var u=r.createNode(e,t,n);return u.mode=n,u.node_ops=T.node_ops,u.stream_ops=T.stream_ops,u.timestamp=(a||new Date).getTime(),H(T.FILE_MODE!==T.DIR_MODE),n===T.FILE_MODE?(u.size=i.size,u.contents=i):(u.size=4096,u.contents={}),e&&(e.contents[t]=u),u},node_ops:{getattr:function(e){return{dev:1,ino:void 0,mode:e.mode,nlink:1,uid:0,gid:0,rdev:void 0,size:e.size,atime:new Date(e.timestamp),mtime:new Date(e.timestamp),ctime:new Date(e.timestamp),blksize:4096,blocks:Math.ceil(e.size/4096)}},setattr:function(e,t){t.mode!==void 0&&(e.mode=t.mode),t.timestamp!==void 0&&(e.timestamp=t.timestamp)},lookup:function(e,t){throw new r.ErrnoError(2)},mknod:function(e,t,n,o){throw new r.ErrnoError(1)},rename:function(e,t,n){throw new r.ErrnoError(1)},unlink:function(e,t){throw new r.ErrnoError(1)},rmdir:function(e,t){throw new r.ErrnoError(1)},readdir:function(e){var t=[".",".."];for(var n in e.contents)e.contents.hasOwnProperty(n)&&t.push(n);return t},symlink:function(e,t,n){throw new r.ErrnoError(1)},readlink:function(e){throw new r.ErrnoError(1)}},stream_ops:{read:function(e,t,n,o,i){if(i>=e.node.size)return 0;var a=e.node.contents.slice(i,i+o),u=T.reader.readAsArrayBuffer(a);return t.set(new Uint8Array(u),n),a.size},write:function(e,t,n,o,i){throw new r.ErrnoError(5)},llseek:function(e,t,n){var o=t;if(n===1?o+=e.position:n===2&&r.isFile(e.node.mode)&&(o+=e.node.size),o<0)throw new r.ErrnoError(22);return o}}},r={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof r.ErrnoError))throw e+" : "+Wt();return se(e.errno)},lookupPath:function(e,t){if(t=t||{},!(e=G.resolve(r.cwd(),e)))return{path:"",node:null};var n={follow_mount:!0,recurse_count:0};for(var o in n)t[o]===void 0&&(t[o]=n[o]);if(8<t.recurse_count)throw new r.ErrnoError(40);for(var i=k.normalizeArray(e.split("/").filter(function(g){return!!g}),!1),a=r.root,u="/",l=0;l<i.length;l++){var f=l===i.length-1;if(f&&t.parent)break;if(a=r.lookupNode(a,i[l]),u=k.join2(u,i[l]),r.isMountpoint(a)&&(!f||f&&t.follow_mount)&&(a=a.mounted.root),!f||t.follow)for(var m=0;r.isLink(a.mode);){var d=r.readlink(u);if(u=G.resolve(k.dirname(u),d),a=r.lookupPath(u,{recurse_count:t.recurse_count}).node,40<m++)throw new r.ErrnoError(40)}}return{path:u,node:a}},getPath:function(e){for(var t;;){if(r.isRoot(e)){var n=e.mount.mountpoint;return t?n[n.length-1]!=="/"?n+"/"+t:n+t:n}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var n=0,o=0;o<t.length;o++)n=(n<<5)-n+t.charCodeAt(o)|0;return(e+n>>>0)%r.nameTable.length},hashAddNode:function(e){var t=r.hashName(e.parent.id,e.name);e.name_next=r.nameTable[t],r.nameTable[t]=e},hashRemoveNode:function(e){var t=r.hashName(e.parent.id,e.name);if(r.nameTable[t]===e)r.nameTable[t]=e.name_next;else for(var n=r.nameTable[t];n;){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}},lookupNode:function(e,t){var n=r.mayLookup(e);if(n)throw new r.ErrnoError(n,e);for(var o=r.hashName(e.id,t),i=r.nameTable[o];i;i=i.name_next){var a=i.name;if(i.parent.id===e.id&&a===t)return i}return r.lookup(e,t)},createNode:function(e,t,n,o){r.FSNode||(r.FSNode=function(a,u,l,f){a=a||this,this.parent=a,this.mount=a.mount,this.mounted=null,this.id=r.nextInode++,this.name=u,this.mode=l,this.node_ops={},this.stream_ops={},this.rdev=f},r.FSNode.prototype={},Object.defineProperties(r.FSNode.prototype,{read:{get:function(){return(365&this.mode)==365},set:function(a){a?this.mode|=365:this.mode&=-366}},write:{get:function(){return(146&this.mode)==146},set:function(a){a?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return r.isDir(this.mode)}},isDevice:{get:function(){return r.isChrdev(this.mode)}}}));var i=new r.FSNode(e,t,n,o);return r.hashAddNode(i),i},destroyNode:function(e){r.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return(61440&e)==32768},isDir:function(e){return(61440&e)==16384},isLink:function(e){return(61440&e)==40960},isChrdev:function(e){return(61440&e)==8192},isBlkdev:function(e){return(61440&e)==24576},isFIFO:function(e){return(61440&e)==4096},isSocket:function(e){return(49152&e)==49152},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=r.flagModes[e];if(t===void 0)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return r.ignorePermissions||(t.indexOf("r")===-1||292&e.mode)&&(t.indexOf("w")===-1||146&e.mode)&&(t.indexOf("x")===-1||73&e.mode)?0:13},mayLookup:function(e){var t=r.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:13)},mayCreate:function(e,t){try{return r.lookupNode(e,t),17}catch{}return r.nodePermissions(e,"wx")},mayDelete:function(e,t,n){var o;try{o=r.lookupNode(e,t)}catch(a){return a.errno}var i=r.nodePermissions(e,"wx");if(i)return i;if(n){if(!r.isDir(o.mode))return 20;if(r.isRoot(o)||r.getPath(o)===r.cwd())return 16}else if(r.isDir(o.mode))return 21;return 0},mayOpen:function(e,t){return e?r.isLink(e.mode)?40:r.isDir(e.mode)&&(r.flagsToPermissionString(t)!=="r"||512&t)?21:r.nodePermissions(e,r.flagsToPermissionString(t)):2},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||r.MAX_OPEN_FDS;for(var n=e;n<=t;n++)if(!r.streams[n])return n;throw new r.ErrnoError(24)},getStream:function(e){return r.streams[e]},createStream:function(e,t,n){r.FSStream||(r.FSStream=function(){},r.FSStream.prototype={},Object.defineProperties(r.FSStream.prototype,{object:{get:function(){return this.node},set:function(u){this.node=u}},isRead:{get:function(){return(2097155&this.flags)!=1}},isWrite:{get:function(){return(2097155&this.flags)!=0}},isAppend:{get:function(){return 1024&this.flags}}}));var o=new r.FSStream;for(var i in e)o[i]=e[i];e=o;var a=r.nextfd(t,n);return e.fd=a,r.streams[a]=e},closeStream:function(e){r.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=r.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new r.ErrnoError(29)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){r.devices[e]={stream_ops:t}},getDevice:function(e){return r.devices[e]},getMounts:function(e){for(var t=[],n=[e];n.length;){var o=n.pop();t.push(o),n.push.apply(n,o.mounts)}return t},syncfs:function(e,t){typeof e=="function"&&(t=e,e=!1),r.syncFSRequests++,1<r.syncFSRequests&&console.log("warning: "+r.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var n=r.getMounts(r.root.mount),o=0;function i(u){return r.syncFSRequests--,t(u)}function a(u){if(u)return a.errored?void 0:(a.errored=!0,i(u));++o>=n.length&&i(null)}n.forEach(function(u){if(!u.type.syncfs)return a(null);u.type.syncfs(u,e,a)})},mount:function(e,t,n){var o,i=n==="/",a=!n;if(i&&r.root)throw new r.ErrnoError(16);if(!i&&!a){var u=r.lookupPath(n,{follow_mount:!1});if(n=u.path,o=u.node,r.isMountpoint(o))throw new r.ErrnoError(16);if(!r.isDir(o.mode))throw new r.ErrnoError(20)}var l={type:e,opts:t,mountpoint:n,mounts:[]},f=e.mount(l);return(f.mount=l).root=f,i?r.root=f:o&&(o.mounted=l,o.mount&&o.mount.mounts.push(l)),f},unmount:function(e){var t=r.lookupPath(e,{follow_mount:!1});if(!r.isMountpoint(t.node))throw new r.ErrnoError(22);var n=t.node,o=n.mounted,i=r.getMounts(o);Object.keys(r.nameTable).forEach(function(u){for(var l=r.nameTable[u];l;){var f=l.name_next;i.indexOf(l.mount)!==-1&&r.destroyNode(l),l=f}}),n.mounted=null;var a=n.mount.mounts.indexOf(o);n.mount.mounts.splice(a,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,n){var o=r.lookupPath(e,{parent:!0}).node,i=k.basename(e);if(!i||i==="."||i==="..")throw new r.ErrnoError(22);var a=r.mayCreate(o,i);if(a)throw new r.ErrnoError(a);if(!o.node_ops.mknod)throw new r.ErrnoError(1);return o.node_ops.mknod(o,i,t,n)},create:function(e,t){return t=t!==void 0?t:438,t&=4095,t|=32768,r.mknod(e,t,0)},mkdir:function(e,t){return t=t!==void 0?t:511,t&=1023,t|=16384,r.mknod(e,t,0)},mkdirTree:function(e,t){for(var n=e.split("/"),o="",i=0;i<n.length;++i)if(n[i]){o+="/"+n[i];try{r.mkdir(o,t)}catch(a){if(a.errno!=17)throw a}}},mkdev:function(e,t,n){return n===void 0&&(n=t,t=438),t|=8192,r.mknod(e,t,n)},symlink:function(e,t){if(!G.resolve(e))throw new r.ErrnoError(2);var n=r.lookupPath(t,{parent:!0}).node;if(!n)throw new r.ErrnoError(2);var o=k.basename(t),i=r.mayCreate(n,o);if(i)throw new r.ErrnoError(i);if(!n.node_ops.symlink)throw new r.ErrnoError(1);return n.node_ops.symlink(n,o,e)},rename:function(e,t){var n,o,i=k.dirname(e),a=k.dirname(t),u=k.basename(e),l=k.basename(t);try{n=r.lookupPath(e,{parent:!0}).node,o=r.lookupPath(t,{parent:!0}).node}catch{throw new r.ErrnoError(16)}if(!n||!o)throw new r.ErrnoError(2);if(n.mount!==o.mount)throw new r.ErrnoError(18);var f,m=r.lookupNode(n,u),d=G.relative(e,a);if(d.charAt(0)!==".")throw new r.ErrnoError(22);if((d=G.relative(t,i)).charAt(0)!==".")throw new r.ErrnoError(39);try{f=r.lookupNode(o,l)}catch{}if(m!==f){var g=r.isDir(m.mode),h=r.mayDelete(n,u,g);if(h)throw new r.ErrnoError(h);if(h=f?r.mayDelete(o,l,g):r.mayCreate(o,l))throw new r.ErrnoError(h);if(!n.node_ops.rename)throw new r.ErrnoError(1);if(r.isMountpoint(m)||f&&r.isMountpoint(f))throw new r.ErrnoError(16);if(o!==n&&(h=r.nodePermissions(n,"w")))throw new r.ErrnoError(h);try{r.trackingDelegate.willMovePath&&r.trackingDelegate.willMovePath(e,t)}catch(y){console.log("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+y.message)}r.hashRemoveNode(m);try{n.node_ops.rename(m,o,l)}catch(y){throw y}finally{r.hashAddNode(m)}try{r.trackingDelegate.onMovePath&&r.trackingDelegate.onMovePath(e,t)}catch(y){console.log("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+y.message)}}},rmdir:function(e){var t=r.lookupPath(e,{parent:!0}).node,n=k.basename(e),o=r.lookupNode(t,n),i=r.mayDelete(t,n,!0);if(i)throw new r.ErrnoError(i);if(!t.node_ops.rmdir)throw new r.ErrnoError(1);if(r.isMountpoint(o))throw new r.ErrnoError(16);try{r.trackingDelegate.willDeletePath&&r.trackingDelegate.willDeletePath(e)}catch(a){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+a.message)}t.node_ops.rmdir(t,n),r.destroyNode(o);try{r.trackingDelegate.onDeletePath&&r.trackingDelegate.onDeletePath(e)}catch(a){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+a.message)}},readdir:function(e){var t=r.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new r.ErrnoError(20);return t.node_ops.readdir(t)},unlink:function(e){var t=r.lookupPath(e,{parent:!0}).node,n=k.basename(e),o=r.lookupNode(t,n),i=r.mayDelete(t,n,!1);if(i)throw new r.ErrnoError(i);if(!t.node_ops.unlink)throw new r.ErrnoError(1);if(r.isMountpoint(o))throw new r.ErrnoError(16);try{r.trackingDelegate.willDeletePath&&r.trackingDelegate.willDeletePath(e)}catch(a){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+a.message)}t.node_ops.unlink(t,n),r.destroyNode(o);try{r.trackingDelegate.onDeletePath&&r.trackingDelegate.onDeletePath(e)}catch(a){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+a.message)}},readlink:function(e){var t=r.lookupPath(e).node;if(!t)throw new r.ErrnoError(2);if(!t.node_ops.readlink)throw new r.ErrnoError(22);return G.resolve(r.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var n=r.lookupPath(e,{follow:!t}).node;if(!n)throw new r.ErrnoError(2);if(!n.node_ops.getattr)throw new r.ErrnoError(1);return n.node_ops.getattr(n)},lstat:function(e){return r.stat(e,!0)},chmod:function(e,t,n){var o;if(typeof e=="string"?o=r.lookupPath(e,{follow:!n}).node:o=e,!o.node_ops.setattr)throw new r.ErrnoError(1);o.node_ops.setattr(o,{mode:4095&t|-4096&o.mode,timestamp:Date.now()})},lchmod:function(e,t){r.chmod(e,t,!0)},fchmod:function(e,t){var n=r.getStream(e);if(!n)throw new r.ErrnoError(9);r.chmod(n.node,t)},chown:function(e,t,n,o){var i;if(typeof e=="string"?i=r.lookupPath(e,{follow:!o}).node:i=e,!i.node_ops.setattr)throw new r.ErrnoError(1);i.node_ops.setattr(i,{timestamp:Date.now()})},lchown:function(e,t,n){r.chown(e,t,n,!0)},fchown:function(e,t,n){var o=r.getStream(e);if(!o)throw new r.ErrnoError(9);r.chown(o.node,t,n)},truncate:function(e,t){if(t<0)throw new r.ErrnoError(22);var n;if(typeof e=="string"?n=r.lookupPath(e,{follow:!0}).node:n=e,!n.node_ops.setattr)throw new r.ErrnoError(1);if(r.isDir(n.mode))throw new r.ErrnoError(21);if(!r.isFile(n.mode))throw new r.ErrnoError(22);var o=r.nodePermissions(n,"w");if(o)throw new r.ErrnoError(o);n.node_ops.setattr(n,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var n=r.getStream(e);if(!n)throw new r.ErrnoError(9);if((2097155&n.flags)==0)throw new r.ErrnoError(22);r.truncate(n.node,t)},utime:function(e,t,n){var o=r.lookupPath(e,{follow:!0}).node;o.node_ops.setattr(o,{timestamp:Math.max(t,n)})},open:function(e,t,n,o,i){if(e==="")throw new r.ErrnoError(2);var a;if(n=n===void 0?438:n,n=64&(t=typeof t=="string"?r.modeStringToFlags(t):t)?4095&n|32768:0,typeof e=="object")a=e;else{e=k.normalize(e);try{a=r.lookupPath(e,{follow:!(131072&t)}).node}catch{}}var u=!1;if(64&t)if(a){if(128&t)throw new r.ErrnoError(17)}else a=r.mknod(e,n,0),u=!0;if(!a)throw new r.ErrnoError(2);if(r.isChrdev(a.mode)&&(t&=-513),65536&t&&!r.isDir(a.mode))throw new r.ErrnoError(20);if(!u){var l=r.mayOpen(a,t);if(l)throw new r.ErrnoError(l)}512&t&&r.truncate(a,0),t&=-641;var f=r.createStream({node:a,path:r.getPath(a),flags:t,seekable:!0,position:0,stream_ops:a.stream_ops,ungotten:[],error:!1},o,i);f.stream_ops.open&&f.stream_ops.open(f),!s.logReadFiles||1&t||(r.readFiles||(r.readFiles={}),e in r.readFiles||(r.readFiles[e]=1,console.log("FS.trackingDelegate error on read file: "+e)));try{if(r.trackingDelegate.onOpenFile){var m=0;(2097155&t)!=1&&(m|=r.tracking.openFlags.READ),(2097155&t)!=0&&(m|=r.tracking.openFlags.WRITE),r.trackingDelegate.onOpenFile(e,m)}}catch(d){console.log("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+d.message)}return f},close:function(e){if(r.isClosed(e))throw new r.ErrnoError(9);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{r.closeStream(e.fd)}e.fd=null},isClosed:function(e){return e.fd===null},llseek:function(e,t,n){if(r.isClosed(e))throw new r.ErrnoError(9);if(!e.seekable||!e.stream_ops.llseek)throw new r.ErrnoError(29);if(n!=0&&n!=1&&n!=2)throw new r.ErrnoError(22);return e.position=e.stream_ops.llseek(e,t,n),e.ungotten=[],e.position},read:function(e,t,n,o,i){if(o<0||i<0)throw new r.ErrnoError(22);if(r.isClosed(e))throw new r.ErrnoError(9);if((2097155&e.flags)==1)throw new r.ErrnoError(9);if(r.isDir(e.node.mode))throw new r.ErrnoError(21);if(!e.stream_ops.read)throw new r.ErrnoError(22);var a=i!==void 0;if(a){if(!e.seekable)throw new r.ErrnoError(29)}else i=e.position;var u=e.stream_ops.read(e,t,n,o,i);return a||(e.position+=u),u},write:function(e,t,n,o,i,a){if(o<0||i<0)throw new r.ErrnoError(22);if(r.isClosed(e))throw new r.ErrnoError(9);if((2097155&e.flags)==0)throw new r.ErrnoError(9);if(r.isDir(e.node.mode))throw new r.ErrnoError(21);if(!e.stream_ops.write)throw new r.ErrnoError(22);1024&e.flags&&r.llseek(e,0,2);var u=i!==void 0;if(u){if(!e.seekable)throw new r.ErrnoError(29)}else i=e.position;var l=e.stream_ops.write(e,t,n,o,i,a);u||(e.position+=l);try{e.path&&r.trackingDelegate.onWriteToFile&&r.trackingDelegate.onWriteToFile(e.path)}catch(f){console.log("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+f.message)}return l},allocate:function(e,t,n){if(r.isClosed(e))throw new r.ErrnoError(9);if(t<0||n<=0)throw new r.ErrnoError(22);if((2097155&e.flags)==0)throw new r.ErrnoError(9);if(!r.isFile(e.node.mode)&&!r.isDir(e.node.mode))throw new r.ErrnoError(19);if(!e.stream_ops.allocate)throw new r.ErrnoError(95);e.stream_ops.allocate(e,t,n)},mmap:function(e,t,n,o,i,a,u){if((2&a)!=0&&(2&u)==0&&(2097155&e.flags)!=2)throw new r.ErrnoError(13);if((2097155&e.flags)==1)throw new r.ErrnoError(13);if(!e.stream_ops.mmap)throw new r.ErrnoError(19);return e.stream_ops.mmap(e,t,n,o,i,a,u)},msync:function(e,t,n,o,i){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,n,o,i):0},munmap:function(e){return 0},ioctl:function(e,t,n){if(!e.stream_ops.ioctl)throw new r.ErrnoError(25);return e.stream_ops.ioctl(e,t,n)},readFile:function(e,t){if((t=t||{}).flags=t.flags||"r",t.encoding=t.encoding||"binary",t.encoding!=="utf8"&&t.encoding!=="binary")throw new Error('Invalid encoding type "'+t.encoding+'"');var n,o=r.open(e,t.flags),i=r.stat(e).size,a=new Uint8Array(i);return r.read(o,a,0,i,0),t.encoding==="utf8"?n=fe(a,0):t.encoding==="binary"&&(n=a),r.close(o),n},writeFile:function(e,t,n){(n=n||{}).flags=n.flags||"w";var o=r.open(e,n.flags,n.mode);if(typeof t=="string"){var i=new Uint8Array(we(t)+1),a=ve(t,i,0,i.length);r.write(o,i,0,a,void 0,n.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");r.write(o,t,0,t.byteLength,void 0,n.canOwn)}r.close(o)},cwd:function(){return r.currentPath},chdir:function(e){var t=r.lookupPath(e,{follow:!0});if(t.node===null)throw new r.ErrnoError(2);if(!r.isDir(t.node.mode))throw new r.ErrnoError(20);var n=r.nodePermissions(t.node,"x");if(n)throw new r.ErrnoError(n);r.currentPath=t.path},createDefaultDirectories:function(){r.mkdir("/tmp"),r.mkdir("/home"),r.mkdir("/home/web_user")},createDefaultDevices:function(){var e;if(r.mkdir("/dev"),r.registerDevice(r.makedev(1,3),{read:function(){return 0},write:function(o,i,a,u,l){return u}}),r.mkdev("/dev/null",r.makedev(1,3)),ue.register(r.makedev(5,0),ue.default_tty_ops),ue.register(r.makedev(6,0),ue.default_tty1_ops),r.mkdev("/dev/tty",r.makedev(5,0)),r.mkdev("/dev/tty1",r.makedev(6,0)),typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}else if(K)try{var n=_e;e=function(){return n.randomBytes(1)[0]}}catch{}e=e||function(){z("random_device")},r.createDevice("/dev","random",e),r.createDevice("/dev","urandom",e),r.mkdir("/dev/shm"),r.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){r.mkdir("/proc"),r.mkdir("/proc/self"),r.mkdir("/proc/self/fd"),r.mount({mount:function(){var e=r.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(t,n){var o=+n,i=r.getStream(o);if(!i)throw new r.ErrnoError(9);var a={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return i.path}}};return a.parent=a}},e}},{},"/proc/self/fd")},createStandardStreams:function(){s.stdin?r.createDevice("/dev","stdin",s.stdin):r.symlink("/dev/tty","/dev/stdin"),s.stdout?r.createDevice("/dev","stdout",null,s.stdout):r.symlink("/dev/tty","/dev/stdout"),s.stderr?r.createDevice("/dev","stderr",null,s.stderr):r.symlink("/dev/tty1","/dev/stderr"),r.open("/dev/stdin","r"),r.open("/dev/stdout","w"),r.open("/dev/stderr","w")},ensureErrnoError:function(){r.ErrnoError||(r.ErrnoError=function(e,t){this.node=t,this.setErrno=function(n){this.errno=n},this.setErrno(e),this.message="FS error",this.stack&&Object.defineProperty(this,"stack",{value:new Error().stack,writable:!0})},r.ErrnoError.prototype=new Error,r.ErrnoError.prototype.constructor=r.ErrnoError,[2].forEach(function(e){r.genericErrors[e]=new r.ErrnoError(e),r.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){r.ensureErrnoError(),r.nameTable=new Array(4096),r.mount(_,{},"/"),r.createDefaultDirectories(),r.createDefaultDevices(),r.createSpecialDirectories(),r.filesystems={MEMFS:_,IDBFS:C,NODEFS:S,WORKERFS:T}},init:function(e,t,n){r.init.initialized=!0,r.ensureErrnoError(),s.stdin=e||s.stdin,s.stdout=t||s.stdout,s.stderr=n||s.stderr,r.createStandardStreams()},quit:function(){r.init.initialized=!1;var e=s._fflush;e&&e(0);for(var t=0;t<r.streams.length;t++){var n=r.streams[t];n&&r.close(n)}},getMode:function(e,t){var n=0;return e&&(n|=365),t&&(n|=146),n},joinPath:function(e,t){var n=k.join.apply(null,e);return t&&n[0]=="/"&&(n=n.substr(1)),n},absolutePath:function(e,t){return G.resolve(t,e)},standardizePath:function(e){return k.normalize(e)},findObject:function(e,t){var n=r.analyzePath(e,t);return n.exists?n.object:(se(n.error),null)},analyzePath:function(e,t){try{e=(o=r.lookupPath(e,{follow:!t})).path}catch{}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var o=r.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=o.path,n.parentObject=o.node,n.name=k.basename(e),o=r.lookupPath(e,{follow:!t}),n.exists=!0,n.path=o.path,n.object=o.node,n.name=o.node.name,n.isRoot=o.path==="/"}catch(i){n.error=i.errno}return n},createFolder:function(e,t,n,o){var i=k.join2(typeof e=="string"?e:r.getPath(e),t),a=r.getMode(n,o);return r.mkdir(i,a)},createPath:function(e,t,n,o){e=typeof e=="string"?e:r.getPath(e);for(var i=t.split("/").reverse();i.length;){var a=i.pop();if(a){var u=k.join2(e,a);try{r.mkdir(u)}catch{}e=u}}return u},createFile:function(e,t,n,o,i){var a=k.join2(typeof e=="string"?e:r.getPath(e),t),u=r.getMode(o,i);return r.create(a,u)},createDataFile:function(e,t,n,o,i,a){var u=t?k.join2(typeof e=="string"?e:r.getPath(e),t):e,l=r.getMode(o,i),f=r.create(u,l);if(n){if(typeof n=="string"){for(var m=new Array(n.length),d=0,g=n.length;d<g;++d)m[d]=n.charCodeAt(d);n=m}r.chmod(f,146|l);var h=r.open(f,"w");r.write(h,n,0,n.length,0,a),r.close(h),r.chmod(f,l)}return f},createDevice:function(e,t,n,o){var i=k.join2(typeof e=="string"?e:r.getPath(e),t),a=r.getMode(!!n,!!o);r.createDevice.major||(r.createDevice.major=64);var u=r.makedev(r.createDevice.major++,0);return r.registerDevice(u,{open:function(l){l.seekable=!1},close:function(l){o&&o.buffer&&o.buffer.length&&o(10)},read:function(l,f,m,d,g){for(var h=0,y=0;y<d;y++){var M;try{M=n()}catch{throw new r.ErrnoError(5)}if(M===void 0&&h===0)throw new r.ErrnoError(11);if(M==null)break;h++,f[m+y]=M}return h&&(l.node.timestamp=Date.now()),h},write:function(l,f,m,d,g){for(var h=0;h<d;h++)try{o(f[m+h])}catch{throw new r.ErrnoError(5)}return d&&(l.node.timestamp=Date.now()),h}}),r.mkdev(i,a,u)},createLink:function(e,t,n,o,i){var a=k.join2(typeof e=="string"?e:r.getPath(e),t);return r.symlink(n,a)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var t=!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!ne)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=xe(ne(e.url),!0),e.usedBytes=e.contents.length}catch{t=!1}return t||se(5),t},createLazyFile:function(e,t,n,o,i){function a(){this.lengthKnown=!1,this.chunks=[]}if(a.prototype.get=function(d){if(!(d>this.length-1||d<0)){var g=d%this.chunkSize,h=d/this.chunkSize|0;return this.getter(h)[g]}},a.prototype.setDataGetter=function(d){this.getter=d},a.prototype.cacheLength=function(){var d=new XMLHttpRequest;if(d.open("HEAD",n,!1),d.send(null),!(200<=d.status&&d.status<300||d.status===304))throw new Error("Couldn't load "+n+". Status: "+d.status);var g,h=Number(d.getResponseHeader("Content-length")),y=(g=d.getResponseHeader("Accept-Ranges"))&&g==="bytes",M=(g=d.getResponseHeader("Content-Encoding"))&&g==="gzip",L=1048576;y||(L=h);var j=this;j.setDataGetter(function(R){var p=R*L,v=(R+1)*L-1;if(v=Math.min(v,h-1),j.chunks[R]===void 0&&(j.chunks[R]=(function(P,A){if(A<P)throw new Error("invalid range ("+P+", "+A+") or no bytes requested!");if(h-1<A)throw new Error("only "+h+" bytes available! programmer error!");var x=new XMLHttpRequest;if(x.open("GET",n,!1),h!==L&&x.setRequestHeader("Range","bytes="+P+"-"+A),typeof Uint8Array<"u"&&(x.responseType="arraybuffer"),x.overrideMimeType&&x.overrideMimeType("text/plain; charset=x-user-defined"),x.send(null),!(200<=x.status&&x.status<300||x.status===304))throw new Error("Couldn't load "+n+". Status: "+x.status);return x.response!==void 0?new Uint8Array(x.response||[]):xe(x.responseText||"",!0)})(p,v)),j.chunks[R]===void 0)throw new Error("doXHR failed!");return j.chunks[R]}),!M&&h||(L=h=1,h=this.getter(0).length,L=h,console.log("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=h,this._chunkSize=L,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!U)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var u=new a;Object.defineProperties(u,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var l={isDevice:!1,contents:u}}else l={isDevice:!1,url:n};var f=r.createFile(e,t,l,o,i);l.contents?f.contents=l.contents:l.url&&(f.contents=null,f.url=l.url),Object.defineProperties(f,{usedBytes:{get:function(){return this.contents.length}}});var m={};return Object.keys(f.stream_ops).forEach(function(d){var g=f.stream_ops[d];m[d]=function(){if(!r.forceLoadFile(f))throw new r.ErrnoError(5);return g.apply(null,arguments)}}),m.read=function(d,g,h,y,M){if(!r.forceLoadFile(f))throw new r.ErrnoError(5);var L=d.node.contents;if(M>=L.length)return 0;var j=Math.min(L.length-M,y);if(L.slice)for(var R=0;R<j;R++)g[h+R]=L[M+R];else for(R=0;R<j;R++)g[h+R]=L.get(M+R);return j},f.stream_ops=m,f},createPreloadedFile:function(e,t,n,o,i,a,u,l,f,m){c.init();var d=t?G.resolve(k.join2(e,t)):e;function g(h){function y(L){m&&m(),l||r.createDataFile(e,t,L,o,i,f),a&&a(),Fe()}var M=!1;s.preloadPlugins.forEach(function(L){M||L.canHandle(d)&&(L.handle(h,d,y,function(){u&&u(),Fe()}),M=!0)}),M||y(h)}Ge(),typeof n=="string"?c.asyncLoad(n,function(h){g(h)},u):g(n)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,n){t=t||function(){},n=n||function(){};var o=r.indexedDB();try{var i=o.open(r.DB_NAME(),r.DB_VERSION)}catch(a){return n(a)}i.onupgradeneeded=function(){console.log("creating db"),i.result.createObjectStore(r.DB_STORE_NAME)},i.onsuccess=function(){var a=i.result.transaction([r.DB_STORE_NAME],"readwrite"),u=a.objectStore(r.DB_STORE_NAME),l=0,f=0,m=e.length;function d(){f==0?t():n()}e.forEach(function(g){var h=u.put(r.analyzePath(g).object.contents,g);h.onsuccess=function(){++l+f==m&&d()},h.onerror=function(){l+ ++f==m&&d()}}),a.onerror=n},i.onerror=n},loadFilesFromDB:function(e,t,n){t=t||function(){},n=n||function(){};var o=r.indexedDB();try{var i=o.open(r.DB_NAME(),r.DB_VERSION)}catch(a){return n(a)}i.onupgradeneeded=n,i.onsuccess=function(){var a=i.result;try{var u=a.transaction([r.DB_STORE_NAME],"readonly")}catch(h){return void n(h)}var l=u.objectStore(r.DB_STORE_NAME),f=0,m=0,d=e.length;function g(){m==0?t():n()}e.forEach(function(h){var y=l.get(h);y.onsuccess=function(){r.analyzePath(h).exists&&r.unlink(h),r.createDataFile(k.dirname(h),k.basename(h),y.result,!0,!0,!0),++f+m==d&&g()},y.onerror=function(){f+ ++m==d&&g()}}),u.onerror=n},i.onerror=n}},E={DEFAULT_POLLMASK:5,mappings:{},umask:511,calculateAt:function(e,t){if(t[0]!=="/"){var n;if(e===-100)n=r.cwd();else{var o=r.getStream(e);if(!o)throw new r.ErrnoError(9);n=o.path}t=k.join2(n,t)}return t},doStat:function(e,t,n){try{var o=e(t)}catch(i){if(i&&i.node&&k.normalize(t)!==k.normalize(r.getPath(i.node)))return-20;throw i}return w[n>>2]=o.dev,w[n+4>>2]=0,w[n+8>>2]=o.ino,w[n+12>>2]=o.mode,w[n+16>>2]=o.nlink,w[n+20>>2]=o.uid,w[n+24>>2]=o.gid,w[n+28>>2]=o.rdev,w[n+32>>2]=0,Q=[o.size>>>0,(I=o.size,1<=+He(I)?0<I?(0|Xe(+Ve(I/4294967296),4294967295))>>>0:~~+We((I-+(~~I>>>0))/4294967296)>>>0:0)],w[n+40>>2]=Q[0],w[n+44>>2]=Q[1],w[n+48>>2]=4096,w[n+52>>2]=o.blocks,w[n+56>>2]=o.atime.getTime()/1e3|0,w[n+60>>2]=0,w[n+64>>2]=o.mtime.getTime()/1e3|0,w[n+68>>2]=0,w[n+72>>2]=o.ctime.getTime()/1e3|0,w[n+76>>2]=0,Q=[o.ino>>>0,(I=o.ino,1<=+He(I)?0<I?(0|Xe(+Ve(I/4294967296),4294967295))>>>0:~~+We((I-+(~~I>>>0))/4294967296)>>>0:0)],w[n+80>>2]=Q[0],w[n+84>>2]=Q[1],0},doMsync:function(e,t,n,o){var i=new Uint8Array(de.subarray(e,e+n));r.msync(t,i,0,n,o)},doMkdir:function(e,t){return(e=k.normalize(e))[e.length-1]==="/"&&(e=e.substr(0,e.length-1)),r.mkdir(e,t,0),0},doMknod:function(e,t,n){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-22}return r.mknod(e,t,n),0},doReadlink:function(e,t,n){if(n<=0)return-22;var o=r.readlink(e),i=Math.min(n,we(o)),a=X[t+i];return rt(o,t,n+1),X[t+i]=a,i},doAccess:function(e,t){if(-8&t)return-22;var n;if(!(n=r.lookupPath(e,{follow:!0}).node))return-2;var o="";return 4&t&&(o+="r"),2&t&&(o+="w"),1&t&&(o+="x"),o&&r.nodePermissions(n,o)?-13:0},doDup:function(e,t,n){var o=r.getStream(n);return o&&r.close(o),r.open(e,t,0,n,n).fd},doReadv:function(e,t,n,o){for(var i=0,a=0;a<n;a++){var u=w[t+8*a>>2],l=w[t+(8*a+4)>>2],f=r.read(e,X,u,l,o);if(f<0)return-1;if(i+=f,f<l)break}return i},doWritev:function(e,t,n,o){for(var i=0,a=0;a<n;a++){var u=w[t+8*a>>2],l=w[t+(8*a+4)>>2],f=r.write(e,X,u,l,o);if(f<0)return-1;i+=f}return i},varargs:0,get:function(e){return E.varargs+=4,w[E.varargs-4>>2]},getStr:function(){return ge(E.get())},getStreamFromFD:function(){var e=r.getStream(E.get());if(!e)throw new r.ErrnoError(9);return e},get64:function(){var e=E.get();return E.get(),e},getZero:function(){E.get()}};function Jt(e,t){E.varargs=t;try{var n=E.getStreamFromFD(),o=E.get(),i=E.get(),a=E.get(),u=E.get(),l=4294967296*o+(i>>>0),f=9007199254740992;return l<=-f||f<=l?-75:(r.llseek(n,l,u),Q=[n.position>>>0,(I=n.position,1<=+He(I)?0<I?(0|Xe(+Ve(I/4294967296),4294967295))>>>0:~~+We((I-+(~~I>>>0))/4294967296)>>>0:0)],w[a>>2]=Q[0],w[a+4>>2]=Q[1],n.getdents&&l==0&&u===0&&(n.getdents=null),0)}catch(m){return r!==void 0&&m instanceof r.ErrnoError||z(m),-m.errno}}function Qt(e,t){E.varargs=t;try{var n=E.getStreamFromFD(),o=E.get(),i=E.get();return E.doReadv(n,o,i)}catch(a){return r!==void 0&&a instanceof r.ErrnoError||z(a),-a.errno}}function en(e,t){E.varargs=t;try{var n=E.getStreamFromFD(),o=E.get(),i=E.get();return E.doWritev(n,o,i)}catch(a){return r!==void 0&&a instanceof r.ErrnoError||z(a),-a.errno}}function tn(e,t){E.varargs=t;try{var n=E.getStreamFromFD();switch(E.get()){case 0:return(o=E.get())<0?-22:r.open(n.path,n.flags,0,o).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:var o=E.get();return n.flags|=o,0;case 12:return o=E.get(),at[o+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-22;case 9:return se(22),-1;default:return-22}}catch(i){return r!==void 0&&i instanceof r.ErrnoError||z(i),-i.errno}}function nn(e,t){E.varargs=t;try{var n=E.getStr(),o=E.get(),i=E.get();return r.open(n,o,i).fd}catch(a){return r!==void 0&&a instanceof r.ErrnoError||z(a),-a.errno}}function rn(e,t){E.varargs=t;try{var n=E.getStreamFromFD(),o=E.get();switch(o){case 21509:case 21505:return n.tty?0:-25;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-25;case 21519:if(!n.tty)return-25;var i=E.get();return w[i>>2]=0;case 21520:return n.tty?-22:-25;case 21531:return i=E.get(),r.ioctl(n,o,i);case 21523:case 21524:return n.tty?0:-25;default:z("bad ioctl syscall "+o)}}catch(a){return r!==void 0&&a instanceof r.ErrnoError||z(a),-a.errno}}function on(e,t){E.varargs=t;try{var n=E.getStreamFromFD();return r.close(n),0}catch(o){return r!==void 0&&o instanceof r.ErrnoError||z(o),-o.errno}}function an(e,t){if(e===-1||t===0)return-22;var n=E.mappings[e];if(!n)return 0;if(t===n.len){var o=r.getStream(n.fd);E.doMsync(e,o,t,n.flags),E.mappings[e]=null,n.allocated&&yt(n.malloc)}return 0}function sn(e,t){E.varargs=t;try{return an(E.get(),E.get())}catch(n){return r!==void 0&&n instanceof r.ErrnoError||z(n),-n.errno}}function un(){}function cn(){s.abort()}function Me(){z()}function ln(){return K||typeof dateNow<"u"||typeof performance=="object"&&performance&&typeof performance.now=="function"}function fn(e,t){var n;if(e===0)n=Date.now();else{if(e!==1||!ln())return se(22),-1;n=Me()}return w[t>>2]=n/1e3|0,w[t+4>>2]=n%1e3*1e3*1e3|0,0}function dn(e,t){if(c.mainLoop.timingMode=e,c.mainLoop.timingValue=t,!c.mainLoop.func)return 1;if(e==0)c.mainLoop.scheduler=function(){var i=0|Math.max(0,c.mainLoop.tickStartTime+t-Me());setTimeout(c.mainLoop.runner,i)},c.mainLoop.method="timeout";else if(e==1)c.mainLoop.scheduler=function(){c.requestAnimationFrame(c.mainLoop.runner)},c.mainLoop.method="rAF";else if(e==2){if(typeof setImmediate>"u"){var n=[],o="setimmediate";addEventListener("message",function(i){i.data!==o&&i.data.target!==o||(i.stopPropagation(),n.shift()())},!0),setImmediate=function(i){n.push(i),U?(s.setImmediates===void 0&&(s.setImmediates=[]),s.setImmediates.push(i),postMessage({target:o})):postMessage(o,"*")}}c.mainLoop.scheduler=function(){setImmediate(c.mainLoop.runner)},c.mainLoop.method="immediate"}return 0}function mn(e,t,n,o,i){var a;s.noExitRuntime=!0,H(!c.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),c.mainLoop.func=e,c.mainLoop.arg=o,a=o!==void 0?function(){s.dynCall_vi(e,o)}:function(){s.dynCall_v(e)};var u=c.mainLoop.currentlyRunningMainloop;c.mainLoop.runner=function(){if(!J)if(0<c.mainLoop.queue.length){var l=Date.now(),f=c.mainLoop.queue.shift();if(f.func(f.arg),c.mainLoop.remainingBlockers){var m=c.mainLoop.remainingBlockers,d=m%1==0?m-1:Math.floor(m);f.counted?c.mainLoop.remainingBlockers=d:(d+=.5,c.mainLoop.remainingBlockers=(8*m+d)/9)}if(console.log('main loop blocker "'+f.name+'" took '+(Date.now()-l)+" ms"),c.mainLoop.updateStatus(),u<c.mainLoop.currentlyRunningMainloop)return;setTimeout(c.mainLoop.runner,0)}else u<c.mainLoop.currentlyRunningMainloop||(c.mainLoop.currentFrameNumber=c.mainLoop.currentFrameNumber+1|0,c.mainLoop.timingMode==1&&1<c.mainLoop.timingValue&&c.mainLoop.currentFrameNumber%c.mainLoop.timingValue!=0?c.mainLoop.scheduler():(c.mainLoop.timingMode==0&&(c.mainLoop.tickStartTime=Me()),c.mainLoop.method==="timeout"&&s.ctx&&(q("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!"),c.mainLoop.method=""),c.mainLoop.runIter(a),u<c.mainLoop.currentlyRunningMainloop||(typeof SDL=="object"&&SDL.audio&&SDL.audio.queueNewAudioData&&SDL.audio.queueNewAudioData(),c.mainLoop.scheduler())))}}var c={mainLoop:{scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){c.mainLoop.scheduler=null,c.mainLoop.currentlyRunningMainloop++},resume:function(){c.mainLoop.currentlyRunningMainloop++;var e=c.mainLoop.timingMode,t=c.mainLoop.timingValue,n=c.mainLoop.func;c.mainLoop.func=null,mn(n,0,!1,c.mainLoop.arg),dn(e,t),c.mainLoop.scheduler()},updateStatus:function(){if(s.setStatus){var e=s.statusMessage||"Please wait...",t=c.mainLoop.remainingBlockers,n=c.mainLoop.expectedBlockers;t?t<n?s.setStatus(e+" ("+(n-t)+"/"+n+")"):s.setStatus(e):s.setStatus("")}},runIter:function(e){if(!J){if(s.preMainLoop&&s.preMainLoop()===!1)return;try{e()}catch(t){if(t instanceof Ne)return;throw t&&typeof t=="object"&&t.stack&&q("exception thrown: "+[t,t.stack]),t}s.postMainLoop&&s.postMainLoop()}}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(s.preloadPlugins||(s.preloadPlugins=[]),!c.initted){c.initted=!0;try{new Blob,c.hasBlobConstructor=!0}catch{c.hasBlobConstructor=!1,console.log("warning: no blob constructor, cannot create blobs with mimetypes")}c.BlobBuilder=typeof MozBlobBuilder<"u"?MozBlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:c.hasBlobConstructor?null:console.log("warning: no BlobBuilder"),c.URLObject=typeof window<"u"?window.URL?window.URL:window.webkitURL:void 0,s.noImageDecoding||c.URLObject!==void 0||(console.log("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),s.noImageDecoding=!0);var e={canHandle:function(i){return!s.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(i)},handle:function(i,a,u,l){var f=null;if(c.hasBlobConstructor)try{(f=new Blob([i],{type:c.getMimetype(a)})).size!==i.length&&(f=new Blob([new Uint8Array(i).buffer],{type:c.getMimetype(a)}))}catch(h){pe("Blob constructor present but fails: "+h+"; falling back to blob builder")}if(!f){var m=new c.BlobBuilder;m.append(new Uint8Array(i).buffer),f=m.getBlob()}var d=c.URLObject.createObjectURL(f),g=new Image;g.onload=function(){H(g.complete,"Image "+a+" could not be decoded");var h=document.createElement("canvas");h.width=g.width,h.height=g.height,h.getContext("2d").drawImage(g,0,0),s.preloadedImages[a]=h,c.URLObject.revokeObjectURL(d),u&&u(i)},g.onerror=function(h){console.log("Image "+d+" could not be decoded"),l&&l()},g.src=d}};s.preloadPlugins.push(e);var t={canHandle:function(i){return!s.noAudioDecoding&&i.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(i,a,u,l){var f=!1;function m(M){f||(f=!0,s.preloadedAudios[a]=M,u&&u(i))}function d(){f||(f=!0,s.preloadedAudios[a]=new Audio,l&&l())}if(!c.hasBlobConstructor)return d();try{var g=new Blob([i],{type:c.getMimetype(a)})}catch{return d()}var h=c.URLObject.createObjectURL(g),y=new Audio;y.addEventListener("canplaythrough",function(){m(y)},!1),y.onerror=function(M){f||(console.log("warning: browser could not fully decode audio "+a+", trying slower base64 approach"),y.src="data:audio/x-"+a.substr(-3)+";base64,"+(function(L){for(var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R="",p=0,v=0,P=0;P<L.length;P++)for(p=p<<8|L[P],v+=8;6<=v;){var A=p>>v-6&63;v-=6,R+=j[A]}return v==2?(R+=j[(3&p)<<4],R+="=="):v==4&&(R+=j[(15&p)<<2],R+="="),R})(i),m(y))},y.src=h,c.safeSetTimeout(function(){m(y)},1e4)}};s.preloadPlugins.push(t);var n=s.canvas;n&&(n.requestPointerLock=n.requestPointerLock||n.mozRequestPointerLock||n.webkitRequestPointerLock||n.msRequestPointerLock||function(){},n.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},n.exitPointerLock=n.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",o,!1),document.addEventListener("mozpointerlockchange",o,!1),document.addEventListener("webkitpointerlockchange",o,!1),document.addEventListener("mspointerlockchange",o,!1),s.elementPointerLock&&n.addEventListener("click",function(i){!c.pointerLock&&s.canvas.requestPointerLock&&(s.canvas.requestPointerLock(),i.preventDefault())},!1))}function o(){c.pointerLock=document.pointerLockElement===s.canvas||document.mozPointerLockElement===s.canvas||document.webkitPointerLockElement===s.canvas||document.msPointerLockElement===s.canvas}},createContext:function(e,t,n,o){if(t&&s.ctx&&e==s.canvas)return s.ctx;var i,a;if(t){var u={antialias:!1,alpha:!1,majorVersion:1};if(o)for(var l in o)u[l]=o[l];typeof GL<"u"&&(a=GL.createContext(e,u))&&(i=GL.getContext(a).GLctx)}else i=e.getContext("2d");return i?(n&&(t||H(typeof GLctx>"u","cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),s.ctx=i,t&&GL.makeContextCurrent(a),s.useWebGL=t,c.moduleContextCreatedCallbacks.forEach(function(f){f()}),c.init()),i):null},destroyContext:function(e,t,n){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen:function(e,t,n){c.lockPointer=e,c.resizeCanvas=t,c.vrDevice=n,c.lockPointer===void 0&&(c.lockPointer=!0),c.resizeCanvas===void 0&&(c.resizeCanvas=!1),c.vrDevice===void 0&&(c.vrDevice=null);var o=s.canvas;function i(){c.isFullscreen=!1;var u=o.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===u?(o.exitFullscreen=c.exitFullscreen,c.lockPointer&&o.requestPointerLock(),c.isFullscreen=!0,c.resizeCanvas?c.setFullscreenCanvasSize():c.updateCanvasDimensions(o)):(u.parentNode.insertBefore(o,u),u.parentNode.removeChild(u),c.resizeCanvas?c.setWindowedCanvasSize():c.updateCanvasDimensions(o)),s.onFullScreen&&s.onFullScreen(c.isFullscreen),s.onFullscreen&&s.onFullscreen(c.isFullscreen)}c.fullscreenHandlersInstalled||(c.fullscreenHandlersInstalled=!0,document.addEventListener("fullscreenchange",i,!1),document.addEventListener("mozfullscreenchange",i,!1),document.addEventListener("webkitfullscreenchange",i,!1),document.addEventListener("MSFullscreenChange",i,!1));var a=document.createElement("div");o.parentNode.insertBefore(a,o),a.appendChild(o),a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||(a.webkitRequestFullscreen?function(){a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(a.webkitRequestFullScreen?function(){a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),n?a.requestFullscreen({vrDisplay:n}):a.requestFullscreen()},requestFullScreen:function(e,t,n){return q("Browser.requestFullScreen() is deprecated. Please call Browser.requestFullscreen instead."),c.requestFullScreen=function(o,i,a){return c.requestFullscreen(o,i,a)},c.requestFullscreen(e,t,n)},exitFullscreen:function(){return!!c.isFullscreen&&((document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){}).apply(document,[]),!0)},nextRAF:0,fakeRequestAnimationFrame:function(e){var t=Date.now();if(c.nextRAF===0)c.nextRAF=t+1e3/60;else for(;t+2>=c.nextRAF;)c.nextRAF+=1e3/60;var n=Math.max(c.nextRAF-t,0);setTimeout(e,n)},requestAnimationFrame:function(e){typeof requestAnimationFrame!="function"?(0,c.fakeRequestAnimationFrame)(e):requestAnimationFrame(e)},safeCallback:function(e){return function(){if(!J)return e.apply(null,arguments)}},allowAsyncCallbacks:!0,queuedAsyncCallbacks:[],pauseAsyncCallbacks:function(){c.allowAsyncCallbacks=!1},resumeAsyncCallbacks:function(){if(c.allowAsyncCallbacks=!0,0<c.queuedAsyncCallbacks.length){var e=c.queuedAsyncCallbacks;c.queuedAsyncCallbacks=[],e.forEach(function(t){t()})}},safeRequestAnimationFrame:function(e){return c.requestAnimationFrame(function(){J||(c.allowAsyncCallbacks?e():c.queuedAsyncCallbacks.push(e))})},safeSetTimeout:function(e,t){return s.noExitRuntime=!0,setTimeout(function(){J||(c.allowAsyncCallbacks?e():c.queuedAsyncCallbacks.push(e))},t)},safeSetInterval:function(e,t){return s.noExitRuntime=!0,setInterval(function(){J||c.allowAsyncCallbacks&&e()},t)},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(e)},getMovementX:function(e){return e.movementX||e.mozMovementX||e.webkitMovementX||0},getMovementY:function(e){return e.movementY||e.mozMovementY||e.webkitMovementY||0},getMouseWheelDelta:function(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail/3;break;case"mousewheel":t=e.wheelDelta/120;break;case"wheel":switch(t=e.deltaY,e.deltaMode){case 0:t/=100;break;case 1:t/=3;break;case 2:t*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(e){if(c.pointerLock)e.type!="mousemove"&&"mozMovementX"in e?c.mouseMovementX=c.mouseMovementY=0:(c.mouseMovementX=c.getMovementX(e),c.mouseMovementY=c.getMovementY(e)),typeof SDL<"u"?(c.mouseX=SDL.mouseX+c.mouseMovementX,c.mouseY=SDL.mouseY+c.mouseMovementY):(c.mouseX+=c.mouseMovementX,c.mouseY+=c.mouseMovementY);else{var t=s.canvas.getBoundingClientRect(),n=s.canvas.width,o=s.canvas.height,i=window.scrollX!==void 0?window.scrollX:window.pageXOffset,a=window.scrollY!==void 0?window.scrollY:window.pageYOffset;if(e.type==="touchstart"||e.type==="touchend"||e.type==="touchmove"){var u=e.touch;if(u===void 0)return;var l=u.pageX-(i+t.left),f=u.pageY-(a+t.top),m={x:l*=n/t.width,y:f*=o/t.height};if(e.type==="touchstart")c.lastTouches[u.identifier]=m,c.touches[u.identifier]=m;else if(e.type==="touchend"||e.type==="touchmove"){var d=c.touches[u.identifier];d=d||m,c.lastTouches[u.identifier]=d,c.touches[u.identifier]=m}return}var g=e.pageX-(i+t.left),h=e.pageY-(a+t.top);g*=n/t.width,h*=o/t.height,c.mouseMovementX=g-c.mouseX,c.mouseMovementY=h-c.mouseY,c.mouseX=g,c.mouseY=h}},asyncLoad:function(e,t,n,o){var i=o?"":"al "+e;De(e,function(a){H(a,'Loading data file "'+e+'" failed (no arrayBuffer).'),t(new Uint8Array(a)),i&&Fe()},function(a){if(!n)throw'Loading data file "'+e+'" failed.';n()}),i&&Ge()},resizeListeners:[],updateResizeListeners:function(){var e=s.canvas;c.resizeListeners.forEach(function(t){t(e.width,e.height)})},setCanvasSize:function(e,t,n){var o=s.canvas;c.updateCanvasDimensions(o,e,t),n||c.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize:function(){if(typeof SDL<"u"){var e=Ue[SDL.screen>>2];e|=8388608,w[SDL.screen>>2]=e}c.updateCanvasDimensions(s.canvas),c.updateResizeListeners()},setWindowedCanvasSize:function(){if(typeof SDL<"u"){var e=Ue[SDL.screen>>2];e&=-8388609,w[SDL.screen>>2]=e}c.updateCanvasDimensions(s.canvas),c.updateResizeListeners()},updateCanvasDimensions:function(e,t,n){t&&n?(e.widthNative=t,e.heightNative=n):(t=e.widthNative,n=e.heightNative);var o=t,i=n;if(s.forcedAspectRatio&&0<s.forcedAspectRatio&&(o/i<s.forcedAspectRatio?o=Math.round(i*s.forcedAspectRatio):i=Math.round(o/s.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e.parentNode&&typeof screen<"u"){var a=Math.min(screen.width/o,screen.height/i);o=Math.round(o*a),i=Math.round(i*a)}c.resizeCanvas?(e.width!=o&&(e.width=o),e.height!=i&&(e.height=i),e.style!==void 0&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=t&&(e.width=t),e.height!=n&&(e.height=n),e.style!==void 0&&(o!=t||i!=n?(e.style.setProperty("width",o+"px","important"),e.style.setProperty("height",i+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))},wgetRequests:{},nextWgetRequestHandle:0,getNextWgetRequestHandle:function(){var e=c.nextWgetRequestHandle;return c.nextWgetRequestHandle++,e}};function pn(e,t,n){function o(){At(e,"vi")(t)}s.noExitRuntime=!0,0<=n?c.safeSetTimeout(o,n):c.safeRequestAnimationFrame(o)}function hn(){return X.length}function gn(e){kt(e)}var ht={};function Ee(e){return e===0?0:(e=ge(e),ht.hasOwnProperty(e)?(Ee.ret&&yt(Ee.ret),Ee.ret=Pt(ht[e]),Ee.ret):0)}function vn(e){var t=Ke,n=t.LLVM_SAVEDSTACKS[e];t.LLVM_SAVEDSTACKS.splice(e,1),Et(n)}function Ke(){var e=Ke;return e.LLVM_SAVEDSTACKS||(e.LLVM_SAVEDSTACKS=[]),e.LLVM_SAVEDSTACKS.push(_t()),e.LLVM_SAVEDSTACKS.length-1}function wn(e,t,n){de.set(de.subarray(t,t+n),e)}function yn(e){return 0}function En(){}function _n(){return 0}function kn(){return 0}function bn(){return 0}function Dn(){return 11}function Sn(){}function gt(e){z("OOM")}function Fn(e){gt()}function Ae(e){return e%4==0&&(e%100!=0||e%400==0)}function $e(e,t){for(var n=0,o=0;o<=t;n+=e[o++]);return n}var Le=[31,29,31,30,31,30,31,31,30,31,30,31],Re=[31,28,31,30,31,30,31,31,30,31,30,31];function Pe(e,t){for(var n=new Date(e.getTime());0<t;){var o=Ae(n.getFullYear()),i=n.getMonth(),a=(o?Le:Re)[i];if(!(t>a-n.getDate()))return n.setDate(n.getDate()+t),n;t-=a-n.getDate()+1,n.setDate(1),i<11?n.setMonth(i+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1))}return n}function Mn(e,t,n,o){var i=w[o+40>>2],a={tm_sec:w[o>>2],tm_min:w[o+4>>2],tm_hour:w[o+8>>2],tm_mday:w[o+12>>2],tm_mon:w[o+16>>2],tm_year:w[o+20>>2],tm_wday:w[o+24>>2],tm_yday:w[o+28>>2],tm_isdst:w[o+32>>2],tm_gmtoff:w[o+36>>2],tm_zone:i?ge(i):""},u=ge(n),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var f in l)u=u.replace(new RegExp(f,"g"),l[f]);var m=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"];function g(p,v,P){for(var A=typeof p=="number"?p.toString():p||"";A.length<v;)A=P[0]+A;return A}function h(p,v){return g(p,v,"0")}function y(p,v){function P(x){return x<0?-1:0<x?1:0}var A;return(A=P(p.getFullYear()-v.getFullYear()))===0&&(A=P(p.getMonth()-v.getMonth()))===0&&(A=P(p.getDate()-v.getDate())),A}function M(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function L(p){var v=Pe(new Date(p.tm_year+1900,0,1),p.tm_yday),P=new Date(v.getFullYear(),0,4),A=new Date(v.getFullYear()+1,0,4),x=M(P),ce=M(A);return y(x,v)<=0?y(ce,v)<=0?v.getFullYear()+1:v.getFullYear():v.getFullYear()-1}var j={"%a":function(p){return m[p.tm_wday].substring(0,3)},"%A":function(p){return m[p.tm_wday]},"%b":function(p){return d[p.tm_mon].substring(0,3)},"%B":function(p){return d[p.tm_mon]},"%C":function(p){return h((p.tm_year+1900)/100|0,2)},"%d":function(p){return h(p.tm_mday,2)},"%e":function(p){return g(p.tm_mday,2," ")},"%g":function(p){return L(p).toString().substring(2)},"%G":function(p){return L(p)},"%H":function(p){return h(p.tm_hour,2)},"%I":function(p){var v=p.tm_hour;return v==0?v=12:12<v&&(v-=12),h(v,2)},"%j":function(p){return h(p.tm_mday+$e(Ae(p.tm_year+1900)?Le:Re,p.tm_mon-1),3)},"%m":function(p){return h(p.tm_mon+1,2)},"%M":function(p){return h(p.tm_min,2)},"%n":function(){return`
`},"%p":function(p){return 0<=p.tm_hour&&p.tm_hour<12?"AM":"PM"},"%S":function(p){return h(p.tm_sec,2)},"%t":function(){return"	"},"%u":function(p){return p.tm_wday||7},"%U":function(p){var v=new Date(p.tm_year+1900,0,1),P=v.getDay()===0?v:Pe(v,7-v.getDay()),A=new Date(p.tm_year+1900,p.tm_mon,p.tm_mday);if(y(P,A)<0){var x=$e(Ae(A.getFullYear())?Le:Re,A.getMonth()-1)-31,ce=31-P.getDate()+x+A.getDate();return h(Math.ceil(ce/7),2)}return y(P,v)===0?"01":"00"},"%V":function(p){var v,P=new Date(p.tm_year+1900,0,4),A=new Date(p.tm_year+1901,0,4),x=M(P),ce=M(A),Dt=Pe(new Date(p.tm_year+1900,0,1),p.tm_yday);return y(Dt,x)<0?"53":y(ce,Dt)<=0?"01":(v=x.getFullYear()<p.tm_year+1900?p.tm_yday+32-x.getDate():p.tm_yday+1-x.getDate(),h(Math.ceil(v/7),2))},"%w":function(p){return p.tm_wday},"%W":function(p){var v=new Date(p.tm_year,0,1),P=v.getDay()===1?v:Pe(v,v.getDay()===0?1:7-v.getDay()+1),A=new Date(p.tm_year+1900,p.tm_mon,p.tm_mday);if(y(P,A)<0){var x=$e(Ae(A.getFullYear())?Le:Re,A.getMonth()-1)-31,ce=31-P.getDate()+x+A.getDate();return h(Math.ceil(ce/7),2)}return y(P,v)===0?"01":"00"},"%y":function(p){return(p.tm_year+1900).toString().substring(2)},"%Y":function(p){return p.tm_year+1900},"%z":function(p){var v=p.tm_gmtoff,P=0<=v;return v=(v=Math.abs(v)/60)/60*100+v%60,(P?"+":"-")+("0000"+v).slice(-4)},"%Z":function(p){return p.tm_zone},"%%":function(){return"%"}};for(var f in j)0<=u.indexOf(f)&&(u=u.replace(new RegExp(f,"g"),j[f](a)));var R=xe(u,!1);return R.length>t?0:(it(R,e),R.length-1)}function An(e,t,n,o){return Mn(e,t,n,o)}if(r.staticInit(),le){var B=_e,vt=_e;S.staticInit()}function xe(e,t,n){var o=we(e)+1,i=new Array(o),a=ve(e,i,0,i.length);return t&&(i.length=a),i}Me=K?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:typeof dateNow<"u"?dateNow:typeof performance=="object"&&performance&&typeof performance.now=="function"?function(){return performance.now()}:Date.now,s.requestFullScreen=function(e,t,n){q("Module.requestFullScreen is deprecated. Please call Module.requestFullscreen instead."),s.requestFullScreen=s.requestFullscreen,c.requestFullScreen(e,t,n)},s.requestFullscreen=function(e,t,n){c.requestFullscreen(e,t,n)},s.requestAnimationFrame=function(e){c.requestAnimationFrame(e)},s.setCanvasSize=function(e,t,n){c.setCanvasSize(e,t,n)},s.pauseMainLoop=function(){c.mainLoop.pause()},s.resumeMainLoop=function(){c.mainLoop.resume()},s.getUserMedia=function(){c.getUserMedia()},s.createContext=function(e,t,n,o){return c.createContext(e,t,n,o)};var Ln={},Rn={c:z,r:et,x:tt,w:Vt,e:Xt,d:Gt,v:Kt,i:$t,u:Zt,l:se,t:Jt,s:Qt,q:en,p:tn,M:nn,o:rn,n:on,L:sn,h:un,b:cn,K:fn,k:pn,J:hn,I:wn,H:Fn,G:gn,j:Ee,g:vn,f:Ke,F:yn,E:En,D:_n,C:kn,m:bn,B:Dn,A:Sn,z:An,y:gt,a:ut},wt=s.asm(Ln,Rn,V);s.asm=wt;var Oe=s.__ZSt18uncaught_exceptionv=function(){return s.asm.N.apply(null,arguments)};s.___errno_location=function(){return s.asm.O.apply(null,arguments)};var yt=s._free=function(){return s.asm.P.apply(null,arguments)},Pn=s._i64Add=function(){return s.asm.Q.apply(null,arguments)};s._main=function(){return s.asm.R.apply(null,arguments)};var Ze=s._malloc=function(){return s.asm.S.apply(null,arguments)};s._uci_command=function(){return s.asm.T.apply(null,arguments)};var xn=s.globalCtors=function(){return s.asm.ma.apply(null,arguments)},Ce=s.stackAlloc=function(){return s.asm.na.apply(null,arguments)},Et=s.stackRestore=function(){return s.asm.oa.apply(null,arguments)},_t=s.stackSave=function(){return s.asm.pa.apply(null,arguments)};s.dynCall_ii=function(){return s.asm.U.apply(null,arguments)},s.dynCall_iii=function(){return s.asm.V.apply(null,arguments)},s.dynCall_iiii=function(){return s.asm.W.apply(null,arguments)},s.dynCall_iiiii=function(){return s.asm.X.apply(null,arguments)},s.dynCall_iiiiid=function(){return s.asm.Y.apply(null,arguments)},s.dynCall_iiiiii=function(){return s.asm.Z.apply(null,arguments)},s.dynCall_iiiiiid=function(){return s.asm._.apply(null,arguments)},s.dynCall_iiiiiii=function(){return s.asm.$.apply(null,arguments)},s.dynCall_iiiiiiii=function(){return s.asm.aa.apply(null,arguments)},s.dynCall_iiiiiiiii=function(){return s.asm.ba.apply(null,arguments)},s.dynCall_iiiiij=function(){return s.asm.ca.apply(null,arguments)},s.dynCall_jiji=function(){return s.asm.da.apply(null,arguments)},s.dynCall_v=function(){return s.asm.ea.apply(null,arguments)},s.dynCall_vi=function(){return s.asm.fa.apply(null,arguments)},s.dynCall_vii=function(){return s.asm.ga.apply(null,arguments)},s.dynCall_viii=function(){return s.asm.ha.apply(null,arguments)},s.dynCall_viiii=function(){return s.asm.ia.apply(null,arguments)},s.dynCall_viiiii=function(){return s.asm.ja.apply(null,arguments)},s.dynCall_viiiiii=function(){return s.asm.ka.apply(null,arguments)},s.dynCall_viijii=function(){return s.asm.la.apply(null,arguments)};function Ne(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}s.asm=wt,s.ccall=Rt;function On(e){var t=(e=e||[]).length+1,n=Ce(4*(t+1));w[n>>2]=ot(ee);for(var o=1;o<t;o++)w[(n>>2)+o]=ot(e[o-1]);w[(n>>2)+t]=0;try{kt(s._main(t,n),!0)}catch(a){if(a instanceof Ne)return;if(a=="SimulateInfiniteLoop")return void(s.noExitRuntime=!0);var i=a;a&&typeof a=="object"&&a.stack&&(i=[a,a.stack]),q("exception thrown: "+i),W(1,a)}finally{}}function Je(e){function t(){s.calledRun||(s.calledRun=!0,J||(Bt(),Tt(),s.onRuntimeInitialized&&s.onRuntimeInitialized(),bt&&On(e),It()))}e=e||D,0<ae||(Nt(),0<ae||s.calledRun||(s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),t()},1)):t()))}function kt(e,t){t&&s.noExitRuntime&&e===0||(s.noExitRuntime||(J=!0,s.onExit&&s.onExit(e)),W(e,new Ne(e)))}function z(e){throw s.onAbort&&s.onAbort(e),Ie(e+=""),q(e),J=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(ye=function e(){s.calledRun||Je(),s.calledRun||(ye=e)},s.run=Je,s.abort=z,s.preInit)for(typeof s.preInit=="function"&&(s.preInit=[s.preInit]);0<s.preInit.length;)s.preInit.pop()();var bt=!0;s.noInitialRun&&(bt=!1),s.noExitRuntime=!0,Je()})(Te)),Te.exports}var zn=In(),jn=Cn(zn);let O=null,ke=!1,Be="",ie={multiPV:3,depth:20,timeLimit:3e3};const qn=F=>{const s=F.trim().split(" ");if(s[0]==="info"&&s.includes("depth")&&s.includes("score"))try{const b=s.indexOf("depth"),N=s.indexOf("score"),D=s.indexOf("nodes"),ee=s.indexOf("time"),W=s.indexOf("pv"),te=s.indexOf("multipv"),U=s.indexOf("nps"),K=parseInt(s[b+1]),le=D>=0?parseInt(s[D+1]):0,be=ee>=0?parseInt(s[ee+1]):0,ne=te>=0?parseInt(s[te+1]):1,De=U>=0?parseInt(s[U+1]):0;let $=0,Z;s[N+1]==="cp"?$=parseInt(s[N+2]):s[N+1]==="mate"&&(Z=parseInt(s[N+2]),$=Z>0?2e4-Z*2:-2e4-Z*2);let me=[];if(W>=0)for(let Y=W+1;Y<s.length;Y++){const re=s[Y];if(re.startsWith("wdl")||re.startsWith("string")||re.startsWith("currline"))break;if(re.length>=4&&re.match(/^[a-h][1-8][a-h][1-8][qrbn]?$/))me.push(re);else break}self.postMessage({type:"ANALYSIS",evaluation:{score:$,depth:K,nodes:le,time:be,nps:De,pv:me.slice(0,10),mate:Z},multiPV:ne})}catch(b){console.warn("Failed to parse Stockfish info:",F,b)}else s[0]==="bestmove"&&s[1]&&self.postMessage({type:"BEST_MOVE",move:s[1],ponder:s[3]})},Un=async()=>{try{if(O=jn(),!O)throw new Error("Failed to create Stockfish instance");return O.onmessage=F=>{qn(F.data)},new Promise((F,s)=>{let b=!1,N=!1;const D=ee=>{const W=ee.data.toString();W.includes("uciok")?(N=!0,O.postMessage(`setoption name MultiPV value ${ie.multiPV}`),O.postMessage("setoption name Hash value 128"),O.postMessage("setoption name Threads value 1"),O.postMessage("setoption name Ponder value false"),O.postMessage("isready")):W.includes("readyok")&&N&&(b=!0,O.removeEventListener("message",D),ke=!0,self.postMessage({type:"READY"}),F())};O.addEventListener("message",D),O.postMessage("uci"),setTimeout(()=>{b||s(new Error("Stockfish initialization timeout"))},1e4)})}catch(F){console.error("Stockfish initialization error:",F),self.postMessage({type:"ERROR",error:F instanceof Error?F.message:"Failed to initialize Stockfish"})}},Ft=F=>{const s=F.split(" ");return s.length>6?s.slice(0,6).join(" "):F};self.onmessage=async F=>{const{type:s,payload:b}=F.data;switch(s){case"INIT":ie={multiPV:b.multiPV||3,depth:b.depth||20,timeLimit:b.timeLimit||3e3},await Un();break;case"ANALYZE_POSITION":if(!O||!ke){self.postMessage({type:"ERROR",error:"Stockfish not initialized"});return}try{const D=Ft(b.fen);Be=D,O.postMessage("stop"),O.postMessage(`position fen ${D}`),O.postMessage(`go depth ${ie.depth}`)}catch(D){console.error("Analysis error:",D),self.postMessage({type:"ERROR",error:D instanceof Error?D.message:"Analysis failed"})}break;case"FIND_BEST_MOVE":if(!O||!ke){self.postMessage({type:"ERROR",error:"Stockfish not initialized"});return}try{const D=Ft(b.fen);Be=D,O.postMessage("stop"),O.postMessage(`position fen ${D}`),O.postMessage(`go movetime ${b.timeLimit||ie.timeLimit}`)}catch(D){console.error("Best move search error:",D),self.postMessage({type:"ERROR",error:D instanceof Error?D.message:"Best move search failed"})}break;case"UPDATE_CONFIG":if(!O||!ke){self.postMessage({type:"ERROR",error:"Stockfish not initialized"});return}const N={...ie,...b};b.multiPV&&b.multiPV!==ie.multiPV&&O.postMessage(`setoption name MultiPV value ${b.multiPV}`),ie=N,Be&&(O.postMessage("stop"),O.postMessage(`position fen ${Be}`),O.postMessage(`go depth ${ie.depth}`));break;case"STOP":O&&ke&&O.postMessage("stop");break}};
