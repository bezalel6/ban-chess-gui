(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Ue,M,Rt,ge,it,Bt,$t,Lt,Ze,je,Ge,Ce={},Kt=[],Jt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,we=Array.isArray;function fe(e,t){for(var r in t)e[r]=t[r];return e}function xe(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ze(e,t,r){var n,i,o,u={};for(o in t)o=="key"?n=t[o]:o=="ref"?i=t[o]:u[o]=t[o];if(arguments.length>2&&(u.children=arguments.length>3?Ue.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)u[o]===void 0&&(u[o]=e.defaultProps[o]);return Be(e,u,n,i,null)}function Be(e,t,r,n,i){var o={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Rt,__i:-1,__u:0};return i==null&&M.vnode!=null&&M.vnode(o),o}function be(e){return e.children}function _e(e,t){this.props=e,this.context=t}function Se(e,t){if(t==null)return e.__?Se(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Se(e):null}function Ft(e){var t,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return Ft(e)}}function at(e){(!e.__d&&(e.__d=!0)&&ge.push(e)&&!Le.__r++||it!=M.debounceRendering)&&((it=M.debounceRendering)||Bt)(Le)}function Le(){for(var e,t,r,n,i,o,u,c=1;ge.length;)ge.length>c&&ge.sort($t),e=ge.shift(),c=ge.length,e.__d&&(r=void 0,i=(n=(t=e).__v).__e,o=[],u=[],t.__P&&((r=fe({},n)).__v=n.__v+1,M.vnode&&M.vnode(r),Je(t.__P,r,n,t.__n,t.__P.namespaceURI,32&n.__u?[i]:null,o,i??Se(n),!!(32&n.__u),u),r.__v=n.__v,r.__.__k[r.__i]=r,Ht(o,r,u),r.__e!=i&&Ft(r)));Le.__r=0}function Ut(e,t,r,n,i,o,u,c,a,s,p){var l,b,h,k,I,F,O,R=n&&n.__k||Kt,V=t.length;for(a=Xt(r,t,R,a,V),l=0;l<V;l++)(h=r.__k[l])!=null&&(b=h.__i==-1?Ce:R[h.__i]||Ce,h.__i=l,F=Je(e,h,b,i,o,u,c,a,s,p),k=h.__e,h.ref&&b.ref!=h.ref&&(b.ref&&Xe(b.ref,null,h),p.push(h.ref,h.__c||k,h)),I==null&&k!=null&&(I=k),(O=!!(4&h.__u))||b.__k===h.__k?a=qt(h,a,e,O):typeof h.type=="function"&&F!==void 0?a=F:k&&(a=k.nextSibling),h.__u&=-7);return r.__e=I,a}function Xt(e,t,r,n,i){var o,u,c,a,s,p=r.length,l=p,b=0;for(e.__k=new Array(i),o=0;o<i;o++)(u=t[o])!=null&&typeof u!="boolean"&&typeof u!="function"?(a=o+b,(u=e.__k[o]=typeof u=="string"||typeof u=="number"||typeof u=="bigint"||u.constructor==String?Be(null,u,null,null,null):we(u)?Be(be,{children:u},null,null,null):u.constructor==null&&u.__b>0?Be(u.type,u.props,u.key,u.ref?u.ref:null,u.__v):u).__=e,u.__b=e.__b+1,c=null,(s=u.__i=er(u,r,a,l))!=-1&&(l--,(c=r[s])&&(c.__u|=2)),c==null||c.__v==null?(s==-1&&(i>p?b--:i<p&&b++),typeof u.type!="function"&&(u.__u|=4)):s!=a&&(s==a-1?b--:s==a+1?b++:(s>a?b--:b++,u.__u|=4))):e.__k[o]=null;if(l)for(o=0;o<p;o++)(c=r[o])!=null&&(2&c.__u)==0&&(c.__e==n&&(n=Se(c)),Wt(c,c));return n}function qt(e,t,r,n){var i,o;if(typeof e.type=="function"){for(i=e.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=e,t=qt(i[o],t,r,n));return t}e.__e!=t&&(n&&(t&&e.type&&!t.parentNode&&(t=Se(e)),r.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Ke(e,t){return t=t||[],e==null||typeof e=="boolean"||(we(e)?e.some(function(r){Ke(r,t)}):t.push(e)),t}function er(e,t,r,n){var i,o,u,c=e.key,a=e.type,s=t[r],p=s!=null&&(2&s.__u)==0;if(s===null&&e.key==null||p&&c==s.key&&a==s.type)return r;if(n>(p?1:0)){for(i=r-1,o=r+1;i>=0||o<t.length;)if((s=t[u=i>=0?i--:o++])!=null&&(2&s.__u)==0&&c==s.key&&a==s.type)return u}return-1}function ot(e,t,r){t[0]=="-"?e.setProperty(t,r??""):e[t]=r==null?"":typeof r!="number"||Jt.test(t)?r:r+"px"}function Ie(e,t,r,n,i){var o,u;e:if(t=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||ot(e.style,t,"");if(r)for(t in r)n&&r[t]==n[t]||ot(e.style,t,r[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(Lt,"$1")),u=t.toLowerCase(),t=u in e||t=="onFocusOut"||t=="onFocusIn"?u.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=r,r?n?r.u=n.u:(r.u=Ze,e.addEventListener(t,o?Ge:je,o)):e.removeEventListener(t,o?Ge:je,o);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&r==1?"":r))}}function st(e){return function(t){if(this.l){var r=this.l[t.type+e];if(t.t==null)t.t=Ze++;else if(t.t<r.u)return;return r(M.event?M.event(t):t)}}}function Je(e,t,r,n,i,o,u,c,a,s){var p,l,b,h,k,I,F,O,R,V,j,he,ae,oe,ie,le,X,x=t.type;if(t.constructor!=null)return null;128&r.__u&&(a=!!(32&r.__u),o=[c=t.__e=r.__e]),(p=M.__b)&&p(t);e:if(typeof x=="function")try{if(O=t.props,R="prototype"in x&&x.prototype.render,V=(p=x.contextType)&&n[p.__c],j=p?V?V.props.value:p.__:n,r.__c?F=(l=t.__c=r.__c).__=l.__E:(R?t.__c=l=new x(O,j):(t.__c=l=new _e(O,j),l.constructor=x,l.render=rr),V&&V.sub(l),l.props=O,l.state||(l.state={}),l.context=j,l.__n=n,b=l.__d=!0,l.__h=[],l._sb=[]),R&&l.__s==null&&(l.__s=l.state),R&&x.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=fe({},l.__s)),fe(l.__s,x.getDerivedStateFromProps(O,l.__s))),h=l.props,k=l.state,l.__v=t,b)R&&x.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),R&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(R&&x.getDerivedStateFromProps==null&&O!==h&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(O,j),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(O,l.__s,j)===!1||t.__v==r.__v){for(t.__v!=r.__v&&(l.props=O,l.state=l.__s,l.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(f){f&&(f.__=t)}),he=0;he<l._sb.length;he++)l.__h.push(l._sb[he]);l._sb=[],l.__h.length&&u.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(O,l.__s,j),R&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(h,k,I)})}if(l.context=j,l.props=O,l.__P=e,l.__e=!1,ae=M.__r,oe=0,R){for(l.state=l.__s,l.__d=!1,ae&&ae(t),p=l.render(l.props,l.state,l.context),ie=0;ie<l._sb.length;ie++)l.__h.push(l._sb[ie]);l._sb=[]}else do l.__d=!1,ae&&ae(t),p=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++oe<25);l.state=l.__s,l.getChildContext!=null&&(n=fe(fe({},n),l.getChildContext())),R&&!b&&l.getSnapshotBeforeUpdate!=null&&(I=l.getSnapshotBeforeUpdate(h,k)),le=p,p!=null&&p.type===be&&p.key==null&&(le=Dt(p.props.children)),c=Ut(e,we(le)?le:[le],t,r,n,i,o,u,c,a,s),l.base=t.__e,t.__u&=-161,l.__h.length&&u.push(l),F&&(l.__E=l.__=null)}catch(f){if(t.__v=null,a||o!=null)if(f.then){for(t.__u|=a?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,t.__e=c}else{for(X=o.length;X--;)xe(o[X]);Ye(t)}else t.__e=r.__e,t.__k=r.__k,f.then||Ye(t);M.__e(f,t,r)}else o==null&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):c=t.__e=tr(r.__e,t,r,n,i,o,u,a,s);return(p=M.diffed)&&p(t),128&t.__u?void 0:c}function Ye(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ye)}function Ht(e,t,r){for(var n=0;n<r.length;n++)Xe(r[n],r[++n],r[++n]);M.__c&&M.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(o){o.call(i)})}catch(o){M.__e(o,i.__v)}})}function Dt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:we(e)?e.map(Dt):fe({},e)}function tr(e,t,r,n,i,o,u,c,a){var s,p,l,b,h,k,I,F=r.props,O=t.props,R=t.type;if(R=="svg"?i="http://www.w3.org/2000/svg":R=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(s=0;s<o.length;s++)if((h=o[s])&&"setAttribute"in h==!!R&&(R?h.localName==R:h.nodeType==3)){e=h,o[s]=null;break}}if(e==null){if(R==null)return document.createTextNode(O);e=document.createElementNS(i,R,O.is&&O),c&&(M.__m&&M.__m(t,o),c=!1),o=null}if(R==null)F===O||c&&e.data==O||(e.data=O);else{if(o=o&&Ue.call(e.childNodes),F=r.props||Ce,!c&&o!=null)for(F={},s=0;s<e.attributes.length;s++)F[(h=e.attributes[s]).name]=h.value;for(s in F)if(h=F[s],s!="children"){if(s=="dangerouslySetInnerHTML")l=h;else if(!(s in O)){if(s=="value"&&"defaultValue"in O||s=="checked"&&"defaultChecked"in O)continue;Ie(e,s,null,h,i)}}for(s in O)h=O[s],s=="children"?b=h:s=="dangerouslySetInnerHTML"?p=h:s=="value"?k=h:s=="checked"?I=h:c&&typeof h!="function"||F[s]===h||Ie(e,s,h,F[s],i);if(p)c||l&&(p.__html==l.__html||p.__html==e.innerHTML)||(e.innerHTML=p.__html),t.__k=[];else if(l&&(e.innerHTML=""),Ut(t.type=="template"?e.content:e,we(b)?b:[b],t,r,n,R=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,u,o?o[0]:r.__k&&Se(r,0),c,a),o!=null)for(s=o.length;s--;)xe(o[s]);c||(s="value",R=="progress"&&k==null?e.removeAttribute("value"):k!=null&&(k!==e[s]||R=="progress"&&!k||R=="option"&&k!=F[s])&&Ie(e,s,k,F[s],i),s="checked",I!=null&&I!=e[s]&&Ie(e,s,I,F[s],i))}return e}function Xe(e,t,r){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(i){M.__e(i,r)}}function Wt(e,t,r){var n,i;if(M.unmount&&M.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||Xe(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){M.__e(o,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&Wt(n[i],t,r||typeof e.type!="function");r||xe(e.__e),e.__c=e.__=e.__e=void 0}function rr(e,t,r){return this.constructor(e,r)}function nr(e,t,r){var n,i,o,u;t==document&&(t=document.documentElement),M.__&&M.__(e,t),i=(n=!1)?null:t.__k,o=[],u=[],Je(t,e=t.__k=ze(be,null,[e]),i||Ce,Ce,t.namespaceURI,i?null:t.firstChild?Ue.call(t.childNodes):null,o,i?i.__e:t.firstChild,n,u),Ht(o,e,u)}Ue=Kt.slice,M={__e:function(e,t,r,n){for(var i,o,u;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(e)),u=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,n||{}),u=i.__d),u)return i.__E=i}catch(c){e=c}throw e}},Rt=0,_e.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=fe({},this.state),typeof e=="function"&&(e=e(fe({},r),this.props)),e&&fe(r,e),e!=null&&this.__v&&(t&&this._sb.push(t),at(this))},_e.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),at(this))},_e.prototype.render=be,ge=[],Bt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,$t=function(e,t){return e.__v.__b-t.__v.__b},Le.__r=0,Lt=/(PointerCapture)$|Capture$/i,Ze=0,je=st(!1),Ge=st(!0);var ir=0;function v(e,t,r,n,i,o){t||(t={});var u,c,a=t;if("ref"in a)for(c in a={},t)c=="ref"?u=t[c]:a[c]=t[c];var s={type:e,props:a,key:r,ref:u,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ir,__i:-1,__u:0,__source:i,__self:o};if(typeof e=="function"&&(u=e.defaultProps))for(c in u)a[c]===void 0&&(a[c]=u[c]);return M.vnode&&M.vnode(s),s}var Pe,z,He,lt,Fe=0,Qt=[],Y=M,ct=Y.__b,ut=Y.__r,ft=Y.diffed,_t=Y.__c,ht=Y.unmount,dt=Y.__;function et(e,t){Y.__h&&Y.__h(z,e,Fe||t),Fe=0;var r=z.__H||(z.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function J(e){return Fe=1,ar(Gt,e)}function ar(e,t,r){var n=et(Pe++,2);if(n.t=e,!n.__c&&(n.__=[r?r(t):Gt(void 0,t),function(c){var a=n.__N?n.__N[0]:n.__[0],s=n.t(a,c);a!==s&&(n.__N=[s,n.__[1]],n.__c.setState({}))}],n.__c=z,!z.__f)){var i=function(c,a,s){if(!n.__c.__H)return!0;var p=n.__c.__H.__.filter(function(b){return!!b.__c});if(p.every(function(b){return!b.__N}))return!o||o.call(this,c,a,s);var l=n.__c.props!==c;return p.forEach(function(b){if(b.__N){var h=b.__[0];b.__=b.__N,b.__N=void 0,h!==b.__[0]&&(l=!0)}}),o&&o.call(this,c,a,s)||l};z.__f=!0;var o=z.shouldComponentUpdate,u=z.componentWillUpdate;z.componentWillUpdate=function(c,a,s){if(this.__e){var p=o;o=void 0,i(c,a,s),o=p}u&&u.call(this,c,a,s)},z.shouldComponentUpdate=i}return n.__N||n.__}function ye(e,t){var r=et(Pe++,3);!Y.__s&&jt(r.__H,t)&&(r.__=e,r.u=t,z.__H.__h.push(r))}function vt(e){return Fe=5,or(function(){return{current:e}},[])}function or(e,t){var r=et(Pe++,7);return jt(r.__H,t)&&(r.__=e(),r.__H=t,r.__h=e),r.__}function sr(){for(var e;e=Qt.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach($e),e.__H.__h.forEach(Ve),e.__H.__h=[]}catch(t){e.__H.__h=[],Y.__e(t,e.__v)}}Y.__b=function(e){z=null,ct&&ct(e)},Y.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),dt&&dt(e,t)},Y.__r=function(e){ut&&ut(e),Pe=0;var t=(z=e.__c).__H;t&&(He===z?(t.__h=[],z.__h=[],t.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(t.__h.forEach($e),t.__h.forEach(Ve),t.__h=[],Pe=0)),He=z},Y.diffed=function(e){ft&&ft(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Qt.push(t)!==1&&lt===Y.requestAnimationFrame||((lt=Y.requestAnimationFrame)||lr)(sr)),t.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),He=z=null},Y.__c=function(e,t){t.some(function(r){try{r.__h.forEach($e),r.__h=r.__h.filter(function(n){return!n.__||Ve(n)})}catch(n){t.some(function(i){i.__h&&(i.__h=[])}),t=[],Y.__e(n,r.__v)}}),_t&&_t(e,t)},Y.unmount=function(e){ht&&ht(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{$e(n)}catch(i){t=i}}),r.__H=void 0,t&&Y.__e(t,r.__v))};var pt=typeof requestAnimationFrame=="function";function lr(e){var t,r=function(){clearTimeout(n),pt&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,35);pt&&(t=requestAnimationFrame(r))}function $e(e){var t=z,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),z=t}function Ve(e){var t=z;e.__c=e.__(),z=t}function jt(e,t){return!e||e.length!==t.length||t.some(function(r,n){return r!==e[n]})}function Gt(e,t){return typeof t=="function"?t(e):t}var De={},ce={},w={},We={},mt;function Oe(){return mt||(mt=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ROOKS=e.SQUARES=e.RANKS=e.RANK_8=e.RANK_7=e.RANK_6=e.RANK_5=e.RANK_4=e.RANK_3=e.RANK_2=e.RANK_1=e.BITS=e.FLAGS=e.SHIFTS=e.RAYS=e.ATTACKS=e.PIECE_OFFSETS=e.PAWN_OFFSETS=e.POSSIBLE_RESULTS=e.DEFAULT_POSITION=e.SYMBOLS=e.EMPTY=e.KING=e.QUEEN=e.ROOK=e.BISHOP=e.KNIGHT=e.PAWN=e.BLACK=e.WHITE=void 0,e.WHITE="w",e.BLACK="b",e.PAWN="p",e.KNIGHT="n",e.BISHOP="b",e.ROOK="r",e.QUEEN="q",e.KING="k",e.EMPTY=-1,e.SYMBOLS="pnbrqkPNBRQK",e.DEFAULT_POSITION="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",e.POSSIBLE_RESULTS=["1-0","0-1","1/2-1/2","*"],e.PAWN_OFFSETS={b:[16,32,17,15],w:[-16,-32,-17,-15]},e.PIECE_OFFSETS={p:[],n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},e.ATTACKS=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],e.RAYS=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],e.SHIFTS={p:0,n:1,b:2,r:3,q:4,k:5},e.FLAGS={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},e.BITS={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},e.RANK_1=7,e.RANK_2=6,e.RANK_3=5,e.RANK_4=4,e.RANK_5=3,e.RANK_6=2,e.RANK_7=1,e.RANK_8=0,e.RANKS=[e.RANK_8,e.RANK_7,e.RANK_6,e.RANK_5,e.RANK_4,e.RANK_3,e.RANK_2,e.RANK_1],e.SQUARES={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},e.ROOKS={w:[{square:e.SQUARES.a1,flag:e.BITS.QSIDE_CASTLE},{square:e.SQUARES.h1,flag:e.BITS.KSIDE_CASTLE}],b:[{square:e.SQUARES.a8,flag:e.BITS.QSIDE_CASTLE},{square:e.SQUARES.h8,flag:e.BITS.KSIDE_CASTLE}]}})(We)),We}var Ae={},gt;function tt(){if(gt)return Ae;gt=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.State=void 0;var e=Oe(),t=zt(),r=(function(){function n(i,o,u,c,a,s,p){this.board=i||new Array(128),this.kings=o||{w:e.EMPTY,b:e.EMPTY},this.turn=u||e.WHITE,this.castling=c||{w:0,b:0},this.ep_square=a||e.EMPTY,this.half_moves=s||0,this.move_number=p||1}return n.prototype.clone=function(){return new n(this.board.slice(),{w:this.kings.w,b:this.kings.b},this.turn,{w:this.castling.w,b:this.castling.b},this.ep_square,this.half_moves,this.move_number)},Object.defineProperty(n.prototype,"fen",{get:function(){return t.getFen(this)},enumerable:!1,configurable:!0}),n})();return Ae.State=r,Ae}var D={},yt;function rt(){if(yt)return D;yt=1,Object.defineProperty(D,"__esModule",{value:!0}),D.strippedSan=D.validateFen=D.isFlagKey=D.isSquare=D.isPieceSymbol=D.isColor=D.symbol=D.isDigit=D.swapColor=D.algebraic=D.file=D.rank=void 0;var e=Oe();function t(h){return h>>4}D.rank=t;function r(h){return h&15}D.file=r;function n(h){var k=r(h),I=t(h);return"abcdefgh".substring(k,k+1)+"87654321".substring(I,I+1)}D.algebraic=n;function i(h){return h===e.WHITE?e.BLACK:e.WHITE}D.swapColor=i;function o(h){return/^[0-9]$/.test(h)}D.isDigit=o;function u(h){var k=h.type,I=h.color;return I===e.WHITE?k.toUpperCase():k.toLowerCase()}D.symbol=u;function c(h){return h==="w"||h==="b"}D.isColor=c;function a(h){return/^[pnbrqk]$/.test(h)}D.isPieceSymbol=a;function s(h){return/^[a-h][1-8]$/.test(h)}D.isSquare=s;function p(h){var k=["NORMAL","CAPTURE","BIG_PAWN","EP_CAPTURE","PROMOTION","KSIDE_CASTLE","QSIDE_CASTLE"];return k.indexOf(h)!==-1}D.isFlagKey=p;function l(h){var k={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},I=h.split(/\s+/);if(I.length!==6)return{valid:!1,error_number:1,error:k[1]};if(isNaN(I[5])||parseInt(I[5],10)<=0)return{valid:!1,error_number:2,error:k[2]};if(isNaN(I[4])||parseInt(I[4],10)<0)return{valid:!1,error_number:3,error:k[3]};if(!/^(-|[abcdefgh][36])$/.test(I[3]))return{valid:!1,error_number:4,error:k[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(I[2]))return{valid:!1,error_number:5,error:k[5]};if(!/^(w|b)$/.test(I[1]))return{valid:!1,error_number:6,error:k[6]};var F=I[0].split("/");if(F.length!==8)return{valid:!1,error_number:7,error:k[7]};for(var O=0;O<F.length;O++){for(var R=0,V=!1,j=0;j<F[O].length;j++)if(isNaN(F[O][j])){if(!/^[prnbqkPRNBQK]$/.test(F[O][j]))return{valid:!1,error_number:9,error:k[9]};R+=1,V=!1}else{if(V)return{valid:!1,error_number:8,error:k[8]};R+=parseInt(F[O][j],10),V=!0}if(R!==8)return{valid:!1,error_number:10,error:k[10]}}return I[3][1]=="3"&&I[1]=="w"||I[3][1]=="6"&&I[1]=="b"?{valid:!1,error_number:11,error:k[11]}:{valid:!0,error_number:0,error:k[0]}}D.validateFen=l;function b(h){return h.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}return D.strippedSan=b,D}var bt;function zt(){if(bt)return w;bt=1,Object.defineProperty(w,"__esModule",{value:!0}),w.validateMove=w.getBoard=w.ascii=w.buildMove=w.makeMove=w.insufficientMaterial=w.inStalemate=w.inCheckmate=w.inCheck=w.isKingAttacked=w.isAttacked=w.makePretty=w.sanToMove=w.moveToSan=w.generateMoves=w.removePiece=w.putPiece=w.clonePiece=w.cloneMove=w.getPiece=w.loadPgn=w.getPgn=w.loadFen=w.getFen=w.getDisambiguator=void 0;var e=Oe(),t=tt(),r=rt();function n(f,_,d){for(var m=h(f,{legal:!d}),g=_.from,A=_.to,S=_.piece,E=0,y=0,P=0,K=0,$=m.length;K<$;K++){var Q=m[K].from,U=m[K].to,L=m[K].piece;S===L&&g!==Q&&A===U&&(E++,r.rank(g)===r.rank(Q)&&y++,r.file(g)===r.file(Q)&&P++)}return E>0?y>0&&P>0?r.algebraic(g):P>0?r.algebraic(g).charAt(1):r.algebraic(g).charAt(0):""}w.getDisambiguator=n;function i(f){for(var _=0,d="",m=e.SQUARES.a8;m<=e.SQUARES.h1;m++){var g=f.board[m];if(!g)_++;else{_>0&&(d+=_,_=0);var A=g.color,S=g.type;d+=A===e.WHITE?S.toUpperCase():S.toLowerCase()}m+1&136&&(_>0&&(d+=_),m!==e.SQUARES.h1&&(d+="/"),_=0,m+=8)}var E="";f.castling[e.WHITE]&e.BITS.KSIDE_CASTLE&&(E+="K"),f.castling[e.WHITE]&e.BITS.QSIDE_CASTLE&&(E+="Q"),f.castling[e.BLACK]&e.BITS.KSIDE_CASTLE&&(E+="k"),f.castling[e.BLACK]&e.BITS.QSIDE_CASTLE&&(E+="q"),E=E||"-";var y=f.ep_square===e.EMPTY?"-":r.algebraic(f.ep_square);return[d,f.turn,E,y,f.half_moves,f.move_number].join(" ")}w.getFen=i;function o(f){var _=f.split(/\s+/),d=_[0],m=0;if(!r.validateFen(f).valid)return null;for(var g=new t.State,A=0;A<d.length;A++){var S=d.charAt(A);if(S==="/")m+=8;else if(r.isDigit(S))m+=parseInt(S,10);else{var E=S<"a"?e.WHITE:e.BLACK,y=l(g,{type:S.toLowerCase(),color:E},r.algebraic(m));if(!y)return null;g=y,m++}}return g.turn=_[1]===e.BLACK?e.BLACK:e.WHITE,_[2].indexOf("K")>-1&&(g.castling.w|=e.BITS.KSIDE_CASTLE),_[2].indexOf("Q")>-1&&(g.castling.w|=e.BITS.QSIDE_CASTLE),_[2].indexOf("k")>-1&&(g.castling.b|=e.BITS.KSIDE_CASTLE),_[2].indexOf("q")>-1&&(g.castling.b|=e.BITS.QSIDE_CASTLE),g.ep_square=_[3]==="-"?e.EMPTY:e.SQUARES[_[3]],g.half_moves=parseInt(_[4],10),g.move_number=parseInt(_[5],10),g}w.loadFen=o;function u(f,_,d,m,g){g===void 0&&(g={});var A=g.newline_char,S=A===void 0?`
`:A,E=g.max_width,y=E===void 0?0:E,P=[],K=!1;for(var $ in _)P.push("["+$+' "'+_[$]+'"]'+S),K=!0;K&&m.length&&P.push(S);var Q=function(C){var B=d[f.fen];if(typeof B<"u"){var H=C.length>0?" ":"";C=""+C+H+"{"+B+"}"}return C};m[0]&&(f=m[0].state);var U=[],L="";if(m.length===0&&U.push(Q("")),m.forEach(function(C,B){var H=C.move;L=Q(L),B===0&&H.color===e.BLACK?L=f.move_number+". ...":H.color===e.WHITE&&(L.length&&U.push(L),L=f.move_number+"."),L=L+" "+k(f,H),f=oe(f,H)}),L.length&&U.push(Q(L)),typeof _.Result<"u"&&U.push(_.Result),y===0)return P.join("")+U.join(" ");for(var q=function(){return P.length>0&&P[P.length-1]===" "?(P.pop(),!0):!1},N=function(C,B){for(var H=0,Z=B.split(" ");H<Z.length;H++){var G=Z[H];if(G){if(C+G.length>y){for(;q();)C--;P.push(S),C=0}P.push(G),C+=G.length,P.push(" "),C++}}return q()&&C--,C},T=0,$=0;$<U.length;$++){if(T+U[$].length>y&&U[$].includes("{")){T=N(T,U[$]);continue}T+U[$].length>y&&$!==0?(P[P.length-1]===" "&&P.pop(),P.push(S),T=0):$!==0&&(P.push(" "),T++),P.push(U[$]),T+=U[$].length}return P.join("")}w.getPgn=u;function c(f,_){_===void 0&&(_={});var d=_.newline_char,m=d===void 0?`\r?
`:d,g=_.sloppy,A=g===void 0?!1:g,S=function(W){return W.replace(/\\/g,"\\")},E=function(W,re){for(var Ne=re.newline_char,ke={},ve=W.split(new RegExp(S(Ne))),de="",Te="",pe=0;pe<ve.length;pe++)de=ve[pe].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),Te=ve[pe].replace(/^\[[A-Za-z]+\s"(.*)" *\]$/,"$1"),de.trim().length>0&&(ke[de.trim()]=Te);return ke},y=new RegExp("^(\\[((?:"+S(m)+")|.)*\\])(?:"+S(m)+"){2}"),P=y.test(f)?y.exec(f)[1]:"",K=o(e.DEFAULT_POSITION),$=E(P,{newline_char:m});if($.SetUp==="1"&&"FEN"in $){var Q=o($.FEN);if(!Q)return null;K=Q}for(var U=function(W){return Array.from(W).map(function(re){return re.charCodeAt(0)<128?re.charCodeAt(0).toString(16):encodeURIComponent(re).replace(/%/g,"").toLowerCase()}).join("")},L=function(W){var re;return W.length==0?"":decodeURIComponent("%"+((re=W?.match(/.{1,2}/g))===null||re===void 0?void 0:re.join("%")))},q=function(W){return W=W.replace(new RegExp(S(m),"g")," "),"{"+U(W.slice(1,W.length-1))+"}"},N=function(W){if(W.startsWith("{")&&W.endsWith("}"))return L(W.slice(1,W.length-1))},T=f.replace(P,"").replace(new RegExp("({[^}]*})+?|;([^"+S(m)+"]*)","g"),function(W,re,Ne){return re!==void 0?q(re):" "+q("{"+Ne.slice(1)+"}")}).replace(new RegExp(S(m),"g")," "),C=/(\([^()]+\))+?/g;C.test(T);)T=T.replace(C,"");T=T.replace(/\d+\.(\.\.)?/g,""),T=T.replace(/\.\.\./g,""),T=T.replace(/\$\d+/g,"");for(var B=T.trim().split(new RegExp(/\s+/)).join(",").replace(/,,+/g,",").split(","),H={},Z=[],G=0;G<B.length;G++){var ee=B[G],te=N(ee);if(te!==void 0){H[K.fen]=te;continue}if(G===B.length-1&&e.POSSIBLE_RESULTS.indexOf(ee)!==-1){Object.keys($).length&&typeof $.Result>"u"&&($.Result=ee);continue}var ne=I(K,B[G],{sloppy:A});if(ne===null)return null;Z.push({move:ne,state:K});var Q=oe(K,ne);if(!Q)return null;K=Q}return[K,$,H,Z]}w.loadPgn=c;function a(f,_){if(!_||(_=_.toLowerCase(),!r.isSquare(_)))return null;var d=e.SQUARES[_],m=f.board[d];return m?p(m):null}w.getPiece=a;function s(f){return{to:f.to,from:f.from,color:f.color,flags:f.flags,piece:f.piece,captured:f.captured,promotion:f.promotion,san:f.san}}w.cloneMove=s;function p(f){return{color:f.color,type:f.type}}w.clonePiece=p;function l(f,_,d){var m=_.type,g=_.color;if(!m||!g||!d||(m=m.toLowerCase(),g=g.toLowerCase(),d=d.toLowerCase(),!r.isPieceSymbol(m)||!r.isColor(g)||!r.isSquare(d)))return null;var A=f.clone(),S=e.SQUARES[d];return m===e.KING&&A.kings[g]!==e.EMPTY&&A.kings[g]!==S?null:(A.board[S]={type:m,color:g},m===e.KING&&(A.kings[g]=S),A)}w.putPiece=l;function b(f,_){if(!_||(_=_.toLowerCase(),!r.isSquare(_)))return null;var d=e.SQUARES[_],m=f.board[d];if(!m)return null;var g=f.clone(),A=m.type,S=m.color;return A===e.KING&&(g.kings[S]=e.EMPTY),delete g.board[d],g}w.removePiece=b;function h(f,_){var d,m;_===void 0&&(_={});var g=_.legal,A=g===void 0?!0:g,S=function(Ne,ke,ve,de,Te){var pe=Ne[ve];if(pe&&pe.type===e.PAWN&&(r.rank(de)===e.RANK_8||r.rank(de)===e.RANK_1))for(var nt=[e.QUEEN,e.ROOK,e.BISHOP,e.KNIGHT],qe=0,xt=nt.length;qe<xt;qe++)ke.push(ie(f,ve,de,Te,nt[qe]));else ke.push(ie(f,ve,de,Te))},E=[],y=f.turn,P=r.swapColor(y),K={b:e.RANK_7,w:e.RANK_2},$=e.SQUARES.a8,Q=e.SQUARES.h1,U=!1,L=_.square;if(L)if(L=L.toLowerCase(),r.isSquare(L))$=Q=e.SQUARES[L],U=!0;else return[];for(var q=$;q<=Q;q++){if(q&136){q+=7;continue}var N=f.board[q];if(!(!N||N.color!==y))if(N.type===e.PAWN){var T=q+e.PAWN_OFFSETS[y][0];if(!f.board[T]){S(f.board,E,q,T,e.BITS.NORMAL);var C=q+e.PAWN_OFFSETS[y][1];K[y]===r.rank(q)&&!f.board[C]&&S(f.board,E,q,C,e.BITS.BIG_PAWN)}for(var B=2;B<4;B++){var H=q+e.PAWN_OFFSETS[y][B];H&136||(f.board[H]&&((d=f.board[H])===null||d===void 0?void 0:d.color)===P?S(f.board,E,q,H,e.BITS.CAPTURE):H===f.ep_square&&S(f.board,E,q,f.ep_square,e.BITS.EP_CAPTURE))}}else for(var B=0,Z=e.PIECE_OFFSETS[N.type].length;B<Z;B++)for(var G=e.PIECE_OFFSETS[N.type][B],ee=q;ee+=G,!(ee&136);){if(!f.board[ee])S(f.board,E,q,ee,e.BITS.NORMAL);else{if(((m=f.board[ee])===null||m===void 0?void 0:m.color)===y)break;S(f.board,E,q,ee,e.BITS.CAPTURE);break}if(N.type==="n"||N.type==="k")break}}if(!U||Q===f.kings[y]){if(f.castling[y]&e.BITS.KSIDE_CASTLE){var te=f.kings[y],ne=te+2;!f.board[te+1]&&!f.board[ne]&&!O(f,P,f.kings[y])&&!O(f,P,te+1)&&!O(f,P,ne)&&S(f.board,E,f.kings[y],ne,e.BITS.KSIDE_CASTLE)}if(f.castling[y]&e.BITS.QSIDE_CASTLE){var te=f.kings[y],ne=te-2;!f.board[te-1]&&!f.board[te-2]&&!f.board[te-3]&&!O(f,P,f.kings[y])&&!O(f,P,te-1)&&!O(f,P,ne)&&S(f.board,E,f.kings[y],ne,e.BITS.QSIDE_CASTLE)}}if(!A)return E;for(var W=[],q=0,Z=E.length;q<Z;q++){var re=oe(f,E[q]);R(re,y)||W.push(E[q])}return W}w.generateMoves=h;function k(f,_,d){var m;d===void 0&&(d={});var g=d.sloppy,A=g===void 0?!1:g,S=d.checkPromotion,E=S===void 0?!0:S,y="";if(_.flags&e.BITS.KSIDE_CASTLE)y="O-O";else if(_.flags&e.BITS.QSIDE_CASTLE)y="O-O-O";else{var P=n(f,_,A);_.piece!==e.PAWN&&(y+=_.piece.toUpperCase()+P),_.flags&(e.BITS.CAPTURE|e.BITS.EP_CAPTURE)&&(_.piece===e.PAWN&&(y+=r.algebraic(_.from)[0]),y+="x"),y+=r.algebraic(_.to),E&&_.flags&e.BITS.PROMOTION&&(y+="="+((m=_.promotion)===null||m===void 0?void 0:m.toUpperCase()))}var K=oe(f,_);return V(K)&&(j(K)?y+="#":y+="+"),y}w.moveToSan=k;function I(f,_,d){d===void 0&&(d={});var m=d.sloppy,g=m===void 0?!1:m,A=d.checkPromotion,S=A===void 0?!0:A,E=r.strippedSan(_),y,P,K,$,Q;g&&(y=E.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),y&&(P=y[1],K=y[2],$=y[3],Q=y[4]));for(var U=h(f,{square:K}),L=0,q=U.length;L<q;L++){var N=k(f,U[L],{checkPromotion:S});if(E===r.strippedSan(N)||g&&E===r.strippedSan(k(f,U[L],d))||K&&$&&r.isSquare(K)&&r.isSquare($)&&y&&(!P||P.toLowerCase()==U[L].piece)&&e.SQUARES[K]==U[L].from&&e.SQUARES[$]==U[L].to&&(!S||!Q||Q.toLowerCase()==U[L].promotion))return U[L]}return null}w.sanToMove=I;function F(f,_){var d=s(_),m="";for(var g in e.BITS)r.isFlagKey(g)&&e.BITS[g]&d.flags&&(m+=e.FLAGS[g]);return{to:r.algebraic(d.to),from:r.algebraic(d.from),color:d.color,flags:m,piece:d.piece,san:k(f,d),captured:d.captured,promotion:d.promotion}}w.makePretty=F;function O(f,_,d){for(var m,g=e.SQUARES.a8;g<=e.SQUARES.h1;g++){if(g&136){g+=7;continue}if(!(f.board[g]==null||((m=f.board[g])===null||m===void 0?void 0:m.color)!==_)){var A=f.board[g],S=g-d,E=S+119;if(A&&e.ATTACKS[E]&1<<e.SHIFTS[A.type]){if(A.type===e.PAWN){if(S>0){if(A.color===e.WHITE)return!0}else if(A.color===e.BLACK)return!0;continue}if(A.type==="n"||A.type==="k")return!0;for(var y=e.RAYS[E],P=g+y,K=!1;P!==d;){if(f.board[P]){K=!0;break}P+=y}if(!K)return!0}}}return!1}w.isAttacked=O;function R(f,_){return O(f,r.swapColor(_),f.kings[_])}w.isKingAttacked=R;function V(f){return R(f,f.turn)}w.inCheck=V;function j(f){return V(f)&&h(f).length===0}w.inCheckmate=j;function he(f){return!V(f)&&h(f).length===0}w.inStalemate=he;function ae(f){for(var _={},d=[],m=0,g=0,A=e.SQUARES.a8;A<=e.SQUARES.h1;A++){if(g=(g+1)%2,A&136){A+=7;continue}var S=f.board[A];S&&(_[S.type]=S.type in _?_[S.type]+1:1,S.type===e.BISHOP&&d.push(g),m++)}if(m===2)return!0;if(m===3&&(_[e.BISHOP]===1||_[e.KNIGHT]===1))return!0;if(m===_[e.BISHOP]+2){for(var E=0,y=d.length,A=0;A<y;A++)E+=d[A];if(E===0||E===y)return!0}return!1}w.insufficientMaterial=ae;function oe(f,_){var d=f.clone(),m=d.turn,g=r.swapColor(m);d.board[_.to]=d.board[_.from],delete d.board[_.from],_.flags&e.BITS.EP_CAPTURE&&(d.turn===e.BLACK?delete d.board[_.to-16]:delete d.board[_.to+16]),_.flags&e.BITS.PROMOTION&&_.promotion&&r.isPieceSymbol(_.promotion)&&(d.board[_.to]={type:_.promotion,color:m});var A=d.board[_.to];if(A&&A.type===e.KING){if(d.kings[A.color]=_.to,_.flags&e.BITS.KSIDE_CASTLE){var S=_.to-1,E=_.to+1;d.board[S]=d.board[E],delete d.board[E]}else if(_.flags&e.BITS.QSIDE_CASTLE){var S=_.to+1,E=_.to-2;d.board[S]=d.board[E],delete d.board[E]}d.castling[m]=0}if(d.castling[m]){for(var y=0,P=e.ROOKS[m].length;y<P;y++)if(_.from===e.ROOKS[m][y].square&&d.castling[m]&e.ROOKS[m][y].flag){d.castling[m]^=e.ROOKS[m][y].flag;break}}if(d.castling[g]){for(var y=0,P=e.ROOKS[g].length;y<P;y++)if(_.to===e.ROOKS[g][y].square&&d.castling[g]&e.ROOKS[g][y].flag){d.castling[g]^=e.ROOKS[g][y].flag;break}}return _.flags&e.BITS.BIG_PAWN?d.turn==="b"?d.ep_square=_.to-16:d.ep_square=_.to+16:d.ep_square=e.EMPTY,_.piece===e.PAWN||_.flags&(e.BITS.CAPTURE|e.BITS.EP_CAPTURE)?d.half_moves=0:d.half_moves++,d.turn===e.BLACK&&d.move_number++,d.turn=r.swapColor(d.turn),d}w.makeMove=oe;function ie(f,_,d,m,g){var A,S={color:f.turn,from:_,to:d,flags:m,piece:f.board[_].type};return g&&r.isPieceSymbol(g)&&(S.flags|=e.BITS.PROMOTION,S.promotion=g),f.board[d]?S.captured=(A=f.board[d])===null||A===void 0?void 0:A.type:m&e.BITS.EP_CAPTURE&&(S.captured=e.PAWN),S}w.buildMove=ie;function le(f,_){_===void 0&&(_=`
`);var d=e.RANKS.map(function(m){for(var g=f.slice(m*16,m*16+8),A=[],S=0,E=g;S<E.length;S++){var y=E[S];A.push(y?" "+r.symbol(y)+" ":" . ")}var P=A.join("");return"87654321"[m]+" |"+P+"|"});return["  +------------------------+",d.join(_),"  +------------------------+","    a  b  c  d  e  f  g  h"].join(_)}w.ascii=le;function X(f){for(var _=[],d=[],m=e.SQUARES.a8;m<=e.SQUARES.h1;m++){var g=f[m];g==null?d.push(null):d.push({type:g.type,color:g.color}),m+1&136&&(_.push(d),d=[],m+=8)}return _}w.getBoard=X;function x(f,_,d){d===void 0&&(d={});var m=d.checkPromotion,g=m===void 0?!0:m;if(typeof _=="string")return I(f,_,d);if(typeof _=="object")for(var A=h(f,{square:_.from}),S=0,E=A;S<E.length;S++){var y=E[S];if(_.from===r.algebraic(y.from)&&_.to===r.algebraic(y.to)&&(!g||!("promotion"in y)||_.promotion===y.promotion))return y}return null}return w.validateMove=x,w}var St;function cr(){if(St)return ce;St=1;var e=ce&&ce.__assign||function(){return e=Object.assign||function(c){for(var a,s=1,p=arguments.length;s<p;s++){a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(c[l]=a[l])}return c},e.apply(this,arguments)},t=ce&&ce.__spreadArrays||function(){for(var c=0,a=0,s=arguments.length;a<s;a++)c+=arguments[a].length;for(var p=Array(c),l=0,a=0;a<s;a++)for(var b=arguments[a],h=0,k=b.length;h<k;h++,l++)p[l]=b[h];return p};Object.defineProperty(ce,"__esModule",{value:!0}),ce.Chess=void 0;var r=zt(),n=tt(),i=rt(),o=Oe(),u=(function(){function c(a){if(a===void 0&&(a=o.DEFAULT_POSITION),this._state=new n.State,this._history=[],this._header={},this._comments={},!this.load(a))throw new Error("Error loading fen")}return Object.defineProperty(c.prototype,"state",{get:function(){return this._state.clone()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"states",{get:function(){return t(this._history.map(function(a){return a.state.clone()}),[this.state])},enumerable:!1,configurable:!0}),c.prototype.load=function(a,s){s===void 0&&(s=!1);var p=r.loadFen(a);return p?(this._state=p,this._history=[],s||(this._header={}),this._comments={},this.updateSetup(),!0):!1},c.prototype.clear=function(a){a===void 0&&(a=!1),this._state=new n.State,this._history=[],a||(this._header={}),this._comments={},this.updateSetup()},c.prototype.reset=function(){this.load(o.DEFAULT_POSITION)},c.prototype.get=function(a){return r.getPiece(this._state,a)},c.prototype.put=function(a,s){var p=r.putPiece(this._state,a,s);return p?(this._state=p,this.updateSetup(),!0):!1},c.prototype.remove=function(a){var s=r.getPiece(this._state,a);if(!s)return null;var p=r.removePiece(this._state,a);return p?(this._state=p,s):null},c.prototype.moves=function(a){var s=this;a===void 0&&(a={});var p=a.square,l=a.verbose,b=l===void 0?!1:l,h=r.generateMoves(this._state,{square:p});return b?h.map(function(k){return r.makePretty(s._state,k)}):h.map(function(k){return r.moveToSan(s._state,k)})},c.prototype.fen=function(){return this._state.fen},c.prototype.inCheck=function(){return r.inCheck(this._state)},c.prototype.inCheckmate=function(){return r.inCheckmate(this._state)},c.prototype.inStalemate=function(){return r.inStalemate(this._state)},c.prototype.insufficientMaterial=function(){return r.insufficientMaterial(this._state)},c.prototype.inThreefoldRepetition=function(){for(var a={},s=function(h){var k=h.fen.split(" ").slice(0,4).join(" ");return a[k]=k in a?a[k]+1:1,a[k]>=3},p=0,l=this._history;p<l.length;p++){var b=l[p].state;if(s(b))return!0}return s(this._state)},c.prototype.inDraw=function(){return this._state.half_moves>=100||this.inStalemate()||this.insufficientMaterial()||this.inThreefoldRepetition()},c.prototype.gameOver=function(){return this.inCheckmate()||this.inDraw()},c.prototype.board=function(){return r.getBoard(this._state.board)},c.prototype.pgn=function(a){return a===void 0&&(a={}),r.getPgn(this._state,this._header,this._comments,this._history,a)},c.prototype.loadPgn=function(a,s){s===void 0&&(s={});var p=r.loadPgn(a,s);if(!p)return!1;var l=p[0],b=p[1],h=p[2],k=p[3];return this._state=l,this._header=b,this._comments=h,this._history=k,!0},c.prototype.header=function(){return this._header},c.prototype.setHeader=function(a){this._header=a},c.prototype.addHeader=function(a,s){this._header[a]=s},c.prototype.removeHeader=function(a){delete this._header[a]},c.prototype.clearHeader=function(){this._header={}},c.prototype.ascii=function(a){return a===void 0&&(a=`
`),r.ascii(this._state.board,a)},c.prototype.turn=function(){return this._state.turn},c.prototype.move=function(a,s){s===void 0&&(s={});var p=r.validateMove(this._state,a,s);if(!p)return null;var l=r.makePretty(this._state,p);return s.dry_run||this.makeMove(p),l},c.prototype.validateMoves=function(a,s){s===void 0&&(s={});for(var p=[],l=this._state,b=0,h=a;b<h.length;b++){var k=h[b],I=r.validateMove(l,k,s);if(!I)return null;p.push(r.makePretty(l,I)),l=r.makeMove(l,I)}return p},c.prototype.isPromotion=function(a,s){s===void 0&&(s={});var p=r.validateMove(this._state,a,e(e({},s),{checkPromotion:!1}));return p?!!(p.flags&o.BITS.PROMOTION):!1},c.prototype.undo=function(){var a=this.undoMove();return a?r.makePretty(this._state,a):null},c.prototype.squareColor=function(a){if(i.isSquare(a)){var s=o.SQUARES[a];return(i.rank(s)+i.file(s))%2===0?"light":"dark"}return null},c.prototype.history=function(a){a===void 0&&(a={});var s=a.verbose,p=s===void 0?!1:s;if(!this._history.length)return[];var l;return p?this._history.map(function(b){var h=b.move;return l=b.state,r.makePretty(l,h)}):this._history.map(function(b){var h=b.move;return l=b.state,r.moveToSan(l,h)})},c.prototype.getComment=function(a){return a=a||this.fen(),this._comments[a]},c.prototype.getComments=function(){var a=this;return this.pruneComments(),Object.keys(this._comments).map(function(s){return{fen:s,comment:a._comments[s]}})},c.prototype.setComment=function(a,s){s=s||this.fen(),this._comments[s]=a.replace("{","[").replace("}","]")},c.prototype.deleteComment=function(a){a=a||this.fen();var s=this._comments[a];return delete this._comments[a],s},c.prototype.deleteComments=function(){var a=this;return this.pruneComments(),Object.keys(this._comments).map(function(s){var p=a._comments[s];return delete a._comments[s],{fen:s,comment:p}})},c.prototype.validateFen=function(a){return i.validateFen(a)},c.prototype.clone=function(){var a=new c;return a._state=this._state,a._history=t(this._history),a._header=e({},this._header),a._comments=e({},this._comments),a},c.prototype.perft=function(a){for(var s=r.generateMoves(this._state,{legal:!1}),p=0,l=this._state.turn,b=0,h=s.length;b<h;b++){if(this.makeMove(s[b]),!this.kingAttacked(l))if(a-1>0){var k=this.perft(a-1);p+=k}else p++;this.undoMove()}return p},c.prototype.updateSetup=function(){var a=this._state.fen;this._history.length>0||(a!==o.DEFAULT_POSITION?(this._header.SetUp="1",this._header.FEN=a):(delete this._header.SetUp,delete this._header.FEN))},c.prototype.pruneComments=function(){var a=this,s={},p=function(b){b in a._comments&&(s[b]=a._comments[b])};this._history.forEach(function(b){var h=b.state;l=h,p(l.fen)});var l=this._state;p(l.fen),this._comments=s},c.prototype.strippedSan=function(a){return a.replace(/=/,"").replace(/[+#]?[?!]*$/,"")},c.prototype.attacked=function(a,s){return r.isAttacked(this._state,a,s)},c.prototype.kingAttacked=function(a){return this.attacked(i.swapColor(a),this._state.kings[a])},c.prototype.makeMove=function(a){this._history.push({move:a,state:this._state}),this._state=r.makeMove(this._state,a)},c.prototype.undoMove=function(){var a=this._history.pop();return a==null?null:(this._state=a.state,a.move)},c})();return ce.Chess=u,ce}var Nt;function ur(){return Nt||(Nt=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=cr();Object.defineProperty(e,"Chess",{enumerable:!0,get:function(){return t.Chess}});var r=tt();Object.defineProperty(e,"State",{enumerable:!0,get:function(){return r.State}});var n=Oe();Object.defineProperty(e,"WHITE",{enumerable:!0,get:function(){return n.WHITE}}),Object.defineProperty(e,"BLACK",{enumerable:!0,get:function(){return n.BLACK}}),Object.defineProperty(e,"PAWN",{enumerable:!0,get:function(){return n.PAWN}}),Object.defineProperty(e,"KNIGHT",{enumerable:!0,get:function(){return n.KNIGHT}}),Object.defineProperty(e,"BISHOP",{enumerable:!0,get:function(){return n.BISHOP}}),Object.defineProperty(e,"ROOK",{enumerable:!0,get:function(){return n.ROOK}}),Object.defineProperty(e,"QUEEN",{enumerable:!0,get:function(){return n.QUEEN}}),Object.defineProperty(e,"KING",{enumerable:!0,get:function(){return n.KING}}),Object.defineProperty(e,"EMPTY",{enumerable:!0,get:function(){return n.EMPTY}}),Object.defineProperty(e,"SQUARES",{enumerable:!0,get:function(){return n.SQUARES}}),Object.defineProperty(e,"FLAGS",{enumerable:!0,get:function(){return n.FLAGS}}),Object.defineProperty(e,"BITS",{enumerable:!0,get:function(){return n.BITS}});var i=rt();Object.defineProperty(e,"rank",{enumerable:!0,get:function(){return i.rank}}),Object.defineProperty(e,"file",{enumerable:!0,get:function(){return i.file}}),Object.defineProperty(e,"algebraic",{enumerable:!0,get:function(){return i.algebraic}})})(De)),De}var me=ur();const fr="3.1.1";class se{constructor(t,r){this._currentBannedMove=null,this._history=[],this._ply=1,this._indicatorConfig={pgn:!0,serialization:!0,san:!0},this.chess=new me.Chess,r?this.loadFromPGN(r):t&&this.loadFromFEN(t)}getPly(){return this._ply}getActivePlayer(){switch((this._ply-1)%4+1){case 1:return"black";case 2:return"white";case 3:return"white";case 4:return"black";default:return"black"}}getActionType(){return this._ply%2===1?"ban":"move"}get turn(){return this.getActivePlayer()}get currentBannedMove(){return this._currentBannedMove}nextActionType(){return this.getActionType()}play(t){try{return"ban"in t?this.playBan(t.ban):this.playMove(t.move)}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}playBan(t){if(this.gameOver())return{success:!1,error:"Game is over"};if(this.getActionType()!=="ban")return{success:!1,error:"Expected a move, not a ban"};if(!this.legalBans().some(h=>h.from===t.from&&h.to===t.to))return{success:!1,error:`Invalid ban: ${t.from}-${t.to}`};this._currentBannedMove=t;const i=new me.Chess(this.chess.fen()),u=i.moves({verbose:!0}).filter(h=>!(h.from===t.from&&h.to===t.to)),c=u.length===0&&i.inCheck(),a=u.length===0&&!i.inCheck(),s=i.inCheck()&&u.length>0,p={check:s,checkmate:c,stalemate:a,gameOver:c||a,banCausedCheckmate:c,banCausedStalemate:a};let l=`${t.from}${t.to}`;this._indicatorConfig.san&&(c?l+="#":a?l+="=":s&&(l+="+"));const b={ply:this._ply,player:this.getActivePlayer(),actionType:"ban",action:t,fen:this.fen(),bannedMove:t,san:l,flags:p};return this._history.push(b),this._ply++,{success:!0,action:{ban:t},san:this._indicatorConfig.san?l:`${t.from}${t.to}`,newFen:this.fen(),flags:p,check:p.check,checkmate:p.checkmate,stalemate:p.stalemate,gameOver:p.gameOver,draw:p.draw}}playMove(t){if(this.gameOver())return{success:!1,error:"Game is over"};if(this.getActionType()!=="move")return{success:!1,error:"Expected a ban, not a move"};if(this.isBannedMove(t))return{success:!1,error:`Move ${t.from}-${t.to} is banned`};const r=this.chess.move({from:t.from,to:t.to,promotion:t.promotion});if(!r)return{success:!1,error:`Invalid move: ${t.from}-${t.to}`};const n={check:this.chess.inCheck(),checkmate:this.chess.inCheckmate(),stalemate:this.chess.inStalemate(),draw:this.chess.inDraw(),gameOver:this.chess.gameOver(),insufficientMaterial:this.chess.insufficientMaterial(),threefoldRepetition:this.chess.inThreefoldRepetition(),fiftyMoveRule:this.chess.inDraw()&&!this.chess.inStalemate()&&!this.chess.insufficientMaterial()},i={ply:this._ply,player:this.getActivePlayer(),actionType:"move",action:t,san:r.san,fen:this.fen(),bannedMove:this._currentBannedMove,flags:n};this._history.push(i),this._currentBannedMove=null,this._ply++;let o=r.san;return!this._indicatorConfig.san&&o&&(o=o.replace(/[+#=]$/,"")),{success:!0,action:{move:t},san:o,newFen:this.fen(),flags:n,check:n.check,checkmate:n.checkmate,stalemate:n.stalemate,gameOver:n.gameOver,draw:n.draw}}isBannedMove(t){return this._currentBannedMove?this._currentBannedMove.from===t.from&&this._currentBannedMove.to===t.to:!1}getLegalActions(){return this.gameOver()?[]:this.getActionType()==="ban"?this.legalBans().map(t=>({ban:t})):this.legalMoves().map(t=>({move:t}))}legalMoves(){if(this.gameOver())return[];if(this.getActionType()!=="move")return[];const r=this.chess.moves({verbose:!0}).map(n=>({from:n.from,to:n.to,promotion:n.promotion}));return this._currentBannedMove?r.filter(n=>!this.isBannedMove(n)):r}legalBans(){if(this.gameOver())return[];if(this.getActionType()!=="ban")return[];const r=new me.Chess(this.chess.fen()).moves({verbose:!0}),n=new Map;return r.forEach(i=>{const o=`${i.from}-${i.to}`;n.has(o)||n.set(o,{from:i.from,to:i.to})}),Array.from(n.values())}inCheck(){return this.chess.inCheck()}inCheckmate(){return this.chess.inCheckmate()}inStalemate(){return this.chess.inStalemate()}gameOver(){return this.inCheckmate()||this.inStalemate()||this.inDraw()}inDraw(){return this.chess.inDraw()}inThreefoldRepetition(){return this.chess.inThreefoldRepetition()}insufficientMaterial(){return this.chess.insufficientMaterial()}currentPlayer(){return this.turn}setIndicatorConfig(t){this._indicatorConfig={...this._indicatorConfig,...t}}getIndicatorConfig(){return{...this._indicatorConfig}}nextMoveColor(){return this.chess.turn()==="w"?"white":"black"}getGameIndicator(){const t=this.getGameFlags();return t.checkmate?"#":t.stalemate||t.draw?"=":t.check?"+":""}getGameFlags(){const t=this._history[this._history.length-1],r=t?.flags?.banCausedCheckmate||!1,n=t?.flags?.banCausedStalemate||!1;return{check:this.chess.inCheck(),checkmate:this.chess.inCheckmate(),stalemate:this.chess.inStalemate(),draw:this.chess.inDraw(),gameOver:this.chess.gameOver(),insufficientMaterial:this.chess.insufficientMaterial(),threefoldRepetition:this.chess.inThreefoldRepetition(),fiftyMoveRule:this.chess.inDraw()&&!this.chess.inStalemate()&&!this.chess.insufficientMaterial()&&!this.chess.inThreefoldRepetition(),banCausedCheckmate:r,banCausedStalemate:n}}fen(){const t=this.chess.fen();let r=this._ply.toString();this._currentBannedMove&&(r+=`:${this._currentBannedMove.from}${this._currentBannedMove.to}`);const n=this.getGameIndicator();return r+=n,`${t} ${r}`}pgn(){let t="",r="";for(let n=0;n<this._history.length;n++){const i=this._history[n];let o=1;if(i.actionType==="move"&&(i.player==="white"?o=Math.floor((i.ply-2)/4)+1:o=Math.floor((i.ply-4)/4)+1),i.actionType==="ban"){const u=i.action;let c=`${u.from}${u.to}`;if(this._indicatorConfig.pgn&&i.san){const a=i.san.match(/[+#=]$/)?.[0];a&&(c+=a)}r+=`{banning: ${c}} `}else{i.player==="white"&&(r=`${o}. ${r}`);let u=i.san||"";!this._indicatorConfig.pgn&&u&&(u=u.replace(/[+#=]$/,"")),r+=`${u} `,i.player==="black"&&(t+=r,r="")}}if(r){const n=this._history.length>0?Math.floor((this._history[this._history.length-1].ply+1)/2):1;r.startsWith(`${n}.`)||(r=`${n}. ${r}`),t+=r}if(this._history.length>0){const n=this._history[this._history.length-1];if(n.actionType==="move"&&n.san){if(n.san.endsWith("#")){const i=n.player==="white"?"1-0":"0-1";t=t.trim()+" "+i}}else if(n.actionType==="ban"&&this.gameOver())if(this.inCheckmate()){const i=this.chess.turn()==="w"?"0-1":"1-0";t=t.trim()+" "+i}else this.inStalemate()&&(t=t.trim()+" 1/2-1/2")}return t.trim()}history(){return[...this._history]}reset(){this.chess=new me.Chess,this._currentBannedMove=null,this._history=[],this._ply=1}ascii(){let t=this.chess.ascii();return this._currentBannedMove&&(t+=`
Banned: ${this._currentBannedMove.from}-${this._currentBannedMove.to}`),t+=`
Ply: ${this._ply} (${this.getActionType()} by ${this.getActivePlayer()})`,t}static serializeAction(t,r){let n;if("ban"in t)n=`b:${t.ban.from}${t.ban.to}`;else{const i=t.move;n=`m:${i.from}${i.to}${i.promotion||""}`}return r&&(n+=r),n}static deserializeAction(t){const r=t.match(/^([bm]):([a-h][1-8])([a-h][1-8])([qrbn])?([+#=])?$/);if(!r)throw new Error(`Invalid serialized action format: ${t}`);const[,n,i,o,u,c]=r;return n==="b"?{ban:{from:i,to:o}}:{move:u?{from:i,to:o,promotion:u}:{from:i,to:o}}}getLastActionSerialized(){if(this._history.length===0)return null;const t=this._history[this._history.length-1],r=t.actionType==="ban"?{ban:t.action}:{move:t.action};if(!this._indicatorConfig.serialization)return se.serializeAction(r);let n;if(t.san){const i=t.san.match(/[+#=]$/);i&&(n=i[0])}return se.serializeAction(r,n)}getSyncState(){return{fen:this.fen(),lastAction:this.getLastActionSerialized()||void 0,ply:this._ply}}playSerializedAction(t){try{const r=se.deserializeAction(t);return this.play(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:"Invalid serialized action"}}}loadFromSyncState(t){this.loadFromFEN(t.fen),this._ply=t.ply}getActionLog(){return this._history.map(t=>{if(t.actionType==="ban"){const r=t.action;let n=`b:${r.from}${r.to}`;if(t.san&&this._indicatorConfig.serialization){const i=t.san.match(/[+#=]$/);i&&(n+=i[0])}return n}else return t.san||`${t.action.from}${t.action.to}`})}getActionHistory(){return this._history.map((t,r)=>{const n=t.actionType==="ban"?{ban:t.action}:{move:t.action};if(!this._indicatorConfig.serialization)return se.serializeAction(n);let i;return t.actionType==="move"?t.san?.endsWith("#")?i="#":t.san?.endsWith("+")&&(i="+"):r===this._history.length-1&&(this.gameOver()?this.inCheckmate()?i="#":this.inStalemate()&&(i="="):this.nextActionType()==="move"&&this.chess.inCheck()&&(i="+")),se.serializeAction(n,i)})}static replayFromActions(t,r){const n=new se(r);for(const i of t){const o=n.playSerializedAction(i);if(!o.success)throw new Error(`Failed to replay action ${i}: ${o.error}`)}return n}loadFromFEN(t){const r=t.split(" ");if(r.length<7){this.chess=new me.Chess(t);return}const n=r.slice(0,6).join(" ");let i=r[6];if(this.chess=new me.Chess(n),i&&i!=="-"){const o=i[i.length-1];if((o==="+"||o==="#"||o==="=")&&(i=i.slice(0,-1)),i.includes(":")){const[u,c]=i.split(":");this._ply=parseInt(u,10)||1,c&&c.length>=4&&(this._currentBannedMove={from:c.substring(0,2),to:c.substring(2,4)})}else{const u=parseInt(i,10);if(!isNaN(u))this._ply=u;else if(i.startsWith("b:")||i.startsWith("w:")){const[c,a]=i.split(":");a!=="ban"&&a.length===4&&(this._currentBannedMove={from:a.substring(0,2),to:a.substring(2,4)})}}}}loadFromPGN(t){this.reset();const r=t.match(/\{banning:\s*[a-h][1-8][a-h][1-8]\}|[KQRBN]?[a-h]?[1-8]?x?[a-h][1-8](?:=[QRBN])?[+#]?|\d+\./g);if(r){for(const n of r)if(!/^\d+\.$/.test(n)){if(n.includes("banning:")){const i=n.match(/([a-h][1-8])([a-h][1-8])/);if(i){const o={from:i[1],to:i[2]};this.play({ban:o})}}else if(/^[KQRBN]?[a-h]?[1-8]?x?[a-h][1-8]/.test(n)){const o=this.legalMoves().find(u=>{const a=new me.Chess(this.chess.fen()).move({from:u.from,to:u.to,promotion:u.promotion});return a&&a.san===n});o&&this.play({move:o})}}}}}se.VERSION=fr;function _r(e,t){for(var r in t)e[r]=t[r];return e}function kt(e,t){for(var r in e)if(r!=="__source"&&!(r in t))return!0;for(var n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function Tt(e,t){this.props=e,this.context=t}(Tt.prototype=new _e).isPureReactComponent=!0,Tt.prototype.shouldComponentUpdate=function(e,t){return kt(this.props,e)||kt(this.state,t)};var At=M.__b;M.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),At&&At(e)};var hr=M.__e;M.__e=function(e,t,r,n){if(e.then){for(var i,o=t;o=o.__;)if((i=o.__c)&&i.__c)return t.__e==null&&(t.__e=r.__e,t.__k=r.__k),i.__c(e,t)}hr(e,t,r,n)};var Et=M.unmount;function Yt(e,t,r){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),e.__c.__H=null),(e=_r({},e)).__c!=null&&(e.__c.__P===r&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(n){return Yt(n,t,r)})),e}function Vt(e,t,r){return e&&r&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(n){return Vt(n,t,r)}),e.__c&&e.__c.__P===t&&(e.__e&&r.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=r)),e}function Qe(){this.__u=0,this.o=null,this.__b=null}function Zt(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Me(){this.i=null,this.l=null}M.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),Et&&Et(e)},(Qe.prototype=new _e).__c=function(e,t){var r=t.__c,n=this;n.o==null&&(n.o=[]),n.o.push(r);var i=Zt(n.__v),o=!1,u=function(){o||(o=!0,r.__R=null,i?i(c):c())};r.__R=u;var c=function(){if(!--n.__u){if(n.state.__a){var a=n.state.__a;n.__v.__k[0]=Vt(a,a.__c.__P,a.__c.__O)}var s;for(n.setState({__a:n.__b=null});s=n.o.pop();)s.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),e.then(u,u)},Qe.prototype.componentWillUnmount=function(){this.o=[]},Qe.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Yt(this.__b,r,n.__O=n.__P)}this.__b=null}var i=t.__a&&ze(be,null,e.fallback);return i&&(i.__u&=-33),[ze(be,null,t.__a?null:e.children),i]};var Ct=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(Me.prototype=new _e).__a=function(e){var t=this,r=Zt(t.__v),n=t.l.get(e);return n[0]++,function(i){var o=function(){t.props.revealOrder?(n.push(i),Ct(t,e,n)):i()};r?r(o):o()}},Me.prototype.render=function(e){this.i=null,this.l=new Map;var t=Ke(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},Me.prototype.componentDidUpdate=Me.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,r){Ct(e,r,t)})};var dr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,vr=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,pr=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,mr=/[A-Z0-9]/g,gr=typeof document<"u",yr=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};_e.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(_e.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Pt=M.event;function br(){}function Sr(){return this.cancelBubble}function Nr(){return this.defaultPrevented}M.event=function(e){return Pt&&(e=Pt(e)),e.persist=br,e.isPropagationStopped=Sr,e.isDefaultPrevented=Nr,e.nativeEvent=e};var kr={enumerable:!1,configurable:!0,get:function(){return this.class}},wt=M.vnode;M.vnode=function(e){typeof e.type=="string"&&(function(t){var r=t.props,n=t.type,i={},o=n.indexOf("-")===-1;for(var u in r){var c=r[u];if(!(u==="value"&&"defaultValue"in r&&c==null||gr&&u==="children"&&n==="noscript"||u==="class"||u==="className")){var a=u.toLowerCase();u==="defaultValue"&&"value"in r&&r.value==null?u="value":u==="download"&&c===!0?c="":a==="translate"&&c==="no"?c=!1:a[0]==="o"&&a[1]==="n"?a==="ondoubleclick"?u="ondblclick":a!=="onchange"||n!=="input"&&n!=="textarea"||yr(r.type)?a==="onfocus"?u="onfocusin":a==="onblur"?u="onfocusout":pr.test(u)&&(u=a):a=u="oninput":o&&vr.test(u)?u=u.replace(mr,"-$&").toLowerCase():c===null&&(c=void 0),a==="oninput"&&i[u=a]&&(u="oninputCapture"),i[u]=c}}n=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=Ke(r.children).forEach(function(s){s.props.selected=i.value.indexOf(s.props.value)!=-1})),n=="select"&&i.defaultValue!=null&&(i.value=Ke(r.children).forEach(function(s){s.props.selected=i.multiple?i.defaultValue.indexOf(s.props.value)!=-1:i.defaultValue==s.props.value})),r.class&&!r.className?(i.class=r.class,Object.defineProperty(i,"className",kr)):(r.className&&!r.class||r.class&&r.className)&&(i.class=i.className=r.className),t.props=i})(e),e.$$typeof=dr,wt&&wt(e)};var Ot=M.__r;M.__r=function(e){Ot&&Ot(e),e.__c};var It=M.diffed;M.diffed=function(e){It&&It(e);var t=e.props,r=e.__e;r!=null&&e.type==="textarea"&&"value"in t&&t.value!==r.value&&(r.value=t.value==null?"":t.value)};const ue=[{id:"classic",name:"Classic",path:"/themes/classic",description:"In Soviet Russia, you don't see the pieces; the pieces see you."},{id:"modern",name:"Modern",path:"/themes/modern",description:"For the spoiled players who like seeing where their pieces are."}],Tr=({currentTheme:e,onThemeChange:t})=>{const r=ue.findIndex(o=>o.id===e),n=()=>{const o=r<=0?ue.length-1:r-1;t(ue[o].id)},i=()=>{const o=r>=ue.length-1?0:r+1;t(ue[o].id)};return v("div",{className:"theme-carousel",children:[v("button",{className:"carousel-arrow left",onClick:n,"aria-label":"Previous theme",children:"◀"}),v("div",{className:"carousel-display",children:[v("div",{className:"carousel-header",children:[v("span",{className:"carousel-label",children:"Theme:"}),v("span",{className:"carousel-value",children:ue[r]?.name||"Classic"})]}),v("div",{className:"carousel-description",children:ue[r]?.description})]}),v("button",{className:"carousel-arrow right",onClick:i,"aria-label":"Next theme",children:"▶"})]})};function Ar({engine:e,fen:t,isEngineMove:r,onEngineMove:n}){ye(()=>{r&&e.isReady&&!e.isThinking&&e.findBestMove(t)},[r,t,e.isReady]),ye(()=>{e.bestMove&&r&&n&&n(e.bestMove)},[e.bestMove]),ye(()=>{e.isReady&&!e.isThinking&&(e.analyzePosition(t),e.getStats())},[t,e.isReady,e.isThinking]);const i=u=>Math.abs(u)>=1e4?u>0?"M"+Math.ceil((2e4-u)/2):"-M"+Math.ceil((2e4+u)/2):(u/100).toFixed(2),o=u=>(Math.max(-1e3,Math.min(1e3,u))+1e3)/2e3*100;return v("div",{className:"engine-panel",children:[v("h3",{className:"engine-title",children:["🤖 Ban Chess Engine",e.isThinking&&v("span",{className:"thinking-indicator",children:" (thinking...)"})]}),v("div",{className:"eval-container",children:v("div",{className:"eval-bar",children:[v("div",{className:"eval-bar-fill",style:{width:`${o(e.evaluation)}%`}}),v("div",{className:"eval-score",children:i(e.evaluation)})]})}),v("div",{className:"engine-stats",children:[v("div",{className:"stat",children:[v("span",{className:"stat-label",children:"Depth:"}),v("span",{className:"stat-value",children:e.depth})]}),v("div",{className:"stat",children:[v("span",{className:"stat-label",children:"Nodes:"}),v("span",{className:"stat-value",children:e.nodes.toLocaleString()})]}),e.ttStats&&v("div",{className:"stat",children:[v("span",{className:"stat-label",children:"TT Hit:"}),v("span",{className:"stat-value",children:[(e.ttStats.hitRate*100).toFixed(1),"%"]})]})]}),e.analysis&&v("div",{className:"position-analysis",children:[v("h4",{className:"analysis-title",children:"Position Breakdown"}),v("div",{className:"analysis-grid",children:[v("div",{className:"analysis-item",children:[v("span",{className:"analysis-label",children:"Material:"}),v("span",{className:"analysis-value",children:(e.analysis.material/100).toFixed(1)})]}),v("div",{className:"analysis-item",children:[v("span",{className:"analysis-label",children:"Mobility:"}),v("span",{className:"analysis-value",children:e.analysis.mobility})]}),v("div",{className:"analysis-item",children:[v("span",{className:"analysis-label",children:"King Safety:"}),v("span",{className:"analysis-value",children:e.analysis.kingBanSafety})]}),v("div",{className:"analysis-item",children:[v("span",{className:"analysis-label",children:"Center:"}),v("span",{className:"analysis-value",children:e.analysis.centerControl})]})]})]}),e.pv&&e.pv.length>0&&v("div",{className:"pv-display",children:[v("h4",{className:"pv-title",children:"Best Line"}),v("div",{className:"pv-moves",children:e.pv.map((u,c)=>v("span",{className:"pv-move",children:[c+1,". ","move"in u?`${u.move.from}→${u.move.to}`:`🚫${u.ban.from}→${u.ban.to}`]},c))})]})]})}function Er(e={}){const[t,r]=J({isReady:!1,isThinking:!1,bestMove:null,evaluation:0,depth:0,nodes:0,pv:[],analysis:null,ttStats:null}),n=vt(null),i=vt(e);return ye(()=>{const a=new Worker(new URL("/ban-chess-gui/assets/engineWorker-CBKKlg-V.js",import.meta.url),{type:"module"});return a.onmessage=s=>{const{type:p,...l}=s.data;switch(p){case"READY":r(b=>({...b,isReady:!0}));break;case"BEST_MOVE":r(b=>({...b,isThinking:!1,bestMove:l.move,evaluation:l.evaluation,depth:l.depth,nodes:l.nodes,pv:l.pv||[]}));break;case"ANALYSIS":r(b=>({...b,analysis:l.analysis}));break;case"TT_STATS":r(b=>({...b,ttStats:l.stats}));break;case"ERROR":console.error("Engine error:",l.error),r(b=>({...b,isThinking:!1}));break}},a.postMessage({type:"INIT",payload:{depth:e.depth||6,timeLimit:e.timeLimit||3e3,useOpeningBook:e.useOpeningBook!==!1}}),n.current=a,()=>{a.terminate()}},[]),{...t,findBestMove:(a,s)=>{!n.current||!t.isReady||(r(p=>({...p,isThinking:!0})),n.current.postMessage({type:"FIND_BEST_MOVE",payload:{fen:a,timeLimit:s||i.current.timeLimit||3e3}}))},analyzePosition:a=>{!n.current||!t.isReady||n.current.postMessage({type:"ANALYZE_POSITION",payload:{fen:a}})},getStats:()=>{!n.current||!t.isReady||n.current.postMessage({type:"GET_TT_STATS"})},config:i.current}}const Mt="/ban-chess-gui/",Re=["a","b","c","d","e","f","g","h"];function Ee(e,t=100){try{const r=new(window.AudioContext||window.webkitAudioContext),n=r.createOscillator(),i=r.createGain();n.connect(i),i.connect(r.destination),n.frequency.value=e,n.type="sine",i.gain.setValueAtTime(.3,r.currentTime),i.gain.exponentialRampToValueAtTime(.01,r.currentTime+t/1e3),n.start(r.currentTime),n.stop(r.currentTime+t/1e3)}catch{}}function Cr(){const[e]=J(()=>new se),[t,r]=J([]),[n,i]=J(null),[o,u]=J([]),[c,a]=J([]),[s,p]=J(null),[l,b]=J(!1),[h,k]=J(!0),[I,F]=J([]),[,O]=J({}),[R,V]=J(4),[j,he]=J(!0),[ae,oe]=J("classic"),[ie,le]=J(!1),[X,x]=J("off"),[f,_]=J(!1),d=Er({depth:6,timeLimit:3e3,useOpeningBook:!0});ye(()=>{g()},[]);const m=(N,T)=>{if(!N)return null;const C=N===N.toUpperCase(),B=N.toUpperCase(),H=ue.find(ee=>ee.id===ae)||ue[0],G={K:"King",Q:"Queen",R:"Rook",B:"Bishop",N:"Knight",P:"Pawn"}[B];return G?`${Mt}${H.path}/${C?"white":"black"}/${G}.png`:null};ye(()=>{document.documentElement.style.setProperty("--board-size",`${R}rem`)},[R]);const g=()=>{const C=e.fen().split(" ")[0].split("/").map(B=>{const H=[];for(const Z of B)if(isNaN(parseInt(Z)))H.push(Z);else for(let G=0;G<parseInt(Z);G++)H.push(null);return H});r(C),u(e.legalMoves()),a(e.legalBans())},A=(N,T)=>(N+T)%2===0?"square-light":"square-dark",S=(N,T)=>{if(l){const C=N+1;return Re[7-T]+C}else{const C=8-N;return Re[T]+C}},E=N=>n?e.nextActionType()==="move"?o.some(T=>T.from===n&&T.to===N):c.some(T=>T.from===n&&T.to===N):!1,y=N=>e.nextActionType()==="move"?o.some(T=>T.from===N):c.some(T=>T.from===N),P=()=>X==="off"||X==="analysis"?!1:X==="white"&&e.turn==="white"||X==="black"&&e.turn==="black",K=(N,T)=>{if(P())return;const C=S(N,T);if(Ee(600,50),!n){y(C)&&i(C);return}if(C===n){i(null);return}if(E(C)){const B=e.nextActionType()==="move"?{move:{from:n,to:C}}:{ban:{from:n,to:C}};$(B)}else y(C)&&i(C)},$=N=>{if(e.play(N).success){e.nextActionType()==="ban"?Ee(800,150):Ee(400,200);const C="move"in N?N.move.from:N.ban.from,B="move"in N?N.move.to:N.ban.to;e.nextActionType()==="move"?F([...I,`🚫 ${C}→${B}`]):F([...I,`${C}→${B}`]),p({from:C,to:B}),g(),i(null),O({}),e.gameOver()&&setTimeout(()=>{Ee(200,500)},200)}},Q=N=>{P()&&setTimeout(()=>{$(N)},500)},U=(N,T)=>l?t[7-N]?.[7-T]:t[N]?.[T],L=()=>{Ee(1e3,100),e.reset(),i(null),p(null),F([]),g(),O({})},q=(N,T)=>{const C=m(N);if(!C)return null;const B=N===N.toUpperCase();return v("div",{className:"piece-wrapper",children:v("img",{src:C,alt:N,className:`chess-piece ${B?"piece-white":"piece-black"}`})})};return ye(()=>{if(h){const N=e.turn==="black";N!==l&&b(N)}},[e.turn,h]),v("div",{className:"container",children:[v("div",{className:"page-header",children:v("div",{className:"header-content",children:[v("img",{src:`${Mt}logo.png`,alt:"Ban Chess Logo",className:"header-logo"}),v("div",{className:"header-text",children:[v("h1",{className:"page-title",children:"Ban Chess with Engine"}),v("p",{className:"subtitle",children:e.gameOver()?"Game Over":P()?"Engine is thinking...":"Click on a piece to select, then click destination"}),v("p",{className:"version-info",children:["Library v",se.VERSION||"1.2.2"," | Engine v0.1.0"]})]})]})}),v("div",{className:"engine-mode-selector",children:[v("button",{className:`engine-mode-btn ${X==="off"?"active":""}`,onClick:()=>{x("off"),_(!1)},children:"Human vs Human"}),v("button",{className:`engine-mode-btn ${X==="white"?"active":""}`,onClick:()=>{x("white"),_(!0)},children:"Engine as White"}),v("button",{className:`engine-mode-btn ${X==="black"?"active":""}`,onClick:()=>{x("black"),_(!0)},children:"Engine as Black"}),v("button",{className:`engine-mode-btn ${X==="analysis"?"active":""}`,onClick:()=>{x("analysis"),_(!0)},children:"Analysis Mode"})]}),v("div",{className:"game-info",children:[v("div",{className:"turn-indicator",children:[v("span",{className:e.turn==="white"?"white-turn":"black-turn",children:["Turn: ",e.turn==="white"?"White":"Black",P()&&" (Engine)"]}),v("span",{className:`dot ${e.turn==="white"?"dot-white":"dot-black"}`})]}),v("div",{className:`action-type ${e.nextActionType()==="ban"?"ban":"move"}`,children:["Next:"," ",e.nextActionType()==="ban"?"🚫 Ban a move":"♟️ Make a move"]}),e.inCheckmate()&&v("div",{className:"game-status checkmate",children:"♔ Checkmate!"}),e.inCheck()&&!e.inCheckmate()&&v("div",{className:"game-status check",children:"♔ Check!"})]}),v("div",{className:"board-container",children:v("div",{className:"board-wrapper",children:[v("div",{className:"rank-labels",children:Array.from({length:8},(N,T)=>{const C=l?T+1:8-T;return v("div",{children:C},T)})}),v("div",{className:"file-labels",children:Array.from({length:8},(N,T)=>{const C=l?Re[7-T]:Re[T];return v("div",{children:C},T)})}),v("div",{className:"chess-board",children:[0,1,2,3,4,5,6,7].map(N=>[0,1,2,3,4,5,6,7].map(T=>{const C=S(N,T),B=U(N,T),H=C===n,Z=n&&E(C),G=e.currentBannedMove&&(e.currentBannedMove.from===C||e.currentBannedMove.to===C),ee=s?.from===C,te=s?.to===C,ne=y(C);return v("div",{onClick:()=>K(N,T),className:`board-square ${A(N,T)} ${H?"square-selected":""} ${Z?"square-legal-move":""} ${ee?"square-last-move-from":""} ${te?"square-last-move-to":""} ${G?"square-banned":""} ${ne&&!H?"square-can-select":""} ${!ne&&!Z&&n?"square-inactive":""} ${P()?"square-disabled":""}`,children:[B&&q(B),Z&&!B&&v("div",{className:"move-dot"}),G&&v("div",{className:"ban-overlay",children:v("div",{className:"ban-x",children:"×"})})]},`${N}-${T}`)}))})]})}),f&&v(Ar,{engine:d,fen:e.fen(),isEngineMove:P(),onEngineMove:Q}),v("div",{className:"controls",children:[v("button",{onClick:L,className:"btn btn-primary",children:"New Game"}),v("button",{onClick:()=>b(!l),className:"btn",children:"Flip Board"}),v("button",{onClick:()=>k(!h),className:`btn ${h?"btn-success":""}`,children:["Auto-flip: ",h?"ON":"OFF"]}),v("button",{onClick:()=>le(!ie),className:"btn",children:["Debug: ",ie?"ON":"OFF"]})]}),v("div",{className:"controls-section",children:[v("button",{className:"btn btn-secondary controls-toggle",onClick:()=>he(!j),children:j?"🎨 Hide Controls":"🎨 Show Controls"}),j&&v("div",{className:"controls-panel",children:[v("div",{className:"control-group",children:[v("label",{className:"control-label",children:["Board Size: ",R,"rem"]}),v("input",{type:"range",min:"3",max:"8",step:"0.5",value:R,onChange:N=>V(parseFloat(N.target.value)),className:"control-slider"})]}),v("div",{className:"control-group",children:v(Tr,{currentTheme:ae,onThemeChange:oe})})]})]}),v("div",{className:"history-section",children:[v("h3",{className:"history-title",children:"Move History"}),v("div",{className:"move-history",children:I.length>0?v("div",{className:"moves-inline",children:I.map((N,T)=>v("span",{className:`move-entry-inline ${N.startsWith("🚫")?"ban-entry":""}`,children:[Math.floor(T/2)+1,".",T%2===0?"":".."," ",N]},T))}):v("div",{className:"move-entry",children:"No moves yet"})})]}),ie&&v("div",{className:"debug-section",children:[v("h3",{className:"debug-title",children:"Debug Information"}),v("div",{className:"debug-content",children:[v("div",{className:"debug-group",children:[v("label",{className:"debug-label",children:"FEN:"}),v("code",{className:"debug-value",children:e.fen()})]}),v("div",{className:"debug-group",children:[v("label",{className:"debug-label",children:"PGN:"}),v("code",{className:"debug-value",children:e.pgn()})]})]})]}),e.gameOver()&&v("div",{className:"game-over",children:[v("h2",{children:"Game Over!"}),v("p",{children:e.inCheckmate()?`Checkmate! ${e.turn==="white"?"Black":"White"} wins!`:"Draw!"})]})]})}function Pr(){return v(Cr,{})}nr(v(Pr,{}),document.getElementById("app"));
